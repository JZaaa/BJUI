!function(t){var e,a,i=!1;"function"==typeof define&&define.amd&&(define(t),i=!0),"object"==typeof exports&&(module.exports=t(),i=!0),i||(e=window.Cookies,(a=window.Cookies=t()).noConflict=function(){return window.Cookies=e,a})}(function(){function g(){for(var t=0,e={};t<arguments.length;t++){var a,i=arguments[t];for(a in i)e[a]=i[a]}return e}return function t(p){function f(t,e,a){var i,n;if("undefined"!=typeof document){if(1<arguments.length){"number"==typeof(a=g({path:"/"},f.defaults,a)).expires&&((n=new Date).setMilliseconds(n.getMilliseconds()+864e5*a.expires),a.expires=n),a.expires=a.expires?a.expires.toUTCString():"";try{i=JSON.stringify(e),/^[\{\[]/.test(i)&&(e=i)}catch(t){}e=p.write?p.write(e,t):encodeURIComponent(String(e)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(String(t))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var o,s="";for(o in a)a[o]&&(s+="; "+o,!0!==a[o]&&(s+="="+a[o]));return document.cookie=t+"="+e+s}t||(i={});for(var l=document.cookie?document.cookie.split("; "):[],r=/(%[0-9A-Z]{2})+/g,d=0;d<l.length;d++){var c=l[d].split("="),u=c.slice(1).join("=");this.json||'"'!==u.charAt(0)||(u=u.slice(1,-1));try{var h=c[0].replace(r,decodeURIComponent),u=p.read?p.read(u,h):p(u,h)||u.replace(r,decodeURIComponent);if(this.json)try{u=JSON.parse(u)}catch(t){}if(t===h){i=u;break}t||(i[h]=u)}catch(t){}}return i}}return(f.set=f).get=function(t){return f.call(f,t)},f.getJSON=function(){return f.apply({json:!0},[].slice.call(arguments))},f.defaults={},f.remove=function(t,e){f(t,"",g(e,{expires:-1}))},f.withConverter=t,f}(function(){})}),jQuery.cookie=function(t,e,a){return void 0!==e?(a=a||{},null===e?Cookies.remove(t,a):Cookies.set(t,e,a)):Cookies.get(t)},function(u){"use strict";var h={version:"1.4.0",JSPATH:"BJUI/",PLUGINPATH:"BJUI/plugins/",IS_DEBUG:!1,date:!0,KeyPressed:{ctrl:!1,shift:!1},theme:"blue",dialog:{mask:!1,width:500,height:300},KindEditor:{uploadJson:void 0,fileManagerJson:void 0},keyCode:{ENTER:13,ESC:27,END:35,HOME:36,SHIFT:16,CTRL:17,TAB:9,LEFT:37,RIGHT:39,UP:38,DOWN:40,DELETE:46,BACKSPACE:8},eventType:{initUI:"bjui.initUI",beforeInitUI:"bjui.beforeInitUI",afterInitUI:"bjui.afterInitUI",ajaxStatus:"bjui.ajaxStatus",resizeGrid:"bjui.resizeGrid",beforeAjaxLoad:"bjui.beforeAjaxLoad",beforeLoadNavtab:"bjui.beforeLoadNavtab",beforeLoadDialog:"bjui.beforeLoadDialog",afterLoadNavtab:"bjui.afterLoadNavtab",afterLoadDialog:"bjui.afterLoadDialog",beforeCloseNavtab:"bjui.beforeCloseNavtab",beforeCloseDialog:"bjui.beforeCloseDialog",afterCloseNavtab:"bjui.afterCloseNavtab",afterCloseDialog:"bjui.afterCloseDialog"},pageInfo:{total:"total",pageCurrent:"pageCurrent",pageSize:"pageSize",orderField:"orderField",orderDirection:"orderDirection"},alertMsg:{displayPosition:"topcenter",displayMode:"slide",alertTimeout:3e3},ajaxTimeout:5e4,statusCode:{ok:200,error:300,timeout:301},keys:{statusCode:"statusCode",message:"message"},ui:{windowWidth:0,showSlidebar:!0,clientPaging:!0,overwriteHomeTab:!1},layout:{mode:"default",tags:!0},debug:function(t){this.IS_DEBUG&&("undefined"!=typeof console?console.log(t):alert(t))},loginInfo:{url:"login.html",title:"Login",width:420,height:260,mask:!0},loadLogin:function(){var t=this.loginInfo;u("body").dialog({id:"bjui-login",url:t.url,title:t.title,width:t.width,height:t.height,mask:t.mask})},init:function(t){t=u.extend({},t);u.extend(h.statusCode,t.statusCode),u.extend(h.pageInfo,t.pageInfo),u.extend(h.alertMsg,t.alertMsg),u.extend(h.loginInfo,t.loginInfo),u.extend(h.KindEditor,t.KindEditor),u.extend(h.ui,t.ui),u.extend(h.dialog,t.dialog),t.layout&&u.extend(h.layout,t.layout),t.JSPATH&&(this.JSPATH=t.JSPATH),t.PLUGINPATH&&(this.PLUGINPATH=t.PLUGINPATH),t.ajaxTimeout&&(this.ajaxTimeout=t.ajaxTimeout),this.date=(void 0===t.date?this:t).date,this.IS_DEBUG=t.debug||!1,this.theme=u.cookie("bjui_theme")||t.theme,this.initEnv(),this.date&&this.initDate(),u(this).theme("setTheme",this.theme)},initEnv:function(){u(window).resize(function(){var t=u(this).width();h.ui.windowWidth&&600<h.ui.windowWidth&&h.ui.windowWidth<t&&(t=h.ui.windowWidth),h.initLayout(t),setTimeout(function(){u(this).trigger(h.eventType.resizeGrid)},30)}),setTimeout(function(){var t=u(window).width();h.ui.windowWidth&&600<h.ui.windowWidth&&h.ui.windowWidth<t&&(t=h.ui.windowWidth),h.initLayout(t),u(document).initui()},10)},initLayout:function(t){var e=u("#bjui-header"),a=u("#bjui-navtab"),i=t-(h.ui.showSlidebar?u("#bjui-sidebar").width()+6:6);h.layout&&"default"!==h.layout.mode&&(i+=6);var n=u(window).height()-e.height()-u("#bjui-footer").outerHeight(),o=0;h.layout&&!h.layout.tags?(a.find(".tabsPageHeader").hide(),a.find(".tabsPageContent").css("margin-top",0)):o=a.find(".tabsPageHeader").height(),h.ui.windowWidth&&u("#bjui-window").width(t),h.windowWidth=t,u("#bjui-container").height(n),a.width(i),u("#bjui-leftside, #bjui-sidebar, #bjui-sidebar-s, #bjui-splitBar, #bjui-splitBarProxy").css({height:"100%"}),u("#bjui-navtab .tabsPageContent").height(n-o),setTimeout(function(){u("#bjui-navtab > .tabsPageContent > .navtabPage").resizePageH().find(".bjui-layout").resizePageH()},10);a=u("body").data("bjui.navbar.width"),i=e.find(".bjui-navbar-toggle"),n=e.find(".bjui-navbar-logo"),o=u("#bjui-navbar-collapse"),e=o.find(".bjui-navbar-right");a||(a={logoW:n.outerWidth(),navW:e.outerWidth()},u("body").data("bjui.navbar.width",a)),a&&(t-a.logoW<a.navW?(i.show(),o.addClass("collapse menu")):(i.hide(),o.removeClass("collapse menu in")));var s=u("#bjui-hnav-navbar-box"),o=s.find("> #bjui-hnav-navbar"),l=s.prev(),r=s.next(),d=s.width(),c=0;o.find("> li").each(function(t){var e=u(this);c+=e.outerWidth(),d<c?(r.show(),s.data("hnav.move",!0).data("hnav.liw",c)):(l.hide(),r.hide(),s.removeData("hnav.move"))})},regional:{},setRegional:function(t,e){h.regional[t]=e},getRegional:function(t){if(0<=String(t).indexOf(".")){for(var e,a=String(t).split("."),i=0;i<a.length;i++)e=(e||h.regional)[a[i]];return e}return h.regional[t]},doRegional:function(a,t){return u.each(t,function(t,e){a=a.replaceAll("#"+t+"#",e)}),a},initDate:function(){var t=new Date;u("#bjui-date").html(t.formatDate("yyyy/MM/dd")),setInterval(function(){t=new Date(t.setSeconds(t.getSeconds()+1)),u("#bjui-clock").html(t.formatDate("HH:mm:ss"))},1e3)},removeProgress:function(){var t=u(document);t.find(".bjui-maskProgress").find(".progress").stop().animate({width:"100%"},"fast",function(){t.find(".bjui-ajax-mask").fadeOut("normal",function(){u(this).remove()})})}};window.BJUI=h}(jQuery),function(t){"use strict";t(function(){BJUI.setRegional("alertmsg",{title:{error:"错误提示",info:"信息提示",warn:"警告信息",correct:"成功信息",confirm:"确认信息"},btnMsg:{ok:"确定",yes:"是",no:"否",cancel:"取消"}}),BJUI.setRegional("dialog",{close:"关闭",maximize:"最大化",restore:"还原",minimize:"最小化",title:"弹出窗口"}),BJUI.setRegional("orderby",{asc:"升序",desc:"降序"}),BJUI.setRegional("pagination",{total:"总记录数/总页数",first:"首页",last:"末页",prev:"上一页",next:"下一页",jumpto:"输入跳转页码，回车确认",jump:"跳转",page:"页",refresh:"刷新"}),BJUI.setRegional("datagrid",{asc:"升序",desc:"降序",showhide:"显示/隐藏 列",filter:"过滤",clear:"清除",lock:"锁定列",unlock:"解除锁定",add:"添加",edit:"编辑",save:"保存",update:"更新",cancel:"取消",del:"删除",prev:"上一条",next:"下一条",refresh:"刷新",query:"查询",import:"导入",export:"导出",all:"全部",true:"是",false:"否",selectMsg:"未选中任何行！",editMsg:"请先保存编辑行！",saveMsg:"没有需要保存的行！",delMsg:"确定要删除该行吗？",delMsgM:"确定要删除选中行？"}),BJUI.setRegional("progressmsg","正在努力加载数据，请稍等..."),BJUI.setRegional("datepicker",{close:"关闭",prev:"上月",next:"下月",clear:"清空",ok:"确定",dayNames:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]}),BJUI.setRegional("navtabCM",{refresh:"刷新本标签",close:"关闭本标签",closeother:"关闭其他标签",closeall:"关闭所有标签"}),BJUI.setRegional("dialogCM",{refresh:"刷新本窗口",close:"关闭本窗口",closeother:"关闭其他窗口",closeall:"关闭所有窗口"}),BJUI.setRegional("upload",{upConfirm:"开始上传",upPause:"暂停上传",upCancel:"取消上传"}),BJUI.setRegional("statusCode_503","服务器当前负载过大或者正在维护！"),BJUI.setRegional("sessiontimeout","会话超时，请重新登陆！"),BJUI.setRegional("plhmsg","占位符对应的选择器无有效值！"),BJUI.setRegional("nocheckgroup",'未定义选中项的组名[复选框的"data-group"]！'),BJUI.setRegional("notchecked","未选中任何一项！"),BJUI.setRegional("selectmsg","请选择一个选项！"),BJUI.setRegional("validatemsg","提交的表单中 [{0}] 个字段有错误，请更正后再提交！"),BJUI.setRegional("uititle","B-JUI"),BJUI.setRegional("maintab","我的主页"),t.validator&&t.validator.config({defaultMsg:"{0}格式不正确",loadingMsg:"正在验证...",rules:{digits:[/^\d+$/,"请输入整数"],number:[/^[\-\+]?((([0-9]{1,3})([,][0-9]{3})*)|([0-9]+))?([\.]([0-9]+))?$/,"请输入有效的数字"],letters:[/^[a-z]+$/i,"{0}只能输入字母"],datetime:[/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])\s+(2[0123]|(1|0?)[0-9]){1}:([0-5][0-9]){1}:([0-5][0-9]){1}$/,"请输入正确的日期时间，例：yyyy-MM-dd HH:mm:ss"],pattern:function(t,e){return!e||(!!t.value.parseDate(e)||this.renderMsg("错误的日期时间格式！",e))},accept:function(t,e){if(!e)return!0;e=e[0];return"*"===e||new RegExp(".(?:"+(e||"png|jpg|jpeg|gif")+")$","i").test(t.value)||this.renderMsg("只接受{1}后缀",e.replace("|",","))}}})})}(jQuery),function(){"use strict";BJUI.setRegional("alertmsg",{title:{error:"Error",info:"Info",warn:"Warning",correct:"Correct",confirm:"Confirm"},btnMsg:{ok:"OK",yes:"YES",no:"NO",cancel:"Cancel"}}),BJUI.setRegional("dialog",{close:"Close",maximize:"Maximize",restore:"Restore",minimize:"Minimize",title:"Popup window"}),BJUI.setRegional("orderby",{asc:"Asc",desc:"Desc"}),BJUI.setRegional("pagination",{first:"First page",last:"Last page",prev:"Prev page",next:"Next page",jumpto:"Jump page number",jump:"Jump"}),BJUI.setRegional("datagrid",{asc:"ASC",desc:"DESC",showhide:"Show/Hide columns",filter:"Filter",clear:"Clear",lock:"Lock",unlock:"Unlock",add:"Add",edit:"Edit",save:"Save",update:"Update",cancel:"Cancel",del:"Delete",prev:"Prev",next:"Next",refresh:"Refresh",query:"Query",import:"Import",export:"Export",all:"All",true:"True",false:"False",selectMsg:"Not selected any rows!",saveMsg:"No rows need to save!",editMsg:"Please save the edited row!",delMsg:"Sure you want to delete this row?",delMsgM:"Sure you want to delete selected rows?"}),BJUI.setRegional("progressmsg","Data loading, please waiting..."),BJUI.setRegional("datepicker",{close:"Close",prev:"Prev month",next:"Next month",clear:"Clear",ok:"OK",dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),BJUI.setRegional("navtabCM",{refresh:"Refresh navtab",close:"Close navtab",closeother:"Close other navtab",closeall:"Close all navtab"}),BJUI.setRegional("dialogCM",{refresh:"Refresh dialog",close:"Close dialog",closeother:"Close other dialog",closeall:"Close all dialog"}),BJUI.setRegional("upload",{upConfirm:"Start upload",upPause:"Pause upload",upCancel:"Cancel upload"}),BJUI.setRegional("statusCode_503","The current server load is too large or is down for maintenance!"),BJUI.setRegional("sessiontimeout","Session timeout, please login!"),BJUI.setRegional("plhmsg","Placeholder corresponding selector None Valid!"),BJUI.setRegional("nocheckgroup",'Undefined group name selected item [check box "data-group"]!'),BJUI.setRegional("notchecked","Unchecked any one!"),BJUI.setRegional("selectmsg","Please select one option!"),BJUI.setRegional("validatemsg","Submitted form data has [{0}] field an error, please after modified submitting!"),BJUI.setRegional("uititle","B-JUI"),BJUI.setRegional("maintab","My home"),window.FRAG={dialog:'<div class="bjui-dialog bjui-dialog-container" style="top:150px; left:300px;">    <div class="dialogHeader" onselectstart="return false;" oncopy="return false;" onpaste="return false;" oncut="return false;">        <a class="close" href="#close" title="#close#"><i class="fa fa-times-circle"></i></a>        <a class="maximize" href="#maximize" title="#maximize#"><i class="fa fa-plus-circle"></i></a>        <a class="restore" href="#restore" title="#restore#"><i class="fa fa-history"></i></a>        <a class="minimize" href="#minimize" title="#minimize#"><i class="fa fa-minus-circle"></i></a>        <h1><span><i class="fa fa-th-large"></i></span> <span class="title">#title#</span></h1>    </div>    <div class="dialogContent unitBox"></div>    <div class="resizable_h_l" tar="nw"></div>    <div class="resizable_h_r" tar="ne"></div>    <div class="resizable_h_c" tar="n"></div>    <div class="resizable_c_l" tar="w" style="height:100%;"></div>    <div class="resizable_c_r" tar="e" style="height:100%;"></div>    <div class="resizable_f_l" tar="sw"></div>    <div class="resizable_f_r" tar="se"></div>    <div class="resizable_f_c" tar="s"></div></div>',taskbar:'<div id="bjui-taskbar" style="left:0px; display:none;">    <div class="taskbarContent">        <ul></ul>    </div>    <div class="taskbarLeft taskbarLeftDisabled"><i class="fa fa-angle-double-left"></i></div>    <div class="taskbarRight"><i class="fa fa-angle-double-right"></i></div></div>',splitBar:'<div id="bjui-splitBar"></div>',splitBarProxy:'<div id="bjui-splitBarProxy"></div>',resizable:'<div id="bjui-resizable" class="bjui-resizable"></div>',alertBackground:'<div class="bjui-alertBackground"></div>',maskBackground:'<div class="bjui-maskBackground bjui-ajax-mask"></div>',maskProgress:'<div class="bjui-maskProgress bjui-ajax-mask"><i class="fa fa-cog fa-spin"></i>&nbsp;&nbsp;#msg#<div class="progressBg"><div class="progress"></div></div></div>',progressBar_custom:'<div id="bjui-progressBar-custom" class="progressBar"><i class="fa fa-cog fa-spin"></i> <span></span></div>',dialogMask:'<div class="bjui-dialogBackground"></div>',orderby:'<a href="javascript:;" class="order asc" data-order-direction="asc" title="#asc#"><i class="fa fa-angle-up"></i></a><a href="javascript:;" class="order desc" data-order-direction="desc" title="#desc#"><i class="fa fa-angle-down"></i></a>',slidePanel:'<div class="panel panel-default">    <div class="panel-heading">        <h4 class="panel-title"><a data-toggle="collapse" data-parent="#bjui-accordionmenu" href="##id#" class="#class#">#icon#&nbsp;#title#<b>#righticon#</b></a></h4>    </div>    <div id="#id#" class="panel-collapse collapse#bodyclass#">        <div class="panel-body">        </div>    </div></div>',pagination:'<ul class="pagination">    <li class="j-first">        <a class="first" href="javascript:;"><i class="fa fa-step-backward"></i> #first#</a>        <span class="first"><i class="fa fa-step-backward"></i> #first#</span>    </li>    <li class="j-prev">        <a class="previous" href="javascript:;"><i class="fa fa-backward"></i> #prev#</a>        <span class="previous"><i class="fa fa-backward"></i> #prev#</span>    </li>    #pageNumFrag#    <li class="j-next">        <a class="next" href="javascript:;">#next# <i class="fa fa-forward"></i></a>        <span class="next">#next# <i class="fa fa-forward"></i></span>    </li>    <li class="j-last">        <a class="last" href="javascript:;">#last# <i class="fa fa-step-forward"></i></a>        <span class="last">#last# <i class="fa fa-step-forward"></i></span>    </li>    <li class="jumpto"><span class="p-input"><input class="form-control input-sm-pages" type="text" size="2.6" value="#pageCurrent#" title="#jumpto#"></span><a class="goto" href="javascript:;" title="#jump#"><i class="fa fa-chevron-right"></i></a></li></ul>',gridPaging:'<ul class="pagination">    <li class="page-total">        <span title="#total#">#count#</span>    </li>    <li class="page-jumpto"><span class="page-input"><input class="form-control input-sm-pages" type="text" size="3.2" value="#pageCurrent#" title="#jumpto#"></span></li>    <li class="page-first btn-nav">        <a href="javascript:;" title="#first#"><i class="fa fa-step-backward"></i></a>    </li>    <li class="page-prev btn-nav">        <a href="javascript:;" title="#prev#"><i class="fa fa-backward"></i></a>    </li>    <li class="page-next btn-nav">        <a href="javascript:;" title="#next#"><i class="fa fa-forward"></i></a>    </li>    <li class="page-last btn-nav">        <a href="javascript:;" title="#last#"><i class="fa fa-step-forward"></i></a>    </li></ul>',gridPageNum:'<li class="page-num#active#"><a href="javascript:;">#num#</a></li>',gridMenu:'<div class="datagrid-menu-box">    <ul>        <li class="datagrid-li-asc"><a href="javascript:;"><span class="icon"><i class="fa fa-sort-amount-asc"></i></span><span class="title">#asc#</span></a></li>        <li class="datagrid-li-desc"><a href="javascript:;"><span class="icon"><i class="fa fa-sort-amount-desc"></i></span><span class="title">#desc#</span></a></li>        <li class="datagrid-li-filter"><a href="javascript:;"><span class="icon"><i class="fa fa-filter"></i></span><span class="title">#filter#</span><span class="arrow"></span></a></li>        <li class="datagrid-li-showhide"><a href="javascript:;"><span class="icon"><i class="fa fa-check-square-o"></i></span><span class="title">#showhide#</span><span class="arrow"></span></a></li>        <li class="datagrid-li-lock"><a href="javascript:;"><span class="icon"><i class="fa fa-lock"></i></span><span class="title">#lock#</span></a></li>        <li class="datagrid-li-unlock disable"><a href="javascript:;"><span class="icon"><i class="fa fa-unlock"></i></span><span class="title">#unlock#</span></a></li>    </ul></div>',gridFilter:'<div class="datagrid-filter-box"><fieldset><legend>#label#</legend><span class="filter-a"></span><span class="filter-and"><select data-toggle="selectpicker" data-container="true" data-width="100%"><option value="and">AND</option><option value="or">OR</option></select></span><span class="filter-b"></span><span class="filter-ok"><button type="button" class="btn-green ok" data-icon="check">#filter#</button><button type="button" class="btn-orange clear" data-icon="remove">#clear#</button></span></fieldset></div>',gridShowhide:'<li data-index="#index#" class="datagrid-col-check"><a href="javascript:;"><i class="fa fa-check-square-o"></i>#label#</a></li>',gridEditBtn:'<button type="button" class="btn-green edit" data-icon="edit">#edit#</button><button type="button" class="btn-green update" data-icon="edit">#update#</button><button type="button" class="btn-green save" data-icon="check">#save#</button><button type="button" class="btn-orange cancel" data-icon="undo">#cancel#</button><button type="button" class="btn-orange delete" data-icon="remove">#del#</button>',gridDialogEditBtns:'<ul>    <li class="pull-left"><button type="button" class="btn btn-orange prev" data-icon="arrow-up">#prev#</button></li>    <li class="pull-left"><button type="button" class="btn btn-orange next" data-icon="arrow-down">#next#</button></li>    <li><button type="button" class="btn btn-red cancel" data-icon="remove">#cancel#</button></li>    <li><button type="button" class="btn btn-default save" data-icon="save">#save#</button></li></ul>',alertBoxFrag:'<div id="bjui-alertMsgBox" class="bjui-alert"><div class="alertContent"><div class="#type#"><div class="alertInner"><h1><i class="fa #fa#"></i>#title#</h1><div class="msg">#message#</div></div><div class="toolBar"><ul>#btnFragment#</ul></div></div></div></div>',alertBtnFrag:'<li><button class="btn btn-#class#" rel="#callback#" type="button">#btnMsg#</button></li>',calendarFrag:'<div id="bjui-calendar">    <div class="main">        <a class="close" href="javascript:;" title="#close#"><i class="fa fa-times-circle"></i></a>        <div class="head">            <table width="100%" border="0" cellpadding="0" cellspacing="2">                <tr>                    <td width="20"><a class="prev" href="javascript:;" title="#prev#"><i class="fa fa-arrow-left"></i></a></td>                    <td><select name="year"></select></td>                    <td><select name="month"></select></td>                    <td width="20"><a class="next" href="javascript:;" title="#next#"><i class="fa fa-arrow-right"></i></a></td>                </tr>            </table>        </div>        <div class="body">            <dl class="dayNames"><dt>7</dt><dt>1</dt><dt>2</dt><dt>3</dt><dt>4</dt><dt>5</dt><dt>6</dt></dl>            <dl class="days">\x3c!-- date list --\x3e</dl>            <div style="clear:both;height:0;line-height:0"></div>        </div>        <div class="foot">            <table class="time">                <tr>                    <td>                        <input type="text" class="hh" maxlength="2" data-type="hh" data-start="0" data-end="23">:<input                         type="text" class="mm" maxlength="2" data-type="mm" data-start="0" data-end="59">:<input                         type="text" class="ss" maxlength="2" data-type="ss" data-start="0" data-end="59">                    </td>                    <td><ul><li class="up" data-add="1">&and;</li><li class="down">&or;</li></ul></td>                </tr>            </table>            <button type="button" class="clearBtn btn btn-orange">#clear#</button>            <button type="button" class="okBtn btn btn-default">#ok#</button>        </div>        <div class="tm">            <ul class="hh">                <li>0</li>                <li>1</li>                <li>2</li>                <li>3</li>                <li>4</li>                <li>5</li>                <li>6</li>                <li>7</li>                <li>8</li>                <li>9</li>                <li>10</li>                <li>11</li>                <li>12</li>                <li>13</li>                <li>14</li>                <li>15</li>                <li>16</li>                <li>17</li>                <li>18</li>                <li>19</li>                <li>20</li>                <li>21</li>                <li>22</li>                <li>23</li>            </ul>            <ul class="mm">                <li>0</li>                <li>5</li>                <li>10</li>                <li>15</li>                <li>20</li>                <li>25</li>                <li>30</li>                <li>35</li>                <li>40</li>                <li>45</li>                <li>50</li>                <li>55</li>            </ul>            <ul class="ss">                <li>0</li>                <li>10</li>                <li>20</li>                <li>30</li>                <li>40</li>                <li>50</li>            </ul>        </div>    </div></div>',spinnerBtn:'<ul class="bjui-spinner"><li class="up" data-add="1">&and;</li><li class="down">&or;</li></ul>',lookupBtn:'<a class="bjui-lookup" href="javascript:;" data-toggle="lookupbtn"><i class="fa fa-search"></i></a>',dateBtn:'<a class="bjui-lookup" href="javascript:;" data-toggle="datepickerbtn"><i class="fa fa-calendar"></i></a>',navtabCM:'<ul id="bjui-navtabCM">    <li rel="reload"><span class="icon"><i class="fa fa-refresh"></i></span><span class="title">#refresh#</span></li>    <li rel="closeCurrent"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#close#</li>    <li rel="closeOther"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeother#</li>    <li rel="closeAll"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeall#</li></ul>',dialogCM:'<ul id="bjui-dialogCM">    <li rel="reload"><span class="icon"><i class="fa fa-refresh"></i></span><span class="title">#refresh#</span></li>    <li rel="closeCurrent"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#close#</span></li>    <li rel="closeOther"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeother#</span></li>    <li rel="closeAll"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeall#</span></li></ul>',externalFrag:'<iframe src="{url}" style="width:100%;height:{height};" frameborder="no" border="0" marginwidth="0" marginheight="0"></iframe>',uploadTemp:'<div id="{fileId}" class="item">    <div class="info">        <span class="up_filename">{fileName}</span><span class="up_confirm" title="#upConfirm#"><i class="fa fa-play-circle-o"></i></span><span class="up_pause" title="#upPause#"><span class="glyphicon glyphicon-pause"></span></span><span class="up_cancel" title="#upCancel#"><i class="fa fa-times-circle-o"></i></span>    </div>    <div class="preview"><span class="img"></span></div>    <div class="progress"><div class="bar"></div></div>    <span class="percent">{percent}</span>    <span class="filesize"><span class="uploadedsize">{uploadedSize}</span>/<span class="totalsize">{fileSize}</span></span></div>',uploadFrag:'<input class="bjui-upload-select-file" style="display:none;" type="file" name="fileselect[]" #multi# accept="#accept#"><a href="javascript:void(0)" class="btn btn-default bjui-upload-select">#btnTxt#</a><div class="queue"></div>',statusCode_503:"HTTP status 503, #statusCode_503#",sessionTimout:"#sessiontimeout#",alertPlhMsg:"#plhmsg#",alertNoCheckGroup:"#nocheckgroup#",alertNotChecked:"#notchecked#",alertSelectMsg:"#selectmsg#",validateErrorMsg:"#validatemsg#",uiTitle:"#uititle#",mainTabTitle:"#mynavtab#"}}(jQuery),function(s){"use strict";s.fn.extend({ajaxUrl:function(i){var n=s(this);n.trigger(BJUI.eventType.beforeAjaxLoad),i.loadingmask&&n.trigger(BJUI.eventType.ajaxStatus),s.ajax({type:i.type||"GET",url:i.url,data:i.data||{},cache:!1,dataType:"html",timeout:BJUI.ajaxTimeout,success:function(t){var e=t.toJson(),a=n.find("> .bjui-ajax-mask");e[BJUI.keys.statusCode]?(e[BJUI.keys.statusCode]===BJUI.statusCode.error?(e[BJUI.keys.message]&&n.alertmsg("error",e[BJUI.keys.message]),n.closest(".bjui-layout").length||(n.closest(".navtab-panel").length?n.navtab("closeCurrentTab"):n.dialog("closeCurrent"))):e[BJUI.keys.statusCode]===BJUI.statusCode.timeout&&(n.closest(".bjui-dialog").length&&n.dialog("closeCurrent"),n.closest(".navtab-panel").length&&n.navtab("closeCurrentTab"),s("body").alertmsg("info",e[BJUI.keys.message]||BJUI.regional.sessiontimeout),BJUI.loadLogin()),a.fadeOut("normal",function(){s(this).remove()})):(n.empty().html(t).append(a).initui(),s.isFunction(i.callback)&&i.callback(t))},error:function(t,e,a){n.bjuiajax("ajaxError",t,e,a),n.closest(".bjui-layout").length||(n.closest(".navtab-panel").length?n.navtab("closeCurrentTab"):n.dialog("closeCurrent")),n.trigger("bjui.ajaxError")},statusCode:{503:function(t,e,a){n.alertmsg("error",FRAG.statusCode_503.replace("#statusCode_503#",BJUI.regional.statusCode_503)||a)},403:function(t,e,a){n.alertmsg("error","登录超时"),BJUI.loadLogin()},401:function(t,e,a){BJUI.IS_DEBUG||n.alertmsg("error","无权限访问")},404:function(t,e,a){BJUI.IS_DEBUG||n.alertmsg("error"," httpCode: 404 .请求未找到！")},500:function(t,e,a){BJUI.IS_DEBUG||n.alertmsg("error"," httpCode: 500 .请求失败！")}}})},loadUrl:function(t,e,a){s(this).ajaxUrl({url:t,data:e,callback:a})},doAjax:function(e){var i,n,o=s(this);e.url?e.callback?(e.callback=e.callback.toFunc(),e.loadingmask&&((i=o.getPageTarget()).trigger(BJUI.eventType.ajaxStatus),n=i.find("> .bjui-ajax-mask")),e.type||(e.type="POST"),e.dataType||(e.dataType="json"),e.cache||(e.cache=!1),e.timeout=BJUI.ajaxTimeout,e.success=function(t){n?e.callback?s.when(e.callback(t)).done(function(){i.trigger("bjui.ajaxStop")}):i.trigger("bjui.ajaxStop"):e.callback(t)},e.error=e.error||function(t,e,a){o.bjuiajax("ajaxError",t,e,a),n&&i.trigger("bjui.ajaxError")},s.ajax(e)):BJUI.debug("The ajax callback is undefined!"):BJUI.debug("The ajax url is undefined!")},getPageTarget:function(){var t=this.closest(".bjui-layout").length?this.closest(".bjui-layout"):this.closest(".navtab-panel").length?s.CurrentNavtab:s.CurrentDialog;return t},resizePageH:function(){return this.each(function(){var t,e,a,i,n,o;s(this).closest(".tab-content").length||((t=s(this)).is(":hidden")||(e=t.find("> .bjui-pageHeader"),a=t.find("> .bjui-pageContent"),i=t.find("> .bjui-pageFooter"),n=e.outerHeight()||0,o=i.outerHeight()||0,t.hasClass("navtabPage")&&t.is(":hidden")&&(t.show(),n=e.outerHeight()||0,o=i.outerHeight()||0,t.hide()),i.css("bottom")&&(o+=parseInt(i.css("bottom"))||0),0===o&&t.hasClass("dialogContent")&&(o=5),a.css({top:n,bottom:o})))})},getMaxIndexObj:function(t){var a=0,i=0;return t.each(function(t){var e=parseInt(s(this).css("zIndex"))||1;a<e&&(a=e,i=t)}),t.eq(i)},serializeJson:function(){var t={},e=this.serializeArray();return s.each(e,function(){void 0!==t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t},isTag:function(t){return!!t&&(!!s(this).prop("tagName")&&s(this)[0].tagName.toLowerCase()===t)},isBind:function(t){var e=s(this).data("events");return e&&t&&e[t]},log:function(t){return this.each(function(){console&&console.log("%s: %o",t,this)})}}),s.extend(String.prototype,{isPositiveInteger:function(){return new RegExp(/^[1-9]\d*$/).test(this)},isInteger:function(){return new RegExp(/^\d+$/).test(this)},isNumber:function(){return new RegExp(/^([-]{0,1}(\d+)[\.]+(\d+))|([-]{0,1}(\d+))$/).test(this)},includeChinese:function(){return new RegExp(/[\u4E00-\u9FA5]/).test(this)},trim:function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},startsWith:function(t){return 0===this.indexOf(t)},endsWith:function(t){var e=this.length-t.length;return 0<=e&&this.lastIndexOf(t)===e},replaceSuffix:function(t){return this.replace(/\[[0-9]+\]/,"["+t+"]").replace("#index#",t)},replaceSuffix2:function(t){return this.replace(/\-(i)([0-9]+)$/,"-i"+t).replace("#index#",t)},trans:function(){return this.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')},encodeTXT:function(){return this.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll(" ","&nbsp;")},replaceAll:function(t,e){return this.replace(new RegExp(t,"gm"),e)},replacePlh:function(a){return a=a||s(document),this.replace(/{\/?[^}]*}/g,function(t){var e=a.find(t.replace(/[{}]+/g,""));return e&&e.val()?e.val():t})},replaceMsg:function(t){return this.replace(new RegExp("({.*})","g"),t)},replaceTm:function(e){return e?this.replace(RegExp("({[A-Za-z_]+[A-Za-z0-9_-]*})","g"),function(t){return e[t.replace(/[{}]+/g,"")]}):this},replaceTmById:function(t){var a=t||s(document);return this.replace(RegExp("({[A-Za-z_]+[A-Za-z0-9_-]*})","g"),function(t){var e=a.find("#"+t.replace(/[{}]+/g,""));return e.val()?e.val():t})},isFinishedTm:function(){return!new RegExp("{/?[^}]*}").test(this)},skipChar:function(t){return this&&0!==this.length?this.charAt(0)===t?this.substring(1).skipChar(t):this:""},isValidPwd:function(){return new RegExp(/^([_]|[a-zA-Z0-9]){6,32}$/).test(this)},isValidMail:function(){return new RegExp(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/).test(this.trim())},isSpaces:function(){for(var t=0;t<this.length;t+=1){var e=this.charAt(t);if(" "!==e&&"\n"!==e&&"\t"!==e&&"\r"!==e)return!1}return!0},isPhone:function(){return new RegExp(/(^([0-9]{3,4}[-])?\d{3,8}(-\d{1,6})?$)|(^\([0-9]{3,4}\)\d{3,8}(\(\d{1,6}\))?$)|(^\d{3,8}$)/).test(this)},isUrl:function(){return new RegExp(/^[a-zA-z]+:\/\/([a-zA-Z0-9\-\.]+)([-\w .\/?%&=:]*)$/).test(this)},isExternalUrl:function(){return this.isUrl()&&-1===this.indexOf("://"+document.domain)},toBool:function(){return"true"===this.toLowerCase()},toJson:function(){var t=this;try{return"object"==typeof t&&(t=t.toString()),t.trim().match("^{(.+:.+,*){1,}}$")?JSON.parse(this):this}catch(t){return this}},toObj:function(){var e=null;try{e=new Function("return "+this)()}catch(t){e=this,BJUI.debug('String toObj：Parse "String" to "Object" error! Your str is: '+this)}return e},toFunc:function(){if(this&&0!==this.length){if(this.startsWith("function"))return new Function("return "+this)();for(var t=this.split("."),e=window,a=0;a<t.length;a++)e=e[t[a]];return"function"==typeof e?e:void 0}},setUrlParam:function(t,e){var a,i=this,n=i;return null!=n&&"undefined"!==n&&""!==n&&(e=encodeURIComponent(e),a=new RegExp("(^|)"+t+"=([^&]*)(|$)"),e=t+"="+e,n=null!=i.match(a)?i.replace(a,e):i.match("[?]")?i+"&"+e:i+"?"+e),n},getQuery:function(t,e){var a,i={};e?(a=document.createElement("a")).href=e:a=window.location;for(var n,o=a.search.replace(/^\?/,"").split("&"),s=o.length,l=0;l<s;l++)o[l]&&(i[(n=o[l].split("="))[0]]=decodeURIComponent(n[1]));return t?i[t]:i}}),s.extend(Function.prototype,{toFunc:function(){return this}}),s.extend(Array.prototype,{remove:function(t){return t<0?this:this.slice(0,t).concat(this.slice(t+1,this.length))},unique:function(){var t=[];this.sort();for(var e=0;e<this.length;e++)this[e]!==this[e+1]&&(t[t.length]=this[e]);return t},myIndexOf:function(t){return this.indexOf(t)},toJson:function(){var t={};return s.each(this,function(){void 0!==t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t}}),s.isJson=function(t){var e=!0;try{e=s.parseJSON(t)}catch(t){return!1}return!!e},s.getGUID=function(t,e,a){t=t||32,e=e||!0,a=a||null;var i,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),o=[];if(a=a||n.length,t)for(var s=0;s<t;s++)o[s]=n[0|Math.random()*a];else{o[8]=o[13]=o[18]=o[23]="-",o[14]="4";for(s=0;s<36;s++)o[s]||(i=0|16*Math.random(),o[s]=n[19===s?3&i|8:i])}return e?(o.shift(),"u"+o.join("")):o.join("")}}(jQuery),function(){"use strict";function t(){}t.prototype.destroyModules=function(t){try{var e=t.find(".bjui-upload > .uploadify");e.length&&e.uploadify("destroy");e=t.find('[data-toggle="colorpicker"]');e.length&&e.colorpicker("destroy");e=t.find('[data-toggle="selectpicker"]');e.length&&e.selectpicker("destroy")}catch(t){BJUI.debug(t)}},BJUI.ModuleFixed=new t}(jQuery),function(s){"use strict";function l(t,e){this.$element=s(t),this.options=e}l.prototype.init=function(){var e=this;this.options.$obj=this.$element,this.options.obj&&(this.options.$obj=this.options.obj),this.options.event?this.start(this.options.event):this.$element.find(this.options.selector).bind("mousedown",function(t){e.start.apply(e,[t])})},l.prototype.start=function(t){document.onselectstart=function(t){return!1};var e=this;this.options.oleft=parseInt(this.$element.css("left"))||0,this.options.otop=parseInt(this.$element.css("top"))||0,s(document).bind("mouseup.bjui.basedrag",function(t){e.stop.apply(e,[t])}).bind("mousemove.bjui.basedrag",function(t){e.drag.apply(e,[t])})},l.prototype.drag=function(t){t=t||window.event;var e,a=this.options,i=a.oleft+(t.pageX||t.clientX)-a.event.pageX,n=a.otop+(t.pageY||t.clientY)-a.event.pageY;return n<1&&(n=0),"horizontal"===a.move?a.minW&&i>=parseInt(this.options.$obj.css("left"))+a.minW&&a.maxW&&i<=parseInt(this.options.$obj.css("left"))+a.maxW?this.$element.css("left",i):a.scop&&a.relObj&&(parseInt(a.relObj.css("left")),a.cellMinW,this.$element.css("left",i)):"vertical"===a.move?this.$element.css("top",n):i>=2*-(e=a.selector?this.options.$obj.find(a.selector):this.options.$obj).outerWidth()/3&&0<=n&&i+e.outerWidth()/3<s(window).width()&&n+e.outerHeight()<s(window).height()&&this.$element.css({left:i,top:n}),a.drag&&a.drag.apply(this.$element,[this.$element,t]),this.preventEvent(t)},l.prototype.stop=function(t){return s(document).unbind("mousemove.bjui.basedrag").unbind("mouseup.bjui.basedrag"),this.options.stop&&this.options.stop.apply(this.$element,[this.$element,t]),this.options.event&&this.destroy(),document.onselectstart=function(t){return!0},this.preventEvent(t)},l.prototype.preventEvent=function(t){return t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),!1},l.prototype.destroy=function(){this.$element.removeData("bjui.basedrag"),this.options.nounbind||this.$element.unbind("mousedown")};var t=s.fn.basedrag;s.fn.basedrag=function(i){var n=arguments,o=i;return this.each(function(){var t=s(this),e=s.extend({},t.data(),"object"==typeof i&&i),a=t.data("bjui.basedrag");a||t.data("bjui.basedrag",a=new l(this,e)),"string"==typeof o&&s.isFunction(a[o])?([].shift.apply(n),n?a[o].apply(a,n):a[o]()):a.init()})},s.fn.basedrag.Constructor=l,s.fn.basedrag.noConflict=function(){return s.fn.basedrag=t,this}}(jQuery),function(r){"use strict";function s(t,e){this.$element=r(t),this.$bar=this.$element.find("#bjui-sidebar"),this.$sbar=this.$element.find("#bjui-sidebar-s"),this.$accordionmenu=this.$bar.find("#bjui-accordionmenu"),this.$lock=this.$bar.find("> .toggleCollapse > .lock"),this.$navtab=r("#bjui-navtab"),this.$collapse=this.$sbar.find(".collapse"),this.$split=r("#bjui-splitBar"),this.$split2=r("#bjui-splitBarProxy"),this.isfloat=!1,this.options=e}function n(i){var n=arguments,o=i;return this.each(function(){var t=r(this),e=r.extend({},t.data(),"object"==typeof i&&i),a=t.data("bjui.slidebar");a||t.data("bjui.slidebar",a=new s(this,e)),"string"==typeof o&&r.isFunction(a[o])?([].shift.apply(n),n?a[o].apply(a,n):a[o]()):a.init()})}r(function(){r("#bjui-leftside").after("\x3c!-- Adjust the width of Left slide --\x3e").after(FRAG.splitBar).after(FRAG.splitBarProxy)}),s.prototype.lock=function(){var t=this,e=t.$bar.outerWidth()+4,a=BJUI.windowWidth-r("#bjui-sidebar").width()-6;t.faLock(),t.hoverLock(),t.$sbar.animate({left:-10},20),t.$bar.removeClass("shadown"),t.isfloat=!1,t.$navtab.animate({left:e,width:a},500,function(){r(window).trigger(BJUI.eventType.resizeGrid)}),t.$split.show()},s.prototype.unlock=function(){var t=this,e=0-t.$bar.outerWidth(),a=BJUI.windowWidth-6;t.faUnLock(),t.hoverUnLock(),t.$navtab.animate({left:6,width:a},400),t.$bar.animate({left:e},500,function(){t.$sbar.animate({left:0},200),t.$split.hide(),r(window).trigger(BJUI.eventType.resizeGrid)}),t.isfloat=!1},s.prototype.float=function(){this.$sbar.animate({left:-10},200),this.$bar.addClass("shadown").animate({left:0},500),this.isfloat=!0},s.prototype.hideFloat=function(){var t=this,e=0-t.$bar.outerWidth();t.$bar.animate({left:e-10},500,function(){t.$sbar.animate({left:0},100)}),t.isfloat=!1},s.prototype.hoverLock=function(){var t=this;t.$lock.hover(function(){t.tipUnLock(),t.faUnLock()},function(){t.tipLock(),t.faLock()})},s.prototype.hoverUnLock=function(){var t=this;t.$lock.hover(function(){t.tipLock(),t.faLock()},function(){t.tipUnLock(),t.faUnLock()})},s.prototype.tipLock=function(){this.$lock.data("bs.tooltip")&&this.$lock.tooltip("destroy").tooltip({title:"保持锁定，始终显示导航栏",container:"body"})},s.prototype.tipUnLock=function(){this.$lock.data("bs.tooltip")&&this.$lock.tooltip("destroy").tooltip({title:"解除锁定，自动隐藏导航栏",container:"body"})},s.prototype.faLock=function(){this.$lock.find("> i").attr("class","fa fa-lock")},s.prototype.faUnLock=function(){this.$lock.find("> i").attr("class","fa fa-unlock-alt")},s.prototype.init=function(){var i=this;BJUI.ui.showSlidebar?i.hoverLock():i.unlock(),this.$lock.off("click.bjui.slidebar").on("click.bjui.slidebar",function(){i.isfloat?i.lock():i.unlock(),BJUI.ui.showSlidebar=!BJUI.ui.showSlidebar}),this.$collapse.hover(function(){i.float(),i.$navtab.click(function(){i.isfloat&&i.hideFloat()})}),this.$split.mousedown(function(e){i.$split2.each(function(){var t=r(this);return setTimeout(function(){t.show()},100),t.css({visibility:"visible",left:i.$split.css("left")}).basedrag(r.extend(i.options,{obj:i.$bar,move:"horizontal",event:e,stop:function(){r(this).css("visibility","hidden");var t=parseInt(r(this).css("left"))-parseInt(i.$split.css("left")),e=i.$bar.outerWidth()+t,a=parseInt(i.$navtab.css("left"))+t,t=i.$navtab.outerWidth()-t;i.$bar.css("width",e),i.$split.css("left",r(this).css("left")),i.$navtab.css({left:a,width:t})}})),!1})}),r("#bjui-hnav-navbar-box").length&&i.moveHnav(),i.$accordionmenu.collapse().on("hidden.bs.collapse",function(t){r(this).find("> .panel > .panel-heading").each(function(){var t=r(this);t.find("> h4 > a").hasClass("collapsed")&&(t.removeClass("active"),(t=t.parent()).is(":last-child")&&t.removeClass("last-child"))})}).on("shown.bs.collapse",function(t){r(this).find("> .panel > .panel-heading").each(function(){var t=r(this);t.find("> h4 > a").hasClass("collapsed")||(t.addClass("active"),(t=t.parent()).is(":last-child")&&t.addClass("last-child"))})}),i.clickMenu()},s.prototype.clickMenu=function(){var n=this;n.$bar.on("click","ul.menu-items li > a",function(t){t.preventDefault();var e=r(this),a=e.parent(),i=e.data("options").toObj(),t=a.find("> .menu-items-children");a.addClass("active"),i&&(i.url=e.attr("href"),i.url&&"javascript:;"!==i.url&&(i.onClose=function(){a.removeClass("active")},i.onSwitch=function(){n.$accordionmenu.find("ul.menu-items li").removeClass("switch"),a.addClass("switch")},i.title||(i.title=e.text()),i.target?e.dialog(i):e.navtab(i))),t.length&&a.toggleClass("open")})},s.prototype.moveHnav=function(){var t=r("#bjui-hnav-navbar-box"),e=t.find("> #bjui-hnav-navbar"),a=t.prev(),i=t.next();a.hover(function(){e.stop().animate({left:0},2e3,function(){a.hide()})},function(){e.stop(),t.data("hnav.move")&&i.show()}).on("click",function(){return e.stop().animate({left:0},"fast",function(){a.hide()}),!1}),i.hover(function(){e.stop().animate({left:t.width()-t.data("hnav.liw")-10},2e3,function(){i.hide()})},function(){e.stop(),"0px"!==e.css("left")&&a.show()}).on("click",function(){return e.stop().animate({left:t.width()-t.data("hnav.liw")-10},"fast",function(){i.hide()}),!1})},s.prototype.initHnav=function(){var o,t,s=this.$element.text().trim(),e=this.$element.parent(),l=r("#bjui-accordionmenu"),a=e.find("> .items > ul.ztree"),i=e.find("> .items > ul.menu-items");(a.length||i.length)&&(a.length&&(t=a),i.length&&(t=t?t.add(i):i,i.find("a").each(function(){var t=r(this),e=t.data("options");!t.data("icon.init")&&e&&"string"==typeof e&&(e=e.toObj())&&e.faicon&&(e.faicon=e.faicon.trim(),e.faicon.startsWith("fa-")&&(e.faicon=e.faicon.substr(3)),t.prepend('<i class="fa fa-'+e.faicon+'"></i>').data("icon.init",!0).attr("title",t.text()))})),l.empty(),t.each(function(t){var e,a,i=r(this),n=i.data("faicon")||"dot-circle-o";i.data("tit")&&(s=i.data("tit")),e=t?"collapsed":"",a=t?"":" in",a=FRAG.slidePanel.replaceAll("#id#","bjui-collapse"+t).replaceAll("#title#",s).replaceAll("#righticon#",'<i class="fa fa-angle-down"></i>').replaceAll("#class#",e).replaceAll("#bodyclass#",a),a=n?a.replaceAll("#icon#",'<i class="fa fa-'+n+'"></i>'):a.replaceAll("#icon#",""),(o=r(a)).find("> .panel-collapse > .panel-body").append(i.removeAttr("data-noinit")),l.append(o),t||o.collapse("show")}),r("#bjui-sidebar").initui(),e.addClass("active").data("bjui.slidebar.hnav.panels",l.find("> .panel")).siblings().removeClass("active"))};var t=r.fn.slidebar;r.fn.slidebar=n,r.fn.slidebar.Constructor=s,r.fn.basedrag.noConflict=function(){return r.fn.slidebar=t,this},r(document).one(BJUI.eventType.afterInitUI,function(t){r("#bjui-leftside").slidebar({minW:150,maxW:700})}),r(document).on("click.bjui.slidebar.data-api",'[data-toggle="slidebar"]',function(t){var e=r(this).parent(),a=r("#bjui-accordionmenu"),i=e.data("bjui.slidebar.hnav.panels");a.find("> .panel").detach(),i&&i.length?(a.append(i),e.addClass("active").siblings().removeClass("active")):n.call(r(this),"initHnav"),t.preventDefault()})}(jQuery),function(d){"use strict";function e(){this._$ul=d("#bjui-hnav-navbar"),this._$sidebar=d("#bjui-sidebar"),this._menus=[],this._initUi(),this._getMenusData(this._$ul,[],1),d("#bjui-hnav").remove(),d("#bjui-splitBar").remove(),this._bindEvent();var t=this._createMenuHtml(this._menus,"#bjui-sidebar__menu");this._$sidebar.html('<ul class="bjui-sidebar" id="bjui-sidebar__menu">'+t+"<ul>")}e.prototype._initUi=function(){var t,e=BJUI.layout.style;e&&(t="",e.headerBg&&(t+="#bjui-header{background: "+e.headerBg+"!important}"),e.sidebarBg&&(t+="#bjui-sidebar{background: "+e.sidebarBg+"}"),e.sidebarLightBg&&(t+=".bjui-sidebar .sidebar-dropdown .sidebar-link{background: "+e.sidebarLightBg+"}"),e.activeLinkBg&&(t+=".bjui-sidebar .sidebar-item.active>.sidebar-link:not([data-toggle=collapse]){background: "+e.activeLinkBg+"}"),e.activeLinkBorderLeftColor&&(t+=".bjui-sidebar .sidebar-item.active>.sidebar-link:not([data-toggle=collapse]){border-left-color: "+e.activeLinkBorderLeftColor+"}"),d("head").append("<style>"+t+"</style>"))},e.prototype._bindEvent=function(){var e=this;this._$sidebar.on("click",'[data-toggle="navtab"]',function(){var t=d(this);e._$sidebar.find("li").removeClass("active"),t.parentsUntil(e._$sidebar,"li").addClass("active")})},e.prototype._getMenusData=function(t,n,o){var s=this;t.children("li").each(function(){var i=d(this);return i.children("a").each(function(){var t=d(this),e=i.children("ul"),a={name:t.text(),path:"javascript:",icon:void 0,data:{},children:[]};e.length?s._getMenusData(e,a.children,o+1):(a.data=t.data()||{},a.path=t.attr("href")),1===o?((t=t.children("i")).length&&(a.icon=t.first().attr("class")),s._menus.push(a)):n.push(a)})})},e.prototype._createMenuHtml=function(t,s){var l="",r=this;return t.forEach(function(t){l+='<li class="sidebar-item">';var e="";if(t.icon&&t.icon.length&&(e='<i class="sidebar-item__icon align-middle '+t.icon+'"></i>'),t.children&&t.children.length){var a=d.getGUID();l+='<a data-target="#'+a+'" data-toggle="collapse" class="sidebar-link collapsed">'+e+'<span class="align-middle">'+t.name+"</span></a>",l+='<ul id="'+a+'" class="sidebar-dropdown list-unstyled collapse" data-parent="'+s+'">',l+=r._createMenuHtml(t.children,"#"+a),l+="</ul>"}else{var i="";if(t.path&&t.path.length&&(i=' data-url="'+t.path+'" data-toggle="navtab"'),t.data){var n,o=t.data;for(n in delete o.url,delete o.path,o)o.hasOwnProperty(n)&&"string"==typeof o[n]&&(i+=" data-"+n+'="'+o[n]+'"')}l+='<a class="sidebar-link" '+i+">"+e+'<span class="align-middle">'+t.name+"</span></a>"}l+="</li>"}),l},d(document).one(BJUI.eventType.afterInitUI,function(t){BJUI.layout&&"default"!==BJUI.layout.mode&&new e})}(jQuery),function(r){"use strict";var d,c,u;function s(t,e){this.$element=r(t),this.options=e}r(function(){d=r('<div id="bjui-contextmenu"></div>').hide(),c=r('<div id="bjui-contextmenuShadow"></div>').hide(),u=[],r("body").append("\x3c!-- contextmenu --\x3e").append(d).append(c)}),s.DEFAULTS={id:void 0,shadow:!0,bindings:{},ctrSub:null},s.prototype.init=function(){var e,a=this,i=this.options;i.id&&(u.push({id:i.id,shadow:i.shadow,bindings:i.bindings||{},ctrSub:i.ctrSub}),e=u.length-1,this.$element.on("contextmenu",function(t){return a.display(e,this,t,i),!1}))},s.prototype.display=function(t,a,e,i){var n=this,o=u[t],s=BJUI.regional[o.id],l=FRAG[o.id];r.each(s,function(t,e){l=l.replace("#"+t+"#",s[t])}),d.html(l),r.each(o.bindings,function(t,e){r('[rel="'+t+'"]',d).on("click",function(t){n.hide(),e(r(a),r("#bjui-"+o.id))})});t=e.pageX,e=e.pageY;r(window).width()<t+d.width()&&(t-=d.width()),r(window).height()<e+d.height()&&(e-=d.height()),d.css({left:t,top:e}).show(),o.shadow&&c.css({width:d.width(),height:d.height(),left:t+3,top:e+3}).show(),r(document).one("click",n.hide),r.isFunction(o.ctrSub)&&o.ctrSub(r(a),r("#bjui-"+o.id))},s.prototype.hide=function(){d.hide(),c.hide()},s.prototype.show=function(a){var i=this;a.items&&a.items.length&&i.$element.on("contextmenu",function(t){var e=!0;return a.exclude&&i.$element.find(a.exclude).each(function(){if(this===t.target||r(this).find(t.target).length)return e=!1,null}),e?(i.custom(a.items,t),!1):(t.stopPropagation(),!e)})},s.prototype.custom=function(t,e){d.empty().html("<ul></ul>");var i,n=this,a=n.options,o=d.find("> ul");r.each(t,function(t,e){var a="";e.icon&&(a='<i class="fa fa-'+e.icon+'"></i>'),"diver"===e.title?i=r('<li class="diver"></li>'):(i=r('<li><span class="icon">'+a+'</span><span class="title">'+e.title+"</span></li>"),e.func&&"string"==typeof e.func&&(e.func=e.func.toFunc()),e.func&&i.on("click",function(t){n.hide(),e.func(n.$element,i)})),i.appendTo(o)});t=e.pageX,e=e.pageY;r(window).width()<t+d.width()&&(t-=d.width()),r(window).height()<e+d.height()&&(e-=d.height()),d.css({left:t,top:e}).show(),a.shadow&&c.css({width:d.width(),height:d.height(),left:t+3,top:e+3}).show(),r(document).one("click",n.hide)};var t=r.fn.contextmenu;r.fn.contextmenu=function(i){var n=arguments,o=i;return this.each(function(){var t=r(this),e=r.extend({},s.DEFAULTS,t.data(),"object"==typeof i&&i),a=t.data("bjui.contextmenu");a||t.data("bjui.contextmenu",a=new s(this,e)),"string"==typeof o&&r.isFunction(a[o])?([].shift.apply(n),n?a[o].apply(a,n):a[o]()):a.init()})},r.fn.contextmenu.Constructor=s,r.fn.contextmenu.noConflict=function(){return r.fn.contextmenu=t,this}}(jQuery),function(d){"use strict";var c,o,s,t,u,h,i,n,l,p,r,f,g;d(function(){var a,e;c=0,t=d("#bjui-navtab"),u=t.find(".navtab-tab"),h=t.find(".navtab-panel"),i=t.find(".tabsLeft"),n=t.find(".tabsRight"),l=t.find(".tabsMore"),p=t.find(".tabsMoreList"),r=u.find("li:first"),f=p.find("li:first"),i.click(function(){d(this).navtab("scrollPrev")}),n.click(function(){d(this).navtab("scrollNext")}),l.click(function(){p.show()}),d(document).on("click.bjui.navtab.switchtab",function(t){t="I"===t.target.tagName?d(t.target).parent():d(t.target);l[0]!==t[0]&&p.hide()}),r.navtab("contextmenu",r).click(function(){d(this).navtab("switchTab","main")}).find("> a > span").html(function(t,e){return a=e.replace("#maintab#",BJUI.regional.maintab)}),e=d.extend({},m.DEFAULTS,r.data(),{id:"main",title:a}),r.data("initOptions",e).data("options",e),r.attr("data-url")&&d(document).one(BJUI.eventType.initUI,function(t){r.removeAttr("data-url").navtab("reload",e)}),setTimeout(function(){r.navtab("switchTab","main")},50),f.click(function(){d(this).hasClass("active")?p.hide():d(this).navtab("switchTab","main")}).find("> a").html(function(t,e){return e.replace("#maintab#",BJUI.regional.maintab)})});var m=function(t,e){this.$element=d(t),this.options=e,BJUI.layout&&!BJUI.layout.tags&&(this.options.id="main"),this.tools=this.TOOLS()};function b(i){var n=arguments,o=i;return this.each(function(){var t=d(this),e=d.extend({},m.DEFAULTS,"object"==typeof i&&i),a=t.data("bjui.navtab");a||t.data("bjui.navtab",a=new m(this,e)),"string"==typeof o&&d.isFunction(a[o])?([].shift.apply(n),n?a[o].apply(a,n):a[o]()):(a=new m(this,e)).openTab()})}m.DEFAULTS={id:void 0,title:"New tab",url:void 0,type:"GET",data:{},loadingmask:!0,fresh:!1,autorefresh:!1,onLoad:null,beforeClose:null,onClose:null},m.prototype.TOOLS=function(){var r=this;return{getDefaults:function(){return m.DEFAULTS},getTabs:function(){return u.find("> li")},getPanels:function(){return h.find("> div")},getMoreLi:function(){return p.find("> li")},getTab:function(t){t=this.indexTabId(t);if(0<=t)return this.getTabs().eq(t)},getPanel:function(t){t=this.indexTabId(t);if(0<=t)return this.getPanels().eq(t)},getTabsW:function(t,e){return this.tabsW(this.getTabs().slice(t,e))},tabsW:function(t){var e=0;return t.each(function(){e+=d(this).outerWidth(!0)}),e},indexTabId:function(e){if(!e)return-1;var a=-1;return this.getTabs().each(function(t){d(this).data("initOptions").id===e&&(a=t)}),a},getLeft:function(){return u.position().left},getScrollBarW:function(){return t.width()-55},visibleStart:function(){for(var t=this.getLeft(),e=0,a=this.getTabs(),i=0;i<a.size();i++){if(0<=e+t)return i;e+=a.eq(i).outerWidth(!0)}return 0},visibleEnd:function(){for(var t=this.getLeft(),e=0,a=this.getTabs(),i=0;i<a.size();i++)if((e+=a.eq(i).outerWidth(!0))+t>this.getScrollBarW())return i;return a.size()},scrollPrev:function(){var t=this.visibleStart();0<t&&this.scrollTab(-this.getTabsW(0,t-1))},scrollNext:function(){var t=this.visibleEnd();t<this.getTabs().size()&&this.scrollTab(-this.getTabsW(0,t+1)+this.getScrollBarW())},scrollTab:function(t,e){u.animate({left:t},200,function(){r.tools.ctrlScrollBtn()})},scrollCurrent:function(){var t=this.tabsW(this.getTabs()),e=this.getScrollBarW();t<=e?this.scrollTab(0):this.getLeft()<e-t?this.scrollTab(e-t):c<this.visibleStart()?this.scrollTab(-this.getTabsW(0,c)):c>=this.visibleEnd()&&this.scrollTab(e-this.getTabs().eq(c).outerWidth(!0)-this.getTabsW(0,c))},ctrlScrollBtn:function(){var t=this.tabsW(this.getTabs());this.getScrollBarW()>t?(i.hide(),n.hide(),u.parent().removeClass("tabsPageHeaderMargin")):(i.show().removeClass("tabsLeftDisabled"),n.show().removeClass("tabsRightDisabled"),u.parent().addClass("tabsPageHeaderMargin"),0<=this.getLeft()?i.addClass("tabsLeftDisabled"):this.getLeft()<=this.getScrollBarW()-t&&n.addClass("tabsRightDisabled"))},switchTab:function(t){var e=this.getTabs().removeClass("active").eq(t).addClass("active"),a=this.getPanels(),i=a.eq(t),n=r.options.onSwitch?r.options.onSwitch.toFunc():null;e.data("reloadFlag")?(a.hide(),i.show(),r.refresh(e.data("initOptions").id)):(a.hide(),i.find(".bjui-ajax-mask").length?i.show():(i.addClass("fade").removeClass("in").show(),d.support.transition?i.one("bsTransitionEnd",function(){i.addClass("in")}).emulateTransitionEnd(10):i.removeClass("fade"))),this.getMoreLi().removeClass("active").eq(t).addClass("active"),c=t,this.scrollCurrent(),o=e,d.CurrentNavtab=s=i,n&&n.apply(r),i.trigger("bjui.navtab.switch")},closeTab:function(t,e){var a=this.getTabs().eq(t),i=this.getMoreLi().eq(t),n=this.getPanels().eq(t),o=a.data("options"),s=o.beforeClose?o.beforeClose.toFunc():null,l=o.onClose?o.onClose.toFunc():null,o=!0;s&&(o=s.apply(r,[n])),o?(BJUI.ModuleFixed.destroyModules(n),a.remove(),i.remove(),n.trigger(BJUI.eventType.beforeCloseNavtab).remove(),g&&clearInterval(g),l&&l.apply(r),t<=c&&c--,!e||0<(e=this.indexTabId(e))&&(c=e),this.scrollCurrent(),this.switchTab(c)):r.tools.switchTab(t)},closeOtherTab:function(e){e=e||c,this.getTabs().each(function(t){0<t&&e!==t&&d(this).find("> .close").trigger("click")})},loadUrlCallback:function(t){t.find(":button.btn-close").click(function(){r.closeCurrentTab()})},reload:function(t,e){e=e||t.data("reloadFlag");var a=t.data("options");e&&(t.data("reloadFlag",!1),e=r.tools.getPanel(a.id),t.hasClass("external")?r.openExternal(a.url,e):r.tools.reloadTab(e,a))},reloadTab:function(e,t){var a=t.onLoad?t.onLoad.toFunc():null,i=t.autorefresh&&(isNaN(String(t.autorefresh))?15:t.autorefresh);BJUI.ModuleFixed.destroyModules(e),t.data&&(t.data="object"==typeof t.data?t.data:t.data.toObj()),e.trigger(BJUI.eventType.beforeLoadNavtab).ajaxUrl({type:t.type||"GET",url:t.url,data:t.data||{},loadingmask:t.loadingmask,callback:function(t){r.tools.loadUrlCallback(e),a&&a.apply(r,[e]),g&&clearInterval(g),i&&(g=setInterval(function(){e.navtab("refresh")},1e3*i)),BJUI.ui.clientPaging&&e.data("bjui.clientPaging")&&e.pagination("setPagingAndOrderby",e)}})}}},m.prototype.contextmenu=function(t){var a=this;t.contextmenu({id:"navtabCM",bindings:{reload:function(t,e){a.refresh(t.data("initOptions").id)},closeCurrent:function(t,e){t=t.data("initOptions").id;t?a.closeTab(t):a.closeCurrentTab()},closeOther:function(t,e){0===t.index()?a.closeAllTab():(t=a.tools.indexTabId(t.data("initOptions").id),a.tools.closeOtherTab(0<t?t:c))},closeAll:function(t,e){a.closeAllTab()}},ctrSub:function(t,e){var a=e.find('[rel="reload"]'),e=e.find('[rel="closeCurrent"]');0===t.index()&&(e.addClass("disabled"),t.data("url")||a.addClass("disabled"))}})},m.prototype.openTab=function(){var e=this,t=this.$element,a=this.options,i=this.tools;if(!a.url&&a.href&&(a.url=a.href),a.url){if(a.url=decodeURI(a.url).replacePlh(t.closest(".unitBox")),!a.url.isFinishedTm())return t.alertmsg("error",a.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("Navtab Plugin: The new navtab's url is incorrect, url: "+a.url);a.url=encodeURI(a.url);var n,o,s,l=a.id?i.indexTabId(a.id):c;a.id||BJUI.ui.overwriteHomeTab||0!==l||(a.id="navtab",l=-1),0<=l?(a.id||delete a.id,o=i.getTabs().eq(l),s=i.getPanels().eq(l),n=o.data("initOptions"),t=d.extend({},n,a),(n.fresh||a.fresh||n.url!==a.url)&&e.reload(t),c=l):(o=d('<li><a href="javascript:" title="#title#"><span>#title#</span></a><span class="close">&times;</span></li>'.replaceAll("#title#",a.title)),s=d('<div class="navtabPage unitBox"></div>'),l=d('<li><a href="javascript:" title="#title#">#title#</a></li>'.replaceAll("#title#",a.title)),o.appendTo(u),s.appendTo(h),l.appendTo(p),o.data("options",a).data("initOptions",a),a.external||a.url&&a.url.isExternalUrl()?(o.addClass("external"),this.openExternal(a.url,s)):(o.removeClass("external"),i.reloadTab(s,a)),c=i.getTabs().length-1,this.contextmenu(o),o.on("click",function(t){t=d(t.target);if(t.hasClass("close"))e.closeTab(a.id);else{if(t.closest("li").hasClass("active"))return!1;e.switchTab(a.id)}}),l.on("click",function(){e.switchTab(a.id)})),i.switchTab(c),i.scrollCurrent()}else BJUI.debug("Navtab Plugin: Error trying to open a navtab, url is undefined!")},m.prototype.closeTab=function(t){t=this.tools.indexTabId(t);0<t&&this.tools.closeTab(t)},m.prototype.closeCurrentTab=function(t){0<c&&this.tools.closeTab(c,t)},m.prototype.closeAllTab=function(){this.tools.getTabs().find("> .close").each(function(){d(this).trigger("click")})},m.prototype.reloadFlag=function(t){for(var e=t.split(","),a=0;a<e.length;a++){var i=this.tools.getTab(e[a].trim());i&&(this.tools.indexTabId(e[a])===c?this.tools.reload(i,!0):i.data("reloadFlag",!0))}},m.prototype.switchTab=function(t){t=this.tools.indexTabId(t);this.tools.switchTab(t)},m.prototype.scrollPrev=function(){this.tools.scrollPrev()},m.prototype.scrollNext=function(){this.tools.scrollNext()},m.prototype.refresh=function(t){t=t?"string"==typeof t?this.tools.getTab(t):t:o;t&&t.length&&(this.tools.getPanel(t.data("initOptions").id).removeData("bjui.clientPaging"),this.reload(t.data("initOptions")))},m.prototype.reload=function(t,e){var a,i,n,o=this,t=d.extend({},"object"==typeof t&&t),s=t.id?this.tools.getTab(t.id):this.tools.getTabs().eq(c);s&&(a=s.data("initOptions")||{},i=d.extend({},a,t),n=function(){a.title!==i.title&&s.find("> a").attr("title",i.title).find("> span").html(i.title),e||s.data("initOptions",i),s.data("options",i),o.tools.reload(s,!0)},t.reloadWarn?this.$element.alertmsg("confirm",t.reloadWarn,{okCall:function(){n()}}):n())},m.prototype.reloadForm=function(t,e){var a=d.extend({},"object"==typeof e&&e),i="string"==typeof e?(n=this.tools.getTab(e),this.tools.getPanel(e)):(n=a.id?this.tools.getTab(a.id):this.tools.getTabs().eq(c),a.id?this.tools.getPanel(a.id):this.tools.getPanels().eq(c));if(n&&i){if(!n.hasClass("external")){var n=i.find("#pagerForm"),o={},s={};if(n.attr("action")&&(a.url=n.attr("action")),n&&n.length){if(s=n.serializeJson(),e&&e.type||(a.type=n.attr("method")||"POST"),t){var l,r=BJUI.pageInfo;for(l in s[r.orderDirection]=s[r.orderField]="",i.data("bjui.clientPaging")&&(i.data("bjui.clientPaging").orderDirection=i.data("bjui.clientPaging").orderField=""),r)r.hasOwnProperty(l)&&(o[r[l]]=s[r[l]])}else o=s;a.data=d.extend({},a.data||{},o)}}this.reload(a,!0)}},m.prototype.getCurrentPanel=function(){return this.tools.getPanels().eq(c)},m.prototype.closeOtherTab=function(){return this.tools.closeOtherTab()},m.prototype.checkTimeout=function(){var t=JSON.parse(s.html());t&&t[BJUI.keys.statusCode]===BJUI.statusCode.timeout&&this.closeCurrentTab()},m.prototype.openExternal=function(t,e){var a=e.closest(".navtab-panel").height();e.html(FRAG.externalFrag.replaceAll("{url}",t).replaceAll("{height}",a+"px"))};var e=d.fn.navtab;d.fn.navtab=b,d.fn.navtab.Constructor=m,d.fn.navtab.noConflict=function(){return d.fn.navtab=e,this},d(document).on("click.bjui.navtab.data-api",'[data-toggle="navtab"]',function(t){var e=d(this),a=e.attr("href"),i=e.data(),n=i.options;n&&("string"==typeof n&&(n=n.toObj()),"object"==typeof n&&d.extend(i,n)),i.title||(i.title=e.text()),a&&!i.url&&(i.url=a),b.call(e,i),t.preventDefault()})}(jQuery),function(r){"use strict";var o,l,d;r(function(){l="dialogShadow",d=c.ZINDEX,r("body").append("\x3c!-- dialog resizable --\x3e").append(FRAG.resizable)});var c=function(t,e){this.$element=r(t),this.options=e,this.tools=this.TOOLS()};function s(i){var n=arguments,o=i;return this.each(function(){var t=r(this),e=r.extend({},c.DEFAULTS,BJUI.dialog,"object"==typeof i&&i),a=t.data("bjui.dialog");a||t.data("bjui.dialog",a=new c(this,e)),"string"==typeof o&&r.isFunction(a[o])?([].shift.apply(n),n?a[o].apply(a,n):a[o]()):(a=new c(this,e)).open()})}c.DEFAULTS={id:"dialog",title:"New Dialog",url:void 0,type:"GET",data:{},loadingmask:!0,width:500,height:300,minW:65,minH:40,max:!1,mask:!1,resizable:!0,drawable:!0,maxable:!0,minable:!0,fresh:!1,onLoad:null,beforeClose:null,onClose:null},c.ZINDEX=30,c.prototype.TOOLS=function(){var s=this;return{getDefaults:function(){return r.extend(c.DEFAULTS,BJUI.dialog)},init:function(t){var e=s.options.width>s.options.minW?s.options.width:s.options.minW,a=s.options.height>s.options.minH?s.options.height:s.options.minH,i=r(window).width(),n=r(window).height(),o=s.options.max?0:(n-a)/2;i<e&&(e=i),n<a&&(a=n),t.height(a).width(e).show().css({left:(i-e)/2,top:0,opacity:.1}).animate({top:0<o?o:0,opacity:1}).addClass(l).find("> .dialogContent").height(a-r("> .dialogHeader",t).outerHeight()-6),r("body").find("> .bjui-dialog-container").not(t).removeClass(l)},reload:function(e,t){var a,i,n=e.find("> .dialogContent");t=t||e.data("initOptions"),a=t.onLoad?t.onLoad.toFunc():null,e.trigger(BJUI.eventType.beforeLoadDialog),BJUI.ModuleFixed.destroyModules(e),t.data&&(t.data="object"==typeof t.data?t.data:t.data.toObj()),t.url?n.ajaxUrl({type:t.type||"GET",url:t.url,data:t.data||{},loadingmask:t.loadingmask,callback:function(t){a&&a.apply(s,[e]),BJUI.ui.clientPaging&&e.data("bjui.clientPaging")&&e.pagination("setPagingAndOrderby",e)}}):t.target&&(i=r(t.target).html()||e.data("bjui.dialog.target"),r(t.target).empty(),e.data("bjui.dialog.target",i),n.trigger(BJUI.eventType.beforeAjaxLoad).html(i).initui(),a&&a.apply(s,[e]))},resizeContent:function(t,e,a){t.find("> .dialogContent").css({width:e-12,height:a-t.find("> .dialogHeader").outerHeight()-6}).resizePageH(),r(window).trigger(BJUI.eventType.resizeGrid)}}},c.prototype.open=function(){var t,a=this,i=a.options,e=r("body"),n=e.data(i.id);if(i.target&&r(i.target).length)i.url=void 0;else{if(!i.url&&i.href&&(i.url=i.href),!i.url)return void BJUI.debug("Dialog Plugin: Error trying to open a dialog, url is undefined!");if(i.url=decodeURI(i.url).replacePlh(a.$element.closest(".unitBox")),!i.url.isFinishedTm())return a.$element.alertmsg("error",i.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("Dialog Plugin: The new dialog's url is incorrect, url: "+i.url);i.url=encodeURI(i.url)}n?(t=n.data("initOptions")||i,this.switchDialog(n),n.is(":hidden")&&n.show(),!t.fresh&&!i.fresh&&t.url&&t.url===i.url||(a.reload(i),n.data("initOptions",i))):(t=BJUI.regional.dialog,t=FRAG.dialog.replace("#close#",t.close).replace("#maximize#",t.maximize).replace("#restore#",t.restore).replace("#minimize#",t.minimize).replace("#title#",t.title),(n=r(t).data("options",i).data("initOptions",i).css("zIndex",d+=1).hide().appendTo(e)).find("> .dialogHeader > h1 > span.title").html(i.title),this.tools.init(n),i.maxable?n.find("a.maximize").show():n.find("a.maximize").hide(),i.minable?n.find("a.minimize").show():n.find("a.minimize").hide(),i.max&&a.maxsize(n),i.mask?this.addMask(n):i.minable&&r.fn.taskbar&&this.$element.taskbar({id:i.id,title:i.title}),n.on("click",function(t){r(t.target).data("bjui.dialog")||o&&o[0]!==n[0]&&a.switchDialog(n)}).on("click",".btn-close",function(t){a.close(n),t.preventDefault()}).on("click",".dialogHeader > a",function(t){var e=r(this);e.hasClass("close")&&a.close(n),e.hasClass("minimize")&&a.minimize(n),e.hasClass("maximize")&&(a.switchDialog(n),a.maxsize(n)),e.hasClass("restore")&&a.restore(n),t.preventDefault(),t.stopPropagation()}).on("dblclick",".dialogHeader > h1",function(t){i.maxable&&(n.find("> .dialogHeader > a.restore").is(":hidden")?n.find("a.maximize"):n.find("> .dialogHeader > a.restore")).trigger("click")}).on("mousedown.bjui.dialog.drag",".dialogHeader > h1",function(t){a.switchDialog(n),i.drawable&&!n.data("max")&&(n.data("bjui.dialog.task",!0),setTimeout(r.proxy(function(){n.data("bjui.dialog.task")&&a.drag(t,n)},a),150),t.preventDefault())}).on("mouseup.bjui.dialog.drag",".dialogHeader > h1",function(t){n.data("bjui.dialog.task",!1)}).on("mousedown.bjui.dialog.resize",'div[class^="resizable"]',function(t){var e;i.drawable&&!n.data("max")&&(e=r(this),a.switchDialog(n),a.resizeInit(t,r("#bjui-resizable"),n,e),e.show(),t.preventDefault())}).on("mouseup.bjui.dialog.resize",'div[class^="resizable"]',function(t){t.preventDefault()}),e.data(i.id,n),this.tools.reload(n,i)),r.CurrentDialog=o=n},c.prototype.addMask=function(t){var e=t.data("bjui.dialog.mask");t.wrap('<div style="z-index:'+d+'" class="bjui-dialog-wrap"></div>'),t.find("> .dialogHeader > a.minimize").hide(),e&&e.length||((e=r(FRAG.dialogMask)).css("zIndex",1).show().insertBefore(t),t.data("bjui.dialog.mask",e))},c.prototype.refresh=function(t){if(t&&"string"==typeof t)for(var e=t.split(","),a=0;a<e.length;a++){var i=r("body").data(e[a].trim());i&&(i.removeData("bjui.clientPaging"),this.tools.reload(i))}else o.removeData("bjui.clientPaging"),this.tools.reload(o)},c.prototype.reload=function(t,e){var a,i,n,o=this,t=r.extend({},"object"==typeof t&&t),s=t.id&&r("body").data(t.id)||o.getCurrent();s&&s.length&&(a=s.data("initOptions"),i=r.extend({},a,t),n=function(){var t=s.find("> .dialogContent");a.width!==i.width&&(i.max?(s.width(i.width),t.width(i.width)):s.animate({width:i.width},"normal",function(){t.width(i.width)})),a.height!==i.height&&(i.max?(s.height(i.height),t.height(i.height-s.find("> .dialogHeader").outerHeight()-6)):s.animate({height:i.height},"normal",function(){t.height(i.height-s.find("> .dialogHeader").outerHeight()-6).resizePageH()})),a.maxable!==i.maxable&&(i.maxable?s.find("a.maximize").show():s.find("a.maximize").hide()),a.minable!==i.minable&&(i.minable?s.find("a.minimize").show():s.find("a.minimize").hide()),a.max!==i.max&&i.max&&setTimeout(o.maxsize(s),10),a.mask!==i.mask&&(i.mask?(o.addMask(s),r.fn.taskbar&&o.$element.taskbar("closeDialog",i.id)):i.minable&&r.fn.taskbar&&o.$element.taskbar({id:i.id,title:i.title})),a.title!==i.title&&(s.find("> .dialogHeader > h1 > span.title").html(i.title),s.taskbar("changeTitle",i.id,i.title)),s.data("options",i),e||s.data("initOptions",i),o.tools.reload(s,i)},i.reloadWarn?s.alertmsg("confirm",i.reloadWarn,{okCall:function(){n()}}):n())},c.prototype.reloadForm=function(t,e){var a;if("string"==typeof e?a=(n=r("body").data(e)).data("options"):"object"==typeof e&&(n=e.id&&r("body").data(e.id)||this.getCurrent()),n){"object"==typeof e&&(e.title&&n.find("> .dialogHeader > h1 > span.title").html(e.title),a=r.extend({},e,n.data("options")));var i,n=n.find("#pagerForm"),o={};if(n.attr("action")&&(a.url=n.attr("action")),n&&n.length){if(i=n.serializeJson(),e&&e.type||(a.type=n.attr("method")||"POST"),t){var s,l=BJUI.pageInfo;for(s in l)l.hasOwnProperty(s)&&(o[l[s]]=i[l[s]])}else o=i;a.data=r.extend({},a.data||{},o)}this.reload(a,!0)}},c.prototype.getCurrent=function(){return o},c.prototype.switchDialog=function(t){var e,a=t.css("zIndex");o&&o!==t&&(e=o.css("zIndex"),o.css("zIndex",a),t.css("zIndex",e),r.CurrentDialog=o=t,r.fn.taskbar&&this.$element.taskbar("switchTask",t.data("options").id)),t.addClass(l),r("body").find("> .bjui-dialog-container").not(t).removeClass(l)},c.prototype.close=function(t){var a=this,i="string"==typeof t?r("body").data(t):t,e=i.data("bjui.dialog.mask"),n=i.data("options"),o=i.data("bjui.dialog.target"),s=n.beforeClose?n.beforeClose.toFunc():null,l=n.onClose?n.onClose.toFunc():null,t=!0;i&&n&&(s&&(t=s.apply(a,[i])),t?(BJUI.ModuleFixed.destroyModules(i),n.target&&o&&r(n.target).html(o),e&&e.length?(e.remove(),i.unwrap()):r.fn.taskbar&&this.$element.taskbar("closeDialog",n.id),i.animate({top:-i.outerHeight(),opacity:.1},"normal",function(){var t=r("body");t.removeData(n.id),i.trigger(BJUI.eventType.beforeCloseDialog).remove(),l&&l.apply(a);var e=t.find(".bjui-dialog-container"),t=null;e.length?t=a.$element.getMaxIndexObj(e):d=c.ZINDEX,t&&t.is(":visible")&&a.switchDialog(t)})):a.switchDialog(i))},c.prototype.closeCurrent=function(){this.close(o)},c.prototype.checkTimeout=function(){var t=o.find("> .dialogContent"),t=JSON.parse(t.html());t&&t[BJUI.keys.statusCode]===BJUI.statusCode.timeout&&this.closeCurrent()},c.prototype.maxsize=function(t){t.data("original",{top:t.css("top"),left:t.css("left"),width:t.css("width"),height:t.css("height")}).data("max",!0),t.find("> .dialogHeader > a.maximize").hide(),t.find("> .dialogHeader > a.restore").show();var e=r(window).width(),a=r(window).height()-r("#bjui-taskbar").height()-1;t.css({top:0,left:0,width:e,height:a}),this.tools.resizeContent(t,e,a)},c.prototype.restore=function(t){var e=t.data("original"),a=parseInt(e.width),i=parseInt(e.height);t.css({top:e.top,left:e.left,width:a,height:i}),this.tools.resizeContent(t,a,i),t.find("> .dialogHeader > a.maximize").show(),t.find("> .dialogHeader > a.restore").hide(),t.data("max",!1)},c.prototype.minimize=function(t){t.hide(),r.fn.taskbar&&this.$element.taskbar("minimize",t)},c.prototype.drag=function(t,e){e.find("> .dialogContent").css("opacity",".3"),e.basedrag({selector:"> .dialogHeader",stop:function(){e.css({left:e.css("left"),top:e.css("top")}).find("> .dialogContent").css("opacity",1)},event:t,nounbind:!0})},c.prototype.resizeDialog=function(t,e,a){var i=parseInt(t.css("left")),n=parseInt(t.css("top")),o=parseInt(t.css("height")),t=parseInt(t.css("width"));n<0&&(n=0),e.css({top:n,left:i,width:t+2,height:o+1}).find("> .dialogContent").css("width",t-10),"w"!==a&&"e"!==a&&e.find("> .dialogContent").css({height:o-e.find("> .dialogHeader").outerHeight()-6}).resizePageH(),r(window).trigger(BJUI.eventType.resizeGrid)},c.prototype.resizeInit=function(t,e,a,i){i=i.attr("tar");r("body").css("cursor",i+"-resize"),e.css({top:a.css("top"),left:a.css("left"),height:a.outerHeight(),width:a.css("width")}).show(),this.options.dragCurrent||(this.options.dragCurrent={$resizable:e,$dialog:a,target:i,oleft:parseInt(e.css("left"))||0,owidth:parseInt(e.css("width"))||0,otop:parseInt(e.css("top"))||0,oheight:parseInt(e.css("height"))||0,ox:t.pageX||t.screenX,oy:t.pageY||t.clientY},r(document).on("mouseup.bjui.dialog.resize",r.proxy(this.resizeStop,this)),r(document).on("mousemove.bjui.dialog.resize",r.proxy(this.resizeStart,this)))},c.prototype.resizeStart=function(t){var e,a,i,n,o=this.options.dragCurrent;o&&(e=((t=t||window.event).pageX||t.screenX)-o.ox,a=(t.pageY||t.clientY)-o.oy,((n=o.$dialog.data("bjui.dialog.mask"))&&n.length||!((t.pageY||t.clientY)<=0||(t.pageY||t.clientY)>=r(window).height()-o.$dialog.find("> .dialogHeader").outerHeight()))&&(i=o.target,n=o.owidth,t=o.oheight,"n"!==i&&"s"!==i&&(n+=0<=i.indexOf("w")?-e:e),n>=this.options.minW&&(0<=i.indexOf("w")&&o.$resizable.css("left",o.oleft+e),"n"!==i&&"s"!==i&&o.$resizable.css("width",n)),"w"!==i&&"e"!==i&&(t+=0<=i.indexOf("n")?-a:a),t>=this.options.minH&&(0<=i.indexOf("n")&&o.$resizable.css("top",o.otop+a),"w"!==i&&"e"!==i&&o.$resizable.css("height",t))))},c.prototype.resizeStop=function(t){var e=this.options.dragCurrent;if(!e)return!1;r(document).off("mouseup.bjui.dialog.resize"),r(document).off("mousemove.bjui.dialog.resize"),this.options.dragCurrent=null,this.resizeDialog(e.$resizable,e.$dialog,e.target),r("body").css("cursor",""),e.$resizable.hide()};var t=r.fn.dialog;r.fn.dialog=s,r.fn.dialog.Constructor=c,r.fn.dialog.noConflict=function(){return r.fn.dialog=t,this},r(document).on("click.bjui.dialog.data-api",'[data-toggle="dialog"]',function(t){var e=r(this),a=e.attr("href"),i=e.data(),n=i.options;n&&("string"==typeof n&&(n=n.toObj()),"object"==typeof n&&r.extend(i,n)),i.title||(i.title=e.text()),a&&!i.url&&(i.url=a),s.call(e,i),t.preventDefault()})}(jQuery),function(s){"use strict";var i,t,e,n,a,o,l,r,d;function c(t,e){this.$element=s(t),this.$task=null,this.options=e,this.tools=this.TOOLS()}s(function(){i=s("#bjui-resizable"),t=s(FRAG.taskbar),e=t.find(".taskbarContent"),n=e.find("> ul"),a=t.find(".taskbarLeft"),o=t.find(".taskbarRight"),l="disabled",r="selected",d="taskbarMargin",s("body").append("\x3c!-- dialog task bar --\x3e").append(t),a.click(function(t){s(this).taskbar("scrollLeft")}),o.click(function(t){s(this).taskbar("scrollRight")})}),c.DEFAULTS={id:void 0,title:void 0},c.prototype.init=function(){var e=this,a=n.find("#"+this.options.id);this.show(),a.length?a.find("> div > span.title").html(this.options.title):(a=s('<li id="#taskid#"><div class="taskbutton"><span><i class="fa fa-th-large"></i></span> <span class="title">#title#</span></div><div class="close"><i class="fa fa-times-circle"></i></div></li>'.replace("#taskid#",this.options.id).replace("#title#",this.options.title))).appendTo(n),this.contextmenu(a),this.switchTask(a),this.tools.scrollTask(a),a.click(function(t){return s(t.target).closest("div").hasClass("close")||s(t.target).hasClass("close")?a.dialog("close",e.options.id):(t=s("body").data(e.options.id),a.hasClass("selected")?t.find(".dialogHeader a.minimize").trigger("click"):t.is(":hidden")?e.restoreDialog(t):(t.trigger("click"),a.addClass(r)),e.scrollCurrent(a)),!1})},c.prototype.TOOLS=function(){return{scrollCurrent:function(){var t,e;this.tasksW(this.getTasks())>this.getTaskBarW()?(t=this,e=n.find("> li:last-child"),e=this.getTaskBarW()-e.position().left-e.outerWidth(!0),n.animate({left:e},200,function(){t.ctrlScrollBtn()})):this.ctrlScrollBtn()},getTaskBarW:function(){return e.width()-(a.is(":hidden")?a.width()+2:0)-(o.is(":hidden")?o.width()+2:0)},scrollTask:function(t){var e,a=this;t.position().left+this.getLeft()+t.outerWidth()>this.getBarWidth()?(e=this.getTaskBarW()-t.position().left-t.outerWidth(!0)-2,n.animate({left:e},200,function(){a.ctrlScrollBtn()})):t.position().left+this.getLeft()<0&&(e=this.getLeft()-(t.position().left+this.getLeft()),n.animate({left:e},200,function(){a.ctrlScrollBtn()}))},ctrlScrollBtn:function(){var t=this.tasksW(this.getTasks());this.getTaskBarW()>t?(e.removeClass(d),o.hide(),a.hide(),this.getTasks().eq(0).length&&this.scrollTask(this.getTasks().eq(0))):(e.addClass(d),o.show().removeClass(l),a.show().removeClass(l),0<=this.getLeft()&&a.addClass(l),this.getLeft()<=this.getTaskBarW()-t&&o.addClass(l))},getLeft:function(){return n.position().left},visibleStart:function(){for(var t=this.getLeft(),e=this.getTasks(),a=0;a<e.size();a++)if(0<=e.eq(a).position().left+e.eq(a).outerWidth(!0)+t)return e.eq(a);return e.eq(0)},visibleEnd:function(){for(var t=this.getLeft(),e=this.getTasks(),a=0;a<e.size();a++)if(e.eq(a).position().left+e.eq(a).outerWidth(!0)+t>this.getBarWidth())return e.eq(a);return e.eq(e.size()-1)},getTasks:function(){return n.find("> li")},tasksW:function(t){var e=0;return t.each(function(){e+=s(this).outerWidth(!0)}),e},getBarWidth:function(){return t.innerWidth()},getCurrent:function(){return n.find("li."+r)}}},c.prototype.contextmenu=function(t){var i=this;t.contextmenu({id:"dialogCM",bindings:{reload:function(t){t.dialog("refresh",i.options.id)},closeCurrent:function(t,e){(t.isTag("li")?t:i.tools.getCurrent()).find(".close").trigger("click")},closeOther:function(t,e){n.find("> li").not(t).each(function(t){s(this).find(".close").trigger("click")})},closeAll:function(t,e){i.tools.getTasks().each(function(t){s(this).find(".close").trigger("click")})}},ctrSub:function(t,e){var a=e.find('[rel="closeCurrent"]'),e=e.find('[rel="closeOther"]');i.tools.getCurrent().length?1===i.tools.getTasks().size()&&e.addClass(l):(a.addClass(l),e.addClass(l))}})},c.prototype.closeDialog=function(t){t="string"==typeof t?this.getTask(t):t;t&&t.length&&(t.remove(),0===this.tools.getTasks().size()&&this.hide(),this.tools.scrollCurrent(),this.$element.removeData("bjui.taskbar"))},c.prototype.minimize=function(t){var e=this,t="string"==typeof t?s("body").data("dialog"):t,a=this.getTask(t.data("options").id);i.css({top:t.css("top"),left:t.css("left"),height:t.css("height"),width:t.css("width")}).show().animate({top:s(window).height()-60,left:a.position().left,width:a.outerWidth(),height:a.outerHeight()},250,function(){s(this).hide(),e.inactive(a)})},c.prototype.restoreDialog=function(t){var e=this.getTask(t.data("options").id);i.css({top:s(window).height()-60,left:e.position().left,height:e.outerHeight(),width:e.outerWidth()}).show().animate({top:t.css("top"),left:t.css("left"),width:t.css("width"),height:t.css("height")},250,function(){s(this).hide(),t.show()}),this.switchTask(e)},c.prototype.inactive=function(t){("string"==typeof t?this.getTask(t):t).removeClass(r)},c.prototype.scrollLeft=function(){var t=this.tools.visibleStart();this.tools.scrollTask(t)},c.prototype.scrollRight=function(){var t=this.tools.visibleEnd();this.tools.scrollTask(t)},c.prototype.scrollCurrent=function(t){this.tools.scrollTask(t)},c.prototype.switchTask=function(t){this.tools.getCurrent().removeClass(r),("string"==typeof t?this.getTask(t):t).addClass(r)},c.prototype.getTask=function(t){return n.find("#"+t)},c.prototype.changeTitle=function(t,e){t=this.getTask(t);t&&e&&t.find(".title").html(e)},c.prototype.show=function(){t.is(":hidden")&&t.show().animate({bottom:0},500)},c.prototype.hide=function(){t.is(":visible")&&t.animate({bottom:-50},500,function(){t.hide()})};var u=s.fn.taskbar;s.fn.taskbar=function(i){var n=arguments,o=i;return this.each(function(){var t=s(this),e=s.extend({},c.DEFAULTS,t.data(),"object"==typeof i&&i),a=t.data("bjui.taskbar");a&&a.options.id===e.id||t.data("bjui.taskbar",a=new c(this,e)),"string"==typeof o&&s.isFunction(a[o])?([].shift.apply(n),n?a[o].apply(a,n):a[o]()):a.init()})},s.fn.taskbar.Constructor=c,s.fn.taskbar.noConflict=function(){return s.fn.taskbar=u,this}}(jQuery),function(d){"use strict";function c(t,e){this.$element=d(t),this.options=e,this.tools=this.TOOLS()}var n;function o(i){var n=arguments,o=i;return this.each(function(){var t=d(this),e=d.extend({},c.DEFAULTS,t.data(),"object"==typeof i&&i),a=t.data("bjui.bjuiajax");a||t.data("bjui.bjuiajax",a=new c(this,e)),"string"==typeof o&&d.isFunction(a[o])&&([].shift.apply(n),n?a[o].apply(a,n):a[o]())})}c.DEFAULTS={reload:!0,loadingmask:!0},c.NAVTAB="navtab",c.prototype.TOOLS=function(){var t=this;return{getPagerForm:function(t,e){var a,i=(t.isTag("form")?t:t.find("#pagerForm:first"))[0],n=d.extend({},BJUI.pageInfo);if(t.data("bjui.clientPaging")&&(e=d.extend({},t.data("bjui.clientPaging"),e),t.data("bjui.clientPaging",e)),i)for(var o in n)n.hasOwnProperty(o)&&(a="",e&&e[o]&&(a=e[o]),i[n[o]]?a&&(i[n[o]].value=a):d('<input type="hidden" name="'+n[o]+'" value="'+a+'">').appendTo(d(i)));return i},getTarget:function(){return t.$element.closest(".navtab-panel").length?c.NAVTAB:"dialog"}}},c.prototype.ajaxForm=function(i){var n=this,o=this.$element,s=i&&i.callback,l=o.attr("enctype");i=d.extend({},n.options,"object"==typeof i&&i),s=s&&s.toFunc();function r(t,e,a){s?s.apply(n,[t,o]):d.proxy(n.ajaxCallback(t),n)}function t(){var t,e,a={loadingmask:i.loadingmask,type:o.attr("method"),url:o.attr("action"),callback:r,error:d.proxy(n.ajaxError,n)};l&&"multipart/form-data"===l?window.FormData?d.extend(a,{data:new FormData(o[0]),contentType:!1,processData:!1}):d.extend(a,{data:o.serializeArray(),files:o.find(":file"),iframe:!0,processData:!1}):(e=void 0,(t=o.data("extra"))&&("string"==typeof t&&(t=t.toObj()),"object"==typeof t&&(a.contentType="application/json",e=JSON.stringify(d.extend(t,o.serializeJson())))),d.extend(a,{data:e||o.serializeArray()})),o.doAjax(a)}i.confirmMsg?o.alertmsg("confirm",i.confirmMsg,{okCall:t}):t()},c.prototype.ajaxDone=function(t){var e=this.$element;t[BJUI.keys.statusCode]===BJUI.statusCode.error?t[BJUI.keys.message]&&e.alertmsg("error",t[BJUI.keys.message]):t[BJUI.keys.statusCode]===BJUI.statusCode.timeout?(e.alertmsg("info",t[BJUI.keys.message]||FRAG.sessionTimout),BJUI.loadLogin()):t[BJUI.keys.message]&&e.alertmsg("correct",t[BJUI.keys.message])},c.prototype.ajaxError=function(t,e,a){BJUI.removeProgress();var i=t.responseText.trim();i.startsWith("{")?this.ajaxDone(i.toObj()):this.$element.alertmsg("error","<div>Http status: "+t.status+" "+t.statusText+"</div><div>ajaxOptions: "+e+" </div><div>thrownError: "+a+" </div><div>"+i+"</div>")},c.prototype.ajaxCallback=function(t){var e=this,a=e.$element.closest(".bjui-layout");e.ajaxDone(t),t[BJUI.keys.statusCode]===BJUI.statusCode.ok&&(a&&a.length?e.divCallback(t,a):e.tools.getTarget()===c.NAVTAB?e.navtabCallback(t):e.dialogCallback(t))},c.prototype.divCallback=function(t,e){var a,i,n,o,s=this;t.tabid&&setTimeout(function(){s.$element.navtab("reloadFlag",t.tabid)},100),t.dialogid&&setTimeout(function(){s.$element.dialog("refresh",t.dialogid)},100),t.divid&&setTimeout(function(){s.$element.bjuiajax("refreshDiv",t.divid)},100),s.options.reload&&(n=i=null,n=(a=s.tools.getPagerForm(e))?(i=a.attr("action"),a.attr("method")||"GET"):(i=e.data("url"),e.data("type")||"GET"),i&&e.ajaxUrl({url:i,type:n})),s.options.reloadNavtab&&setTimeout(function(){s.$element.navtab("refresh")},100),t.forward&&(o=function(){e.ajaxUrl({url:t.forward})},t.forwardConfirm?s.$element.alertmsg("confirm",t.forwardConfirm,{okCall:function(){o()}}):o())},c.prototype.navtabCallback=function(t){var e,a=this;t.closeCurrent&&!t.forward&&a.$element.navtab("closeCurrentTab"),!1!==t.tabid&&(""===d.trim(t.tabid)&&t.statusCode===BJUI.statusCode.ok?setTimeout(function(){a.$element.navtab("refresh")},100):t.tabid?setTimeout(function(){a.$element.navtab("reloadFlag",t.tabid)},100):a.options.reload&&setTimeout(function(){a.$element.navtab("refresh")},100)),t.dialogid&&setTimeout(function(){a.$element.dialog("refresh",t.dialogid)},100),t.divid&&setTimeout(function(){a.$element.bjuiajax("refreshDiv",t.divid)},100),t.datagrid&&setTimeout(function(){d.each(t.datagrid.join(","),function(t,e){d("#"+e.trim()).datagrid("refresh")})},100),t.forward&&(e=function(){a.$element.navtab("reload",{url:t.forward})},t.forwardConfirm?a.$element.alertmsg("confirm",t.forwardConfirm,{okCall:function(){e()},cancelCall:function(){t.closeCurrent&&a.$element.navtab("closeCurrentTab")}}):e())},c.prototype.dialogCallback=function(t){var e,a=this;!1!==t.tabid&&(""===d.trim(t.tabid)&&t.statusCode===BJUI.statusCode.ok?setTimeout(function(){a.$element.navtab("refresh")},100):t.tabid&&setTimeout(function(){a.$element.navtab("reloadFlag",t.tabid)},100)),t.dialogid&&setTimeout(function(){a.$element.dialog("refresh",t.dialogid)},100),t.divid&&setTimeout(function(){a.$element.bjuiajax("refreshDiv",t.divid)},100),t.closeCurrent&&!t.forward?a.$element.dialog("closeCurrent"):a.options.reload&&setTimeout(function(){a.$element.dialog("refresh")},100),a.options.reloadNavtab&&setTimeout(function(){a.$element.navtab("refresh")},100),t.forward&&(e=function(){a.$element.dialog("reload",{url:t.forward})},t.forwardConfirm?a.$element.alertmsg("confirm",t.forwardConfirm,{okCall:function(){e()}}):e())},c.prototype.pageCallback=function(t,e){var a=this,i=d.extend({},c.DEFAULTS,t),t=e||null,e=null;t&&t.length?(e=a.tools.getPagerForm(t,i))&&(d.extend(i,d(e).data()),a.reloadDiv(t,{type:d(e).attr("method")||"POST",url:d(e).attr("action"),data:d(e).serializeArray(),loadingmask:i.loadingmask})):a.tools.getTarget()===c.NAVTAB?(t=d.CurrentNavtab,(e=a.tools.getPagerForm(t,i))&&d.extend(i,d(e).data()),a.$element.navtab("reloadForm",!1,i)):(t=d.CurrentDialog,(e=a.tools.getPagerForm(t,i))&&d.extend(i,d(e).data()),a.$element.dialog("reloadForm",!1,i))},c.prototype.doSearch=function(n){var o=this,s=o.$element,l={pageCurrent:1},r=s.closest(".bjui-layout"),t=n.isValid;if((n=d.extend({},c.DEFAULTS,"object"==typeof n&&n)).url||(n.url=s.attr("action")),n.url){if(n.url=decodeURI(n.url).replacePlh(s.closest(".unitBox")),!n.url.isFinishedTm())return s.alertmsg("error",n.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("The submit form action is incorrect: "+n.url);n.url=encodeURI(n.url);var e=function(){if(r&&r.length){o.tools.getPagerForm(r,l);var t=s.serializeJson(),e={};if(n.clearQuery){var a,i=BJUI.pageInfo;for(a in i)i.hasOwnProperty(a)&&(e[i[a]]=t[i[a]]);t=e}o.reloadDiv(r,{type:s.attr("method")||"POST",url:n.url,data:t,loadingmask:n.loadingmask})}else o.tools.getTarget()===c.NAVTAB?(r=d.CurrentNavtab,o.tools.getPagerForm(r,l),s.navtab("reloadForm",n.clearQuery,n)):(r=d.CurrentDialog,o.tools.getPagerForm(r,l),s.dialog("reloadForm",n.clearQuery,n))};!t&&d.validator?s.isValid(function(t){t&&e()}):e()}else BJUI.debug("Error trying to submit form action: action url is undefined!")},c.prototype.doLoad=function(t){var e=this.$element,a=t.target?d(t.target):null;if((t=d.extend({},c.DEFAULTS,"object"==typeof t&&t)).url){if(t.url=decodeURI(t.url).replacePlh(e.closest(".unitBox")),!t.url.isFinishedTm())return e.alertmsg("error",t.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("The ajax link incorrect: "+t.url);t.url=encodeURI(t.url),a&&a.length?a&&a.length&&(a.removeData("bjui.clientPaging"),this.reloadDiv(a,t)):BJUI.debug("Not set loaded 'ajax' content container, like [data-target].")}else BJUI.debug("Error trying to open a ajax link: The url is undefined!")},c.prototype.refreshLayout=function(t){var e=t.target?d(t.target):null;if(t=d.extend({},c.DEFAULTS,"object"==typeof t&&t),!e||!e.length)return n&&clearInterval(n),void BJUI.debug("Not set loaded 'ajax' content container, like [data-target].");e&&e.length&&(e.removeData("bjui.clientPaging"),this.reloadDiv(e,d.extend({},e.data("options")||{},t)))},c.prototype.reloadDiv=function(e,a){var i=a.autorefresh&&(isNaN(String(a.autorefresh))?15:a.autorefresh);e.addClass("bjui-layout").data("options",a).ajaxUrl({type:a.type,url:a.url,data:a.data,loadingmask:a.loadingmask,callback:function(t){BJUI.ui.clientPaging&&e.data("bjui.clientPaging")&&e.pagination("setPagingAndOrderby",e),a.callback&&a.callback.apply(this,[e]),n&&clearInterval(n),i&&(n=setInterval(function(){e.bjuiajax("refreshLayout",a)},1e3*i))}})},c.prototype.refreshDiv=function(t){if(t&&"string"==typeof t)for(var e=t.split(","),a=0;a<e.length;a++)this.refreshLayout({target:"#"+e[a]})},c.prototype.doAjax=function(t){var e=this,a=e.$element;if((t=d.extend({},c.DEFAULTS,"object"==typeof t&&t)).url){if(t.url=decodeURI(t.url).replacePlh(a.closest(".unitBox")),!t.url.isFinishedTm())return a.alertmsg("error",t.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("The ajax url is incorrect: "+t.url);t.url=encodeURI(t.url),t.data&&(t.data="object"==typeof t.data?t.data:t.data.toObj());var i=t.callback&&t.callback.toFunc(),n=function(){a.doAjax({type:t.type,url:t.url,data:t.data,callback:i||d.proxy(function(t){e.ajaxCallback(t)},e)})};t.confirmMsg?a.alertmsg("confirm",t.confirmMsg,{okCall:function(){n()}}):n()}else BJUI.debug("Error trying to open a ajax link: url is undefined!")},c.prototype.doExport=function(t){var e,a=this,i=a.$element,n=t.target?d(t.target):null;if(t.url){if(t.url=decodeURI(t.url).replacePlh(i.closest(".unitBox")),!t.url.isFinishedTm())return i.alertmsg("error",t.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("The ajax url is incorrect: "+t.url);var o=function(){n&&n.length||(n=a.tools.getTarget()===c.NAVTAB?d.CurrentNavtab:d.CurrentDialog),t.data?t.data="object"==typeof t.data?t.data:t.data.toObj():t.data={},(e=a.tools.getPagerForm(n))&&(t.data=d.extend(t.data,d(e).serializeJson())),d.fileDownload(t.url,{httpMethod:t.type,data:t.data,cookiePath:"/",failCallback:function(t,e){t.trim().startsWith("{")&&(t=t.toObj()),a.ajaxDone(t)}})};t.confirmMsg?i.alertmsg("confirm",t.confirmMsg,{okCall:function(){o()}}):o()}else BJUI.debug("Error trying to open a ajax link: url is undefined!")},c.prototype.doExportChecked=function(a){var i=this,t=i.$element,n=a.target?d(a.target):null;if(a.url){if(a.url=decodeURI(a.url).replacePlh(t.closest(".unitBox")),!a.url.isFinishedTm())return t.alertmsg("error",a.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("The ajax url is incorrect: "+a.url);var e=function(){var t,e;a.group?(n&&n.length||(n=i.tools.getTarget()===c.NAVTAB?d.CurrentNavtab:d.CurrentDialog),t=[],0!==(e=n.find(":checkbox[name="+a.group+"]:checked")).length?(e.each(function(){t.push(d(this).val())}),a.data?a.data="object"==typeof a.data?a.data:a.data.toObj():a.data={},a.data[a.idname||"ids"]=t.join(","),d.fileDownload(a.url,{httpMethod:a.type,data:a.data,cookiePath:"/",failCallback:function(t,e){t.trim().startsWith("{")&&(t=t.toObj()),i.ajaxDone(t)}})):i.$element.alertmsg("error",FRAG.alertNotChecked.replace("#notchecked#",BJUI.regional.notchecked))):i.$element.alertmsg("error",a.warn||FRAG.alertNoCheckGroup.replace("#nocheckgroup#",BJUI.regional.nocheckgroup))};a.confirmMsg?t.alertmsg("confirm",a.confirmMsg,{okCall:function(){e()}}):e()}else BJUI.debug("Error trying to open a export link: url is undefined!")},c.prototype.doAjaxChecked=function(i){var n=this,o=n.$element,s=i.target?d(i.target):null;if((i=d.extend({},c.DEFAULTS,"object"==typeof i&&i)).url){if(i.url=decodeURI(i.url).replacePlh(o.closest(".unitBox")),!i.url.isFinishedTm())return o.alertmsg("error",i.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("The ajax url is incorrect: "+i.url);var t=function(){var t,e,a;i.group?(s&&s.length||(s=n.tools.getTarget()===c.NAVTAB?d.CurrentNavtab:d.CurrentDialog),t=[],e=s.find(":checkbox[name="+i.group+"]:checked"),a=i.callback&&i.callback.toFunc(),0!==e.length?(e.each(function(){t.push(d(this).val())}),i.data?i.data="object"==typeof i.data?i.data:i.data.toObj():i.data={},i.data[i.idname||"ids"]=t.join(","),o.doAjax({type:i.type,url:i.url,data:i.data,callback:a||d.proxy(function(t){n.ajaxCallback(t)},n)})):o.alertmsg("error",FRAG.alertNotChecked.replace("#notchecked#",BJUI.regional.notchecked))):o.alertmsg("error",i.warn||FRAG.alertNoCheckGroup.replace("#nocheckgroup#",BJUI.regional.nocheckgroup))};i.confirmMsg?o.alertmsg("confirm",i.confirmMsg,{okCall:function(){t()}}):t()}else BJUI.debug("Error trying to open a del link: url is undefined!")};var t=d.fn.bjuiajax;d.fn.bjuiajax=o,d.fn.bjuiajax.Constructor=c,d.fn.bjuiajax.noConflict=function(){return d.fn.bjuiajax=t,this},d(document).on("submit.bjui.bjuiajax.data-api",'form[data-toggle="ajaxform"]',function(t){var e=d(this),a=e.data();o.call(e,"ajaxForm",a),t.preventDefault()}),d(function(){d.validator?d(document).on(BJUI.eventType.initUI,function(t){d(t.target).find('form[data-toggle="ajaxsearch"]').each(function(){var e=d(this),a=e.data();a.isValid=!0,e.validator({valid:function(t){o.call(e,"doSearch",a)}})})}):d(document).on("submit.bjui.bjuiajax.data-api",'form[data-toggle="ajaxsearch"]',function(t){var e=d(this),a=e.data();o.call(e,"doSearch",a),t.preventDefault()})}),d(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="reloadsearch"]',function(t){var e,a=d(this),i=a.closest("form");i&&i.length&&((e=i.data()).clearQuery=a.data("clearQuery")||!0,o.call(i,"doSearch",e),t.preventDefault())}),d(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="ajaxload"]',function(t){var e=d(this),a=e.data();a.url||(a.url=e.attr("href")),o.call(e,"doLoad",a),t.preventDefault()}),d(document).on(BJUI.eventType.initUI,function(t){d(t.target).find('[data-toggle="autoajaxload"]').each(function(){var t=d(this),e=t.data();e.target=this,o.call(t,"doLoad",e)})}),d(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="refreshlayout"]',function(t){var e=d(this),a=e.data();o.call(e,"refreshLayout",a)}),d(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="doajax"]',function(t){var e=d(this),a=e.data();a.url||(a.url=e.attr("href")),o.call(e,"doAjax",a),t.preventDefault()}),d(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="doexport"]',function(t){var e=d(this),a=e.data();a.url||(a.url=e.attr("href")),o.call(e,"doExport",a),t.preventDefault()}),d(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="doexportchecked"]',function(t){var e=d(this),a=e.data();a.url||(a.url=e.attr("href")),o.call(e,"doExportChecked",a),t.preventDefault()}),d(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="doajaxchecked"]',function(t){var e=d(this),a=e.data();a.url||(a.url=e.attr("href")),o.call(e,"doAjaxChecked",a),t.preventDefault()})}(jQuery),function(p){"use strict";var f,g,m;function n(t,e){this.$element=p(t),this.options=e,this.tools=this.TOOLS(),this.clearTime=null}function o(e){var a=arguments,i=e;return this.each(function(){var t=p(this),t=p.extend({},n.DEFAULTS,t.data(),"object"==typeof e&&e),t=new n(this,t);"string"==typeof i&&p.isFunction(t[i])&&([].shift.apply(a),a?t[i].apply(t,a):t[i]())})}p(function(){f=p(FRAG.alertBoxFrag).hide().html(""),g=p(FRAG.alertBackground).hide().html(""),p("body").append("\x3c!-- alert msg box --\x3e").append(f).append("\x3c!-- alert msg box mask bg --\x3e").append(g)}),n.DEFAULTS={displayPosition:"topcenter",displayMode:"slide",autoClose:null,alertTimeout:3e3,mask:null,types:{error:"error",info:"info",warn:"warn",correct:"correct",confirm:"confirm"},fas:{error:"fa-times-circle",info:"fa-info-circle",warn:"fa-exclamation-circle",correct:"fa-check-circle",confirm:"fa-question-circle"}},n.prototype.TOOLS=function(){var u=this,h=u.options;return{getTitle:function(t){return h.title||BJUI.regional.alertmsg.title[t]},keydownOk:function(t){return t.which!==BJUI.keyCode.ENTER||(t.data.target.trigger("click"),!1)},keydownEsc:function(t){t.which===BJUI.keyCode.ESC&&t.data.target.trigger("click")},openPosition:function(){var t=BJUI.alertMsg.displayPosition,e=BJUI.alertMsg.displayMode,a=f.outerHeight(),i={},n={};switch((!t||h.displayPosition&&"topcenter"!==h.displayPosition)&&(t=h.displayPosition),(!e||h.displayMode&&"silde"!==h.displayMode)&&(e=h.displayMode),t){case"topleft":i={top:0-a,left:0,"margin-left":0},n={top:0};break;case"topcenter":i={top:0-a},n={top:0};break;case"topright":i={top:0-a,left:"auto",right:0,"margin-left":0},n={top:0};break;case"middleleft":i={top:"50%",left:-460,"margin-left":0,"margin-top":0-a/2},n={left:0};break;case"middlecenter":i={top:"0","margin-top":0-a/2},n={top:"50%"};break;case"middleright":i={top:"50%",left:"auto",right:-460,"margin-top":0-a/2},n={right:0};break;case"bottomleft":i={top:"auto",left:0,bottom:0-a,"margin-left":0},n={bottom:0};break;case"bottomcenter":i={top:"auto",bottom:0-a},n={bottom:0};break;case"bottomright":i={top:"auto",left:"auto",right:0,bottom:0-a,"margin-left":0},n={bottom:0}}"slide"===e?f.css(i).show().animate(n,500):"fade"===e?(i.opacity=.1,f.css(i).css(n).show().animate({opacity:1},500)):f.css(i).css(n).show()},closePosition:function(){var t=BJUI.alertMsg.displayPosition,e=BJUI.alertMsg.displayMode,a=f.outerHeight(),i={};switch((!t||h.displayPosition&&"topcenter"!==h.displayPosition)&&(t=h.displayPosition),(!e||h.displayMode&&"silde"!==h.displayMode)&&(e=h.displayMode),t){case"topleft":case"topcenter":case"topright":i={top:0-a};break;case"middleleft":i={left:-460};break;case"middlecenter":i={top:0-a};break;case"middleright":i={right:-460};break;case"bottomleft":case"bottomcenter":case"bottomright":i={bottom:0-a}}"slide"===e?f.animate(i,500,function(){g.hide(),p(this).hide().empty()}):"fade"===e?f.animate({opacity:0},500,function(){g.hide(),p(this).hide().empty()}):(f.hide().remove(),g.hide())},open:function(t,e,a){var i,n=this,o="",s=BJUI.alertMsg.alertTimeout;if(a)for(var l=0;l<a.length;l++){var r=a[l].call?"callback":"",d=a[l].cls||"default",c=a[l].cls&&"green"===a[l].cls?"check":"close";o+=FRAG.alertBtnFrag.replace("#btnMsg#",'<i class="fa fa-'+c+'"></i> '+a[l].name).replace("#callback#",r).replace("#class#",d)}e=p(FRAG.alertBoxFrag.replace("#type#",t).replace("#fa#",h.fas[t]).replace("#title#",this.getTitle(t)).replace("#message#",e).replace("#btnFragment#",o)).hide().appendTo("body"),f&&f.length&&f.remove(),f=e,n.openPosition(),m&&(clearTimeout(m),m=null),null==h.mask&&h.types.info!==t&&h.types.correct!==t&&g.show(),null==h.autoClose&&(h.types.info!==t&&h.types.correct!==t||((!s||h.alertTimeout&&3e3!==h.alertTimeout)&&(s=h.alertTimeout),m=setTimeout(function(){n.close()},s))),(i=f.find(".btn")).each(function(e){p(this).on("click",p.proxy(function(){u.tools.close();var t=a[e].call;"string"==typeof t&&(t=t.toFunc()),"function"==typeof t&&t.call()},u)),a[e].keyCode===BJUI.keyCode.ENTER&&p(document).on("keydown.bjui.alertmsg.ok",{target:i.eq(e)},n.keydownOk),a[e].keyCode===BJUI.keyCode.ESC&&p(document).on("keydown.bjui.alertmsg.esc",{target:i.eq(e)},n.keydownEsc)})},alert:function(t,e,a){p.extend(h,"object"==typeof a&&a);a=p.extend({},{okName:BJUI.regional.alertmsg.btnMsg.ok,okCall:null},h),a=[{name:a.okName,call:a.okCall,cls:"default",keyCode:BJUI.keyCode.ENTER}];this.open(t,e,a)},close:function(){p(document).off("keydown.bjui.alertmsg.ok").off("keydown.bjui.alertmsg.esc"),this.closePosition()}}},n.prototype.error=function(t,e){this.tools.alert(this.options.types.error,t,e)},n.prototype.info=function(t,e){this.tools.alert(this.options.types.info,t,e)},n.prototype.warn=function(t,e){this.tools.alert(this.options.types.warn,t,e)},n.prototype.ok=function(t,e){this.tools.alert(this.options.types.correct,t,e)},n.prototype.correct=function(t,e){this.tools.alert(this.options.types.correct,t,e)},n.prototype.confirm=function(t,e){p.extend(this.options,"object"==typeof e&&e);e=p.extend({},{okName:BJUI.regional.alertmsg.btnMsg.ok,okCall:null,cancelName:BJUI.regional.alertmsg.btnMsg.cancel,cancelCall:null},this.options),e=[{name:e.okName,call:e.okCall,cls:"green",keyCode:BJUI.keyCode.ENTER},{name:e.cancelName,call:e.cancelCall,cls:"red",keyCode:BJUI.keyCode.ESC}];this.tools.open(this.options.types.confirm,t,e)};var t=p.fn.alertmsg;p.fn.alertmsg=o,p.fn.alertmsg.Constructor=n,p.fn.alertmsg.noConflict=function(){return p.fn.alertmsg=t,this},p(document).on("click.bjui.alertmsg.data-api",'[data-toggle="alertmsg"]',function(t){var e=p(this),a=e.data(),i=a.options;if(i&&("string"==typeof i&&(i=i.toObj()),"object"==typeof i&&p.extend(a,i)),!(i=a.type))return!1;o.call(e,i,a.msg||i,a),t.preventDefault()})}(jQuery),function(u){"use strict";function s(t,e){this.$element=u(t),this.options=e,this.tools=this.TOOLS()}function a(i){var n=arguments,o=i;return this.each(function(){var t=u(this),e=u.extend({},s.DEFAULTS,t.data(),"object"==typeof i&&i),a=t.data("bjui.pagination");a||t.data("bjui.pagination",a=new s(this,e)),"string"==typeof o&&u.isFunction(a[o])?([].shift.apply(n),n?a[o].apply(a,n):a[o]()):a.init()})}s.DEFAULTS={first:"li.j-first",prev:"li.j-prev",next:"li.j-next",last:"li.j-last",nums:"li.j-num > a",jump:"li.jumpto",pageNumFrag:'<li class="#liClass#"><a href="javascript:;">#pageNum#</a></li>',total:0,pageSize:10,pageNum:10,pageCurrent:1,callback:function(){return!1}},s.prototype.TOOLS=function(){var i=this.options;return{pageNums:function(){return Math.ceil(i.total/i.pageSize)},getInterval:function(){var t=Math.ceil(i.pageNum/2),e=this.pageNums(),a=e-i.pageNum;return{start:(this.getCurrentPage()>t?Math.max(Math.min(this.getCurrentPage()-t,a),0):0)+1,end:(this.getCurrentPage()>t?Math.min(this.getCurrentPage()+t,e):Math.min(i.pageNum,e))+1}},getCurrentPage:function(){var t=parseInt(i.pageCurrent);return isNaN(t)?1:t},hasPrev:function(){return 1<this.getCurrentPage()},hasNext:function(){return this.getCurrentPage()<this.pageNums()}}},s.prototype.init=function(){BJUI.ui.clientPaging&&!this.getClientPaging()&&this.setClientPaging({pageCurrent:this.options.pageCurrent,pageSize:this.options.pageSize});for(var i=this,n=this.options,t=this.tools,e=t.getInterval(),a="",o=FRAG.pagination,s=BJUI.regional.pagination,l=e.start;l<e.end;l++)a+=n.pageNumFrag.replaceAll("#pageNum#",l).replaceAll("#liClass#",l===t.getCurrentPage()?"selected j-num":"j-num");o=o.replaceAll("#pageNumFrag#",a).replaceAll("#pageCurrent#",t.getCurrentPage()).replaceAll("#first#",s.first).replaceAll("#last#",s.last).replaceAll("#prev#",s.prev).replaceAll("#next#",s.next).replaceAll("#jumpto#",s.jumpto).replaceAll("#jump#",s.jump),this.$element.html(o);var r=this.$element.find(n.first),d=this.$element.find(n.prev),s=this.$element.find(n.next),o=this.$element.find(n.last);function c(t,a){t.on("click",function(t){var e={pageCurrent:a,pageSize:i.options.pageSize};i.setClientPaging(e),u(this).bjuiajax("pageCallback",e,i.$element.closest(".bjui-layout")),t.preventDefault()})}t.hasPrev()?(r.add(d).find("> span").hide(),c(d,t.getCurrentPage()-1),c(r,1)):r.add(d).addClass("disabled").find("> a").hide(),t.hasNext()?(s.add(o).find("> span").hide(),c(s,t.getCurrentPage()+1),c(o,t.pageNums())):s.add(o).addClass("disabled").find("> a").hide(),this.$element.find(n.nums).each(function(t){c(u(this),t+e.start)}),this.$element.find(n.jump).each(function(){var a=u(this).find(":text"),e=u(this).find(".goto");e.on("click",function(){var t=a.val(),e={pageCurrent:t,pageSize:n.pageSize};t&&t.isPositiveInteger()&&(i.setClientPaging(e),u(this).bjuiajax("pageCallback",e,i.$element.closest(".bjui-layout")))}),a.keyup(function(t){t.keyCode===BJUI.keyCode.ENTER&&e.trigger("click")})})},s.prototype.changePagesize=function(){var t=this.$element.val(),e={pageSize:t};isNaN(t)||(this.setClientPaging(e),this.$element.bjuiajax("pageCallback",e,this.$element.closest(".bjui-layout")))},s.prototype.orderBy=function(t){var e=this;e.$element.css({cursor:"pointer"}).click(function(){var t={orderField:u(this).data("orderField"),orderDirection:u(this).data("orderDirection")};e.setClientPaging(t),u(this).bjuiajax("pageCallback",t,e.$element.closest(".bjui-layout"))})},s.prototype.destroy=function(){this.$element.removeData("bjui.pagination").empty()},s.prototype.getTarget=function(){var t=this.$element.closest(".bjui-layout").length?this.$element.closest(".bjui-layout"):this.$element.closest(".navtab-panel").length?u.CurrentNavtab:u.CurrentDialog;return t},s.prototype.getClientPaging=function(){return this.getTarget().data("bjui.clientPaging")},s.prototype.setClientPaging=function(t){var e;BJUI.ui.clientPaging&&(e=this.getTarget()).data("bjui.clientPaging",u.extend({},e.data("bjui.clientPaging")||{},t))},s.prototype.setClientOrder=function(t){var e;BJUI.ui.clientPaging&&((e=this.getClientPaging())&&e.orderField||this.setClientPaging(t))},s.prototype.setPagingAndOrderby=function(t){var e=t.data("bjui.clientPaging");t.find('[data-toggle="pagination"]').pagination("destroy").pagination(e),e.pageSize&&t.find('select[data-toggle-change="changepagesize"]').selectpicker("val",e.pageSize),e.orderField&&t.find('th[data-order-field="'+e.orderField+'"]').addClass(e.orderDirection).siblings().removeClass("asc desc")};var t=u.fn.pagination;u.fn.pagination=a,u.fn.pagination.Constructor=s,u.fn.pagination.noConflict=function(){return u.fn.pagination=t,this},u(document).on(BJUI.eventType.initUI,function(t){t=u(t.target).find('[data-toggle="pagination"]');t.length&&a.call(t)}),u(document).on("change.bjui.pagination.data-api",'select[data-toggle-change="changepagesize"]',function(t){var e=u(this);a.call(e,"changePagesize"),t.preventDefault()})}(jQuery),function($){"use strict";var MONTH_NAMES=["January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],DAY_NAMES=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function LZ(t){return(t<0||9<t?"":"0")+t}function formatDate(t,e){e+="";var a,i="",n=0,o="",s=t.getYear()+"",l=t.getMonth()+1,r=t.getDate(),d=t.getDay(),c=t.getHours(),u=t.getMinutes(),t=t.getSeconds(),h={};for(s.length<4&&(s=""+(+s+1900)),h.y=""+s,h.yyyy=s,h.yy=s.substring(2,4),h.M=l,h.MM=LZ(l),h.MMM=MONTH_NAMES[l-1],h.NNN=MONTH_NAMES[l+11],h.d=r,h.dd=LZ(r),h.E=DAY_NAMES[d+7],h.EE=DAY_NAMES[d],h.H=c,h.HH=LZ(c),h.h=0===c?12:12<c?c-12:c,h.hh=LZ(h.h),h.K=11<c?c-12:c,h.k=c+1,h.KK=LZ(h.K),h.kk=LZ(h.k),h.a=11<c?"PM":"AM",h.m=u,h.mm=LZ(u),h.s=t,h.ss=LZ(t);n<e.length;){for(a=e.charAt(n),o="";e.charAt(n)===a&&n<e.length;)o+=e.charAt(n++);null!=h[o]?i+=h[o]:i+=o}return i}function _isInteger(t){return new RegExp(/^\d+$/).test(t)}function _getInt(t,e,a,i){for(var n=i;a<=n;n--){var o=t.substring(e,e+n);if(o.length<a)return null;if(_isInteger(o))return o}return null}function parseDate(t,e){var a;t+="",e+="";for(var i,n,o,s=0,l=0,r="",d=new Date(1900,0,1),c=d.getYear(),u=d.getMonth()+1,h=1,p=d.getHours(),f=d.getMinutes(),g=d.getSeconds(),m="";l<e.length;){for(i=e.charAt(l),r="";e.charAt(l)===i&&l<e.length;)r+=e.charAt(l++);if("yyyy"===r||"yy"===r||"y"===r){if("yyyy"===r&&(o=n=4),"yy"===r&&(o=n=2),"y"===r&&(n=2,o=4),null===(c=_getInt(t,s,n,o)))return 0;s+=c.length,2===c.length&&(c=70<c?+c+1900:+c+2e3)}else if("MMM"===r||"NNN"===r){for(a=u=0;a<MONTH_NAMES.length;a++){var b=MONTH_NAMES[a];if(t.substring(s,s+b.length).toLowerCase()===b.toLowerCase()&&("MMM"===r||"NNN"===r&&11<a)){12<(u=a+1)&&(u-=12),s+=b.length;break}}if(u<1||12<u)return 0}else if("EE"===r||"E"===r)for(a=0;a<DAY_NAMES.length;a++){var v=DAY_NAMES[a];if(t.substring(s,s+v.length).toLowerCase()===v.toLowerCase()){s+=v.length;break}}else if("MM"===r||"M"===r){if(null===(u=_getInt(t,s,r.length,2))||u<1||12<u)return 0;s+=u.length}else if("dd"===r||"d"===r){if(null===(h=_getInt(t,s,r.length,2))||h<1||31<h)return 0;s+=h.length}else if("hh"===r||"h"===r){if(null===(p=_getInt(t,s,r.length,2))||p<1||12<p)return 0;s+=p.length}else if("HH"===r||"H"===r){if(null===(p=_getInt(t,s,r.length,2))||p<0||23<p)return 0;s+=p.length}else if("KK"===r||"K"===r){if(null===(p=_getInt(t,s,r.length,2))||p<0||11<p)return 0;s+=p.length}else if("kk"===r||"k"===r){if(null===(p=_getInt(t,s,r.length,2))||p<1||24<p)return 0;s+=p.length,p--}else if("mm"===r||"m"===r){if(null===(f=_getInt(t,s,r.length,2))||f<0||59<f)return 0;s+=f.length}else if("ss"===r||"s"===r){if(null===(g=_getInt(t,s,r.length,2))||g<0||59<g)return 0;s+=g.length}else if("a"===r){if("am"===t.substring(s,s+2).toLowerCase())m="AM";else{if("pm"!==t.substring(s,s+2).toLowerCase())return 0;m="PM"}s+=2}else{if(t.substring(s,s+r.length)!==r)return 0;s+=r.length}}if(s!==t.length)return 0;if(2===u)if(c%4==0&&c%100!=0||c%400==0){if(29<h)return 0}else if(28<h)return 0;return(4===u||6===u||9===u||11===u)&&30<h?0:(p<12&&"PM"===m?p+=12:11<p&&"AM"===m&&(p-=12),new Date(c,u-1,h,p,f,g))}function replaceTmEval(data){return data.replace(RegExp("({[A-Za-z0-9_+-]*})","g"),function($1){return eval("("+$1.replace(/[{}]+/g,"")+")")})}Date.prototype.formatDate=function(t){return formatDate(this,t)},String.prototype.parseDate=function(t){return this.length<t.length&&(t=t.slice(0,this.length)),parseDate(this,t)},Date.prototype.formatDateTm=function(t){var e=this.getFullYear(),a=this.getMonth()+1,i=this.getDate(),n=1900,o=0,s=1,i=replaceTmEval(t.replaceAll("%y",e).replaceAll("%M",a).replaceAll("%d",i)).split("-");return 0<i.length&&(n=i[0]),1<i.length&&(o=i[1]-1),2<i.length&&(s=i[2]),new Date(n,o,s).formatDate("yyyy-MM-dd")},Date.parseTime=function(t,e){e=e||"{y}-{m}-{d} {h}:{i}:{s}";var a={y:(t="object"==typeof(t=t||new Date)?t:(10===(""+t).length&&(t=1e3*parseInt(t)),new Date(t))).getFullYear(),m:t.getMonth()+1,d:t.getDate(),h:t.getHours(),i:t.getMinutes(),s:t.getSeconds(),a:t.getDay()};return e.replace(/{([ymdhis])+}/g,function(t,e){e=a[e];return 0<t.length&&e<10&&(e="0"+e),e||0})},Date.prototype.startTime=function(){return this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this},Date.prototype.endTime=function(){return this.setHours(23),this.setMinutes(59),this.setSeconds(59),this.setMilliseconds(999),this},Date.today=function(t){return"start"===(t=t||"start")?(new Date).startTime():(new Date).endTime()}}(jQuery),function(g){"use strict";var m,b,r,d,c,u,v,y,k,x,C,w,$,h,j,e,p,f;function l(t,e){this.$element=g(t),this.options=e,this.tools=this.TOOLS(),this.$dateBtn=null,e=new Date,this.options.minDate=e.formatDateTm(this.options.minDate),this.options.maxDate=e.formatDateTm(this.options.maxDate),this.events={focus_time:"focus.bjui.datepicker.time",click_prev:"click.bjui.datepicker.prev",click_next:"click.bjui.datepicker.next",click_ok:"click.bjui.datepicker.ok",click_days:"click.bjui.datepicker.days",click_clear:"click.bjui.datepicker.clear",click_close:"click.bjui.datepicker.close",click_tm:"click.bjui.datepicker.tm",click_spinner:"click.bjui.datepicker.spinner",mousedown_sp:"mousedown.bjui.datepicker.spinner",mouseup_sp:"mouseup.bjui.datepicker.spinner",change_ym:"change.bjui.datepicker.ym",click_time:"click.bjui.datepicker.time",keydown_time:"keydown.bjui.datepicker.time",keyup_time:"keyup.bjui.datepicker.time"}}function a(i){var n=arguments,o=i;return this.each(function(){var t=g(this),e=g.extend({},l.DEFAULTS,t.data(),"object"==typeof i&&i),a=t.data("bjui.datepicker");a||t.data("bjui.datepicker",a=new l(this,e)),"string"==typeof o&&g.isFunction(a[o])?([].shift.apply(n),n?a[o].apply(a,n):a[o]()):a.init()})}g(function(){!function(){var t=BJUI.regional.datepicker,t=FRAG.calendarFrag.replace("#close#",t.close).replace("#prev#",t.prev).replace("#next#",t.next).replace("#clear#",t.clear).replace("#ok#",t.ok);m=g(t).hide(),g("body").append("\x3c!-- datepicker --\x3e").append(m),b=m.find("> .main"),r=m.find("a.prev"),d=m.find("a.next"),c=m.find("select[name=year]"),u=m.find("select[name=month]"),v=m.find(".time"),y=v.find(":text"),k=v.find("ul > li"),x=v.find(".hh"),C=v.find(".mm"),w=v.find(".ss"),$=b.find("> .tm"),h=m.find(".close"),j=b.find("> .body > .days"),e=b.find("> .body > .dayNames"),p=m.find(".clearBtn"),f=m.find(".okBtn");var a="",t=BJUI.regional.datepicker;g.each(t.dayNames,function(t,e){a+="<dt>"+e+"</dt>"}),e.html(a),g.each(t.monthNames,function(t,e){t+=1;u.append('<option value="'+t+'">'+e+"</option>")}),m.on("selectstart",function(){return!1})}()}),l.DEFAULTS={pattern:"yyyy-MM-dd",minDate:"1900-01-01",maxDate:"2099-12-31",mmStep:1,ssStep:1},l.EVENTS={afterChange:"afterchange.bjui.datepicker"},l.prototype.TOOLS=function(){var s=this,e={changeTmMenu:function(t){$.removeClass("hh").removeClass("mm").removeClass("ss"),t&&($.addClass(t),y.removeClass("slt").filter("."+t).addClass("slt"))},clickTmMenu:function(e,t){$.find("> ul").hide().filter("."+t).show().find("> li").off(s.events.click_tm).on(s.events.click_tm,function(){var t=g(this),t=parseInt(t.text())<10?"0"+t.text():t.text();e.val(t)})},keydownInt:function(t){if(!(48<=t.keyCode&&t.keyCode<=57||t.keyCode===BJUI.keyCode.DELETE||t.keyCode===BJUI.keyCode.BACKSPACE))return!1},changeTm:function(t,e){var a=parseInt(t.val()),i=parseInt(t.data("start"))||0,n=parseInt(t.data("end")),o=parseInt(t.data("step")||1),s=e?e.data("add")?e.data("add"):-1:0,e=a;1===s?a<=n-o&&(e=a+o):-1===s?i+o<=a&&(e=a-o):n<a?e=n:a<i&&(e=i),e<10&&(e="0"+e),t.val(e)},closeCalendar:function(t){e.changeTmMenu(),t&&(g(document).off(s.events.click_close),m.hide())},get:function(t){return s.options[t]},getDays:function(t,e){return 2===e?t%4||!(t%100)&&t%400?28:29:/4|6|9|11/.test(e)?30:31},minMaxDate:function(t){var e=t.split("-").length-1,a="y-M-d";return 1==e?a="y-M":0==e&&(a="y"),t.parseDate(a)},getMinDate:function(){return this.minMaxDate(s.options.minDate)},getMaxDate:function(){var t=s.options.maxDate,e=t.split("-").length-1,a=this.minMaxDate(t);return e<2&&(t=this.getDays(a.getFullYear(),a.getMonth()+1),a.setDate(t),0==e&&a.setMonth(11)),a},getDateWrap:function(t){var e=(t=t||(this.parseDate(s.sDate)||new Date)).getFullYear(),a=t.getMonth()+1,i=this.getDays(e,a);return{year:e,month:a,day:t.getDate(),hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds(),days:i,date:t}},changeDate:function(t,e,a){a=new Date(t,e-1,a||1);return s.sDate=this.formatDate(a),a},changeDateTime:function(t,e,a,i,n,o){o=new Date(t,e-1,a,i,n,o);return s.sDate=this.formatDate(o),o},changeDay:function(t,e){e=e||0;var a=this.getDateWrap();return this.changeDate(a.year,a.month+parseInt(e),t)},changeMonth:function(t){var e=c.get(0).selectedIndex,a=c.find("option").length,t=+u.val()+t;0===t?0===e?t=1:(t=12,e--,c.get(0).selectedIndex=e):13===t&&(e===a-1?t=12:(t=1,e++,c.get(0).selectedIndex=e)),u.val(t).change()},parseDate:function(t){return t?t.parseDate(s.options.pattern):null},formatDate:function(t){return t.formatDate(s.options.pattern)},hasHour:function(){return-1!==s.options.pattern.indexOf("H")},hasMinute:function(){return-1!==s.options.pattern.indexOf("m")},hasSecond:function(){return-1!==s.options.pattern.indexOf("s")},hasTime:function(){return this.hasHour()||this.hasMinute()||this.hasSecond()},hasDate:function(){for(var t=["y","M","d","E"],e=0;e<t.length;e++)if(-1!==s.options.pattern.indexOf(t[e]))return!0;return!1},afterChange:function(t){s.$element.trigger(l.EVENTS.afterChange,{value:t})}};return e},l.prototype.addBtn=function(){var t,e=this.$element;this.$dateBtn||this.options.addbtn||e.parent().hasClass("wrap_bjui_btn_box")||(this.$dateBtn=g(FRAG.dateBtn),this.$element.css({paddingRight:"15px"}).wrap('<span class="wrap_bjui_btn_box"></span>'),t=this.$element.parent(),e=this.$element.addClass("form-control").innerHeight(),t.css({position:"relative",display:"inline-block"}),this.$dateBtn.css({height:e,lineHeight:e+"px"}).appendTo(t),this.$dateBtn.on("selectstart",function(){return!1}))},l.prototype.init=function(){this.$element.val()&&(this.sDate=this.$element.val().trim());var a=this,i=this.tools,e=i.getDateWrap(),n=i.getMinDate(),o=i.getMaxDate(),t=n.getFullYear(),s=o.getFullYear();c.empty();for(var l=t;l<=s;l++)c.append('<option value="'+l+'"'+(e.year===l?" selected":"")+">"+l+"</option>");u.val(e.month),c.add(u).off(this.events.change_ym).on(this.events.change_ym,function(){var t=i.hasTime()?(t=j.find(".slt"),i.changeDateTime(c.val(),u.val(),t.data("day"),e.hour,e.minute,e.second)):(t=j.find(".slt"),i.changeDate(c.val(),u.val(),t.data("day")));a.create(i.getDateWrap(t),n,o)}),r.off(this.events.click_prev).on(this.events.click_prev,function(){a.tools.changeMonth(-1)}),d.off(this.events.click_prev).on(this.events.click_prev,function(){a.tools.changeMonth(1)}),p.off(this.events.click_clear).on(this.events.click_clear,function(){a.$element.val(""),i.closeCalendar(!0)}),f.off(this.events.click_ok).on(this.events.click_ok,function(){var t=j.find("dd.slt");if(t.hasClass("disabled"))return!1;t=i.changeDay(t.data("day"),t.data("month"));i.hasTime()&&(t.setHours(parseInt(x.val())),t.setMinutes(parseInt(C.val())),t.setSeconds(parseInt(w.val()))),i.closeCalendar(!0),a.$element.val(i.formatDate(t)).focus(),i.afterChange(t)}),h.off(this.events.click_close).on(this.events.click_close,function(){i.closeCalendar(!0)}),g(document).on(this.events.click_close,function(t){var e=g(t.target);t.target!==a.$element.get(0)&&(e.closest("#calendar").length||("datepicker"===e.data("toggle")||"datepickerbtn"===e.parent().data("toggle")||"datepickerbtn"===e.data("toggle")?i.closeCalendar(!1):i.closeCalendar(!0)))}),this.create(e,n,o)},l.prototype.create=function(t,e,a){var i,n,o=this,s=this.options,l=this.tools,r=new Date(t.year,t.month-1,1),d=r.getDay(),c="";if(0<d){r.setMonth(r.getMonth()-1);for(var u=l.getDateWrap(r),h=u.days-d+1;h<=u.days;h++)c+='<dd class="other'+(n=e<=(i=new Date(t.year,t.month-2,h))&&i<=a?"":" disabled")+'" data-month="-1" data-day="'+h+'">'+h+"</dd>"}for(h=1;h<=t.days;h++)n=e<=(i=new Date(t.year,t.month-1,h))&&i<=a?"":"disabled",h===t.day&&(n+=" slt"),c+='<dd class="'+n+'" data-day="'+h+'">'+h+"</dd>";for(h=1;h<=42-d-t.days;h++)c+='<dd class="other'+(n=e<=(i=new Date(t.year,t.month,h))&&i<=a?"":" disabled")+'" data-month="1" data-day="'+h+'">'+h+"</dd>";var p,f=j.html(c).find("dd");f.not(".disabled").off(this.events.click_days).on(this.events.click_days,function(){var t=g(this);l.hasTime()?(f.removeClass("slt"),t.addClass("slt")):(t=l.changeDay(t.data("day"),t.data("month")),l.closeCalendar(!0),o.$element.val(l.formatDate(t)).focus(),l.afterChange(t))}),l.hasDate()?b.removeClass("nodate"):b.addClass("nodate"),l.hasTime()?(v.show(),x.val(t.hour<10?"0"+t.hour:t.hour).off(this.events.focus_time).on(this.events.focus_time,function(){l.changeTmMenu("hh")}),r=parseInt(t.minute/s.mmStep)*s.mmStep,C.val(r<10?"0"+r:r).data("step",s.mmStep).off(this.events.focus_time).on(this.events.focus_time,function(){l.changeTmMenu("mm")}),w.val(l.hasSecond()?t.second<10?"0"+t.second:t.second:"00").data("step",s.ssStep).off(this.events.focus_time).on(this.events.focus_time,function(){l.changeTmMenu("ss")}),m.off("click").on("click",function(t){g(t.target).closest(".time").length||($.find("> ul").hide(),l.changeTmMenu())}),y.off(this.events.keydown_time).on(this.events.keydown_time,l.keydownInt).each(function(){var t=g(this);t.off(o.events.keyup_time).on(o.events.keyup_time,function(){l.changeTm(t)})}).off(this.events.click_time).on(this.events.click_time,function(){l.clickTmMenu(g(this),g(this).data("type"))}),p=null,k.off(this.events.click_spinner).on(this.events.click_spinner,function(t){var e=g(this);y.filter(".slt").each(function(){l.changeTm(g(this),e)}),t.preventDefault()}).off(this.events.mousedown_sp).on(this.events.mousedown_sp,function(t){var e=g(this);p=setInterval(function(){y.filter(".slt").each(function(){l.changeTm(g(this),e)})},150)}).off(this.events.mouseup_sp).on(this.events.mouseup_sp,function(t){clearTimeout(p)}),l.hasHour()||x.attr("disabled",!0),l.hasMinute()||C.attr("disabled",!0),l.hasSecond()||w.attr("disabled",!0)):v.hide(),this.show()},l.prototype.show=function(){var t=this.$element.offset(),e=t.top+this.$element.get(0).offsetHeight,a=m.outerHeight(!0);a<e&&e>g(window).height()-a&&(e=t.top-a),m.css({left:t.left,top:e}).show().click(function(t){t.stopPropagation()})};var t=g.fn.datepicker;g.fn.datepicker=a,g.fn.datepicker.Constructor=l,g.fn.datepicker.noConflict=function(){return g.fn.datepicker=t,this},g(document).on(BJUI.eventType.initUI,function(t){t=g(t.target).find('[data-toggle="datepicker"]');t.length&&(t.data("nobtn")||a.call(t,"addBtn"))}),g(document).on("click.bjui.datepicker.data-api",'[data-toggle="datepickerbtn"]',function(t){var e=g(this).prevAll('[data-toggle="datepicker"]');e&&e.is(":text")&&(a.call(e,e.data()),t.preventDefault())}),g(document).on("click.bjui.datepicker.data-api",'[data-toggle="datepicker"]',function(t){var e=g(this);e.data("onlybtn")||e.is(":text")&&(a.call(e,e.data()),t.preventDefault())})}(jQuery),function(s){"use strict";function l(t,e){this.$element=s(t),this.options=e}function i(i){var n=arguments,o=i;return this.each(function(){var t=s(this),e=s.extend({},l.DEFAULTS,t.data(),"object"==typeof i&&i),a=t.data("bjui.ajaxtab");a||t.data("bjui.ajaxtab",a=new l(this,e)),"string"==typeof o&&s.isFunction(a[o])?([].shift.apply(n),n?a[o].apply(a,n):a[o]()):a.init()})}l.DEFAULTS={url:void 0,target:void 0,reload:!1},l.prototype.init=function(){var t=this.options;if(t.url){if(t.url=decodeURI(t.url).replacePlh(this.$element.closest(".unitBox")),!t.url.isFinishedTm())return this.$element.alertmsg("error",t.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("Ajaxtab Plugin: The new ajaxtab's url is incorrect, url: "+t.url);t.url=encodeURI(t.url),t.target?!t.reload&&this.$element.data("bjui.ajaxtab.reload")?this.$element.tab("show"):this.load():BJUI.debug("Ajaxtab Plugin: Attribute 'target' is not defined!")}else BJUI.debug("Ajaxtab Plugin: Error trying to open a tab, url is undefined!")},l.prototype.load=function(){var t=this.$element,e=this.options;s(t).bjuiajax("doLoad",{target:s(e.target),url:e.url,data:{},callback:function(){t.data("bjui.ajaxtab.reload",!0).tab("show")}})};var t=s.fn.ajaxtab;s.fn.ajaxtab=i,s.fn.ajaxtab.Constructor=l,s.fn.ajaxtab.noConflict=function(){return s.fn.ajaxtab=t,this},s(document).on("click.bjui.ajaxtab.data-api",'[data-toggle="ajaxtab"]',function(t){var e=s(this),a=e.data();a.url||(a.url=e.attr("href")),i.call(e,a),t.preventDefault()})}(jQuery),function(C){"use strict";function c(t,e){this.$element=C(t),this.options=e,this.tools=this.TOOLS(),this.datanames={tbody:"bjui.datagrid.tbody.dom",td_html:"bjui.datagrid.td.html",changeData:"bjui.datagrid.tr.changeData"},this.classnames={s_checkbox:"datagrid-checkbox",s_linenumber:"datagrid-linenumber",s_edit:"datagrid-column-edit",s_lock:"datagrid-lock",s_menu:"datagrid-menu-box",s_filter:"datagrid-filter-box",s_showhide:"datagrid-showhide-box",th_cell:"datagrid-cell",th_menu:"datagrid-column-menu",btn_menu:"datagrid-column-menu-btn",th_col:"datagrid-col",th_field:"datagrid-col-field",th_sort:"datagrid-sortable",th_resize:"datagrid-resize-head",th_resizemark:"datagrid-column-resizemark",tr_edit:"datagrid-edit-tr",tr_add:"datagrid-add-tr",tr_selected:"datagrid-selected-tr",td_edit:"datagrid-edit-td",td_changed:"datagrid-changed",td_linenumber:"datagrid-linenumber-td",td_checkbox:"datagrid-checkbox-td",li_asc:"datagrid-li-asc",li_desc:"datagrid-li-desc",li_filter:"datagrid-li-filter",li_showhide:"datagrid-li-showhide",li_lock:"datagrid-li-lock",li_unlock:"datagrid-li-unlock"}}function e(i){var n=arguments,o=i;return this.each(function(){var t=C(this),e=C.extend({},c.DEFAULTS,t.data(),"object"==typeof i&&i),a=t.data("bjui.datagrid");a||t.data("bjui.datagrid",a=new c(this,e)),"string"==typeof o&&C.isFunction(a[o])?([].shift.apply(n),n?a[o].apply(a,n):a[o]()):a.init()})}c.DEFAULTS={gridTitle:"",columns:null,data:null,dataUrl:null,loadType:"POST",dataType:"json",local:"remote",fieldSortable:!0,filterThead:!0,sortAll:!1,filterAll:!1,filterMult:!0,linenumberAll:!1,showLinenumber:!0,showCheckboxcol:!1,showEditbtnscol:!1,showTfoot:!1,showToolbar:!1,toolbarItem:"",toolbarCustom:"",columnResize:!0,columnMenu:!0,columnShowhide:!0,columnFilter:!0,columnLock:!0,paging:!0,pagingAlign:"center",editUrl:null,editCallback:null,editMode:"inline",editDialogOp:null,inlineEditMult:!0,saveAll:!0,addLocation:"first",delUrl:null,delType:"POST",delPK:null,delConfirm:!0,delCallback:null,jsonPrefix:"",contextMenuH:!0,contextMenuB:!1,hScrollbar:!1,fullGrid:!1,importOption:null,exportOption:null,beforeEdit:null,beforeDelete:null,afterSave:null,afterDelete:null},c.renderItem=function(a,t){if(!t||!t.length)return"";var i="";return C.each(t,function(t,e){if(void 0!==e[a])return i=e[a],!1}),i},c.prototype.TOOLS=function(){var v=this,y=v.options,i={getPageCount:function(t,e){return Math.ceil(e/t)},getPageInterval:function(t,e,a){var i=Math.ceil(a/2),n=t-a,n=i<e?Math.max(Math.min(e-i,n),0):0,t=i<e?Math.min(e+i,t):Math.min(a,t);return t-n==a&&(t+=1),t<a&&(t+=1),{start:n+1,end:t}},getRight:function(t){var e=0,a=t.data("index"),t=v.$tbody.find("> tr:first > td:lt("+(a+1)+")");return t&&t.length||(t=v.$colgroupH.find("> col:lt("+(a+1)+")")),t.each(function(){var t=C(this),t=t.is(":hidden")?0:t.outerWidth();e+=t}),e},getRight4Lock:function(t){var e=0,a=v.$lockTbody.find("> tr:first > td:eq("+t+")"),a=a&&a.prevAll().add(a);return a&&a.length||(a=v.$lockColgroupH.filter(":lt("+(t+1)+")")),a.each(function(){var t=C(this),t=t.is(":hidden")?0:t.outerWidth();e+=t}),e},beforeEdit:function(t,e){var a=y.beforeEdit;return!a||("string"==typeof a&&(a=a.toFunc()),"function"!=typeof a)||a.call(v,t,e)},afterSave:function(t,e){var a=y.afterSave;a&&("string"==typeof a&&(a=a.toFunc()),"function"==typeof a&&a.call(v,t,e))},afterDelete:function(){var t=y.afterDelete;t&&("string"==typeof t&&(t=t.toFunc()),"function"==typeof t&&t.call(v))},setColspan:function(t,e){t.colspan&&(t.colspan=t.colspan+e-1),t.index=t.index+e-1,t.parent&&this.setColspan(t.parent,e)},columns2Arr:function(t,n,o,s){var l=this;return(n=n||[])[o=o||0]||(n[o]=[]),C.each(t,function(t,e){var a,i=n[o].length;if(s&&(e.parent=s),e.columns)return a=e.columns.length,o&&e.parent&&l.setColspan(e.parent,a),e.index=v.columnModel.length+a-1,e.colspan=a,e.quicksort=!1,n[o][i++]=e,l.columns2Arr(e.columns,n,o+1,e);e.rowspan=o,e.index=v.columnModel.length,e.menu=void 0===e.menu||e.menu,e.lock=void 0===e.lock||e.lock,e.hide=void 0!==e.hide&&e.hide,e.edit=void 0===e.edit||e.edit,e.add=void 0===e.add||e.add,e.quicksort=void 0===e.quicksort||e.quicksort,n[o][i++]=e,v.columnModel.push(e)}),n},createTrsByData:function(t,e){var a;v.$tbody||(v.$tbody=C("<tbody></tbody>")),t&&(a=t.list||t,v.paging.total=a.length,"object"==typeof t&&(t[BJUI.pageInfo.total]&&(v.paging.total=parseInt(t[BJUI.pageInfo.total])),t[BJUI.pageInfo.pageSize]&&(e&&v.paging.pageSize!=t[BJUI.pageInfo.pageSize]&&v.$selectpage.trigger("bjui.datagrid.paging.pageSize",t[BJUI.pageInfo.pageSize]),v.paging.pageSize=parseInt(t[BJUI.pageInfo.pageSize]))),v.paging.pageCount=i.getPageCount(v.paging.pageSize,v.paging.total),v.paging.pageCurrent>v.paging.pageCount&&(v.paging.pageCurrent=v.paging.pageCount),this.initTbody(a,e)),v.init_tbody||v.$tbody.appendTo(v.$element),v.init_thead||v.initThead()},initTbody:function(o,s){function t(){if(c=c.toLowerCase(),o&&(d=v.allData=o),d.length?"local"==y.local?(m=g.pageSize*(g.pageCurrent-1),b=m+g.pageSize,g.total!=d.length&&(g.total=d.length),m>d.length&&(m=g.pageSize*(g.pageCount-1))):d.length>g.pageSize&&(b=g.pageSize):b=0,b>d.length&&(b=d.length),"array"==c&&o&&o.length&&"array"==C.type(o[0])){var i,t=m,e=b,a=[];"local"==y.local&&(t=0,e=d.length);for(var n=t;n<e;n++)l={},i=0,C.each(d[n],function(t,e){var a,e=e;u[i]&&u[i].gridNumber&&i++,u[i]&&u[i].gridCheckbox&&i++,"string"==typeof e&&(e='"'+e+'"'),u[i]&&!u[i].gridEdit?(a='{"'+u[i].name+'":'+e+"}",C.extend(l,JSON.parse(a))):(u[i]&&u[i].gridEdit&&i++,i>=u.length&&h&&h[t-u.length]&&(a='{"'+h[t-u.length]+'":'+e+"}",C.extend(l,JSON.parse(a)))),i++}),a.push(l);d=v.allData=a}for(n=m;n<b;n++)l=C.extend({},v.allData[n],f),p.push(l);r.createTrs(p,s),v.data=p}var l,r=this,d=v.allData,c=y.dataType||"json",u=v.columnModel,h=v.hiddenFields,p=(v.regional,[]),f=v.attach,g=v.paging,m=0,b=g.pageSize;s&&v.$boxM?v.$boxM.show().trigger("bjui.ajaxEnd").trigger("bjui.ajaxStart",[50,t]):t()},createTrs:function(f,g){var e=v.columnModel,a=v.paging,m=BJUI.doRegional(FRAG.gridEditBtn,v.regional);g&&(C.each(e,function(t,e){e.locked&&(v.colLock(e.th,!1),e.lock_refresh=!0)}),v.$tbody.empty(),v.$lockTableH&&v.$lockTableH.empty(),v.$lockTableB&&v.$lockTableB.empty()),C.each(f,function(c,u){var h,p=C("<tr></tr>"),t=y.linenumberAll?(a.pageCurrent-1)*a.pageSize+(c+1):c+1;C.extend(u,{gridNumber:t,gridIndex:c}),C.each(e,function(t,i){var e,n,o,s,a=i.name||"datagrid-noname",l=u[a],r="",d="";void 0===l&&(l=""),e=l,i.align&&(r=' align="'+i.align+'"'),i.gridCheckbox&&(l='<div><input type="checkbox" data-toggle="icheck" name="datagrid.checkbox" value="true"></div>'),i.gridEdit&&(l=m,d=' class="'+v.classnames.s_edit+'"'),i.calc&&(i.calc_count||(i.calc_count=f.length),a=l&&String(l).isNumber()?+l:0,"sum"==i.calc||"avg"==i.calc?i.calc_sum=(i.calc_sum||0)+a:"max"==i.calc?i.calc_max=!i.calc_max||i.calc_max<a?a:i.calc_max:"min"==i.calc&&(i.calc_min=!i.calc_min||i.calc_min>a?a:i.calc_min)),(h=C("<td"+r+d+"><div>"+l+"</div></td>")).data("val",l).appendTo(p),i.gridNumber&&h.addClass(v.classnames.td_linenumber),i.gridCheckbox&&h.addClass(v.classnames.td_checkbox),g&&i.hidden&&h.css("display","none"),i.items&&!i.render&&(i.render=C.datagrid.renderItem),i.render&&"string"==typeof i.render&&(i.render=i.render.toFunc()),i.render&&"function"==typeof i.render&&(n="",i.items?("string"==typeof i.items&&(i.render.trim().startsWith("[")?i.render=i.render.toObj():i.render=i.render.toFunc()),i.renderTds||(i.renderTds=[]),"function"==typeof i.items?0==c?(v.delayRender||(v.delayRender=0),v.delayRender++,o=h,s=e,C.when(i.items.call(v)).then(function(a){i.items=a,n=i.render.call(v,s,a),o.html(n),C.each(i.renderTds,function(t,e){n=i.render.call(v,e.text(),a),e.html(n),t==i.renderTds.length-1&&(i.renderTds=null)}),v.delayRender--})):i.renderTds.push(h):(n=i.render.call(v,e,i.items),h.html(n))):(n=i.render.call(v,e),h.html(n)))}),p.appendTo(v.$tbody),g&&p.initui()}),g&&(v.initEvents(),y.editMode&&v.edit(),v.$paging&&v.$paging.trigger("bjui.datagrid.paging.jump"),C.each(e,function(t,e){e.lock_refresh&&(v.colLock(e.th,!0),delete e.lock_refresh)})),v.$boxM&&v.$boxM.trigger("bjui.ajaxStop").hide()},loadData:function(t,a){var n=this,e=y.dataUrl,o=y.dataType||"json";v.columnModel;v.$tbody&&v.$boxM.show().trigger("bjui.ajaxStart",[50]),"array"==(o=o.toLowerCase())&&(o="text"),C.ajax({url:e,data:t||{},type:y.loadType,cache:y.cache||!1,dataType:o,success:function(t){var e,i;"xml"==o?(e=[],C(t).find("row").each(function(){i={},C(this).find("cell").each(function(t){var e=C(this),a=e.text(),e=e.attr("name");i[e]=a}),e.push(i)}),e&&n.createTrsByData(e,a)):"json"==o?n.createTrsByData(t,a):n.createTrsByData(t.toObj(),a)}})},appendColumns:function(){v.linenumberColumn={name:"gridNumber",gridNumber:!0,width:30,minWidth:30,label:"No.",align:"center",menu:!1,edit:!1,quicksort:!1},v.checkboxColumn={name:"gridCheckbox",gridCheckbox:!0,width:40,minWidth:40,label:"Checkbox",align:"center",menu:!1,edit:!1,quicksort:!1},v.editBtnsColumn={name:"gridEdit",gridEdit:!0,width:110,minWidth:110,label:"Edit",align:"center",menu:!1,edit:!1,hide:!1,quicksort:!1}},createThead:function(){var n,o,s,l,r,d,c,t=y.columns,u=[];this.appendColumns(),y.showCheckboxcol&&(t.unshift(v.checkboxColumn),"lock"==y.showCheckboxcol&&(v.checkboxColumn.initLock=!0)),y.showLinenumber&&(t.unshift(v.linenumberColumn),"lock"==y.showLinenumber&&(v.linenumberColumn.initLock=!0)),y.showEditbtnscol&&t.push(v.editBtnsColumn),u=this.columns2Arr(t,u),v.columnModel[v.columnModel.length-(y.showEditbtnscol?2:1)].lock=!1,y.hiddenFields&&(v.hiddenFields=y.hiddenFields),v.$thead=C("<thead></thead>"),C.each(u,function(t,e){var a,i=C('<tr style="height:25px;"></tr>');C.each(e,function(t,e){n=e.label||e.name,o=e.align?' align="'+e.align+'"':"",s=e.width?' width="'+e.width+'"':"",l=e.colspan?' colspan="'+e.colspan+'"':"",r=1<u.length-e.rowspan?' rowspan="'+(u.length-e.rowspan)+'"':"",d='<div class="'+v.classnames.th_resizemark+'"></div>',c="",e.gridCheckbox&&(n='<input type="checkbox" data-toggle="icheck">'),e.colspan&&(o=' align="center"'),e.thalign&&(o=' align="'+e.thalign+'"'),e.menu&&y.columnMenu&&(c=' class="'+v.classnames.th_menu+'"'),(a=C("<th"+c+s+o+l+r+'><div><div class="datagrid-space"></div><div class="datagrid-label">'+n+'</div><div class="'+v.classnames.th_cell+'">'+d+"</div></div></th>")).data("index",e.index).appendTo(i),a.find("> div").css("height",1<u.length-e.rowspan?24*(u.length-e.rowspan)+"px":"24px"),r||a.addClass("single-row"),e.gridNumber&&a.addClass(v.classnames.td_linenumber),y.fieldSortable&&e.quicksort&&a.addClass("datagrid-quicksort-th"),e.th=a}),i.appendTo(v.$thead)}),v.$thead.appendTo(v.$element)},createTbody:function(){var t=y.data;v.columnModel;t?("string"==typeof t&&(t=t.trim().startsWith("[")||t.trim().startsWith("{")?t.toObj():t.toFunc()),"function"==typeof t&&(t=t.call()),this.createTrsByData(t)):y.dataUrl&&this.loadData()},setBoxbH:function(t){var e,a=t||y.height,t=0;a<100||(isNaN(a)&&(a=v.$grid.height()),v.$boxT&&(a-=e=v.$boxT.outerHeight(),t+=e),v.$toolbar&&(a-=e=v.$toolbar.outerHeight(),t+=e),v.$box_paging&&(a-=v.$box_paging.outerHeight()),v.$boxF&&(a-=v.$boxF.outerHeight()),t+=v.$tableH.outerHeight(),(a-=v.$boxH.outerHeight())<0&&(a=0),v.$boxB.height(a),v.$boxM.height(a).css({top:t}))},fixedH:function(t){this.setBoxbH(t)},showSubMenu:function(e,a,i){function n(t,e,a){o=e.offset().left-v.$grid.offset().left-1,s={left:"50%"},t.removeClass("active"),e.hasClass("position-right")||d-o<l+r?(a.css({left:"auto",right:"100%"}),s={right:"50%"}):a.css({left:"100%",right:"auto"}),s.opacity=.2,a.stop().animate(s,"fast",function(){C(this).hide()})}var o,s,l=a.outerWidth(),r=i.data("width")||i.outerWidth(),d=v.$boxH.width();e.hover(function(){if(i.appendTo(e),e.hasClass(v.classnames.li_filter)&&i.is(":visible"))return!1;var t=e.siblings("."+v.classnames.li_filter);t.length&&t.hasClass("active")&&n(t,a,t.find("> ."+v.classnames.s_filter)),o=a.offset().left-v.$grid.offset().left-1,s={left:"100%"},a.hasClass("position-right")||d-o<l+r?(i.css({left:"auto",right:"50%"}),s={right:"100%"}):i.css({left:"50%",right:"auto"}),s.opacity=1,e.addClass("active"),i.show().stop().animate(s,"fast")},function(){return!e.hasClass(v.classnames.li_filter)&&void n(e,a,i)}),e.on("bjui.datagrid.th.submenu.hide",function(t,e,a){n(C(this),e,a)})},locking:function(t){var e=t.data("index"),a=v.columnModel[e],e=a.lock,a=a.locked,i=v.$menu,n=i.find("> ul").find("> li."+v.classnames.li_lock),o=n.next();a?(n.addClass("disable"),o.removeClass("disable")):(o.addClass("disable"),n.removeClass("disable")),e?(n.show().off("click").on("click",function(){n.hasClass("disable")||(i.hide().data("bjui.datagrid.menu.btn").removeClass("active"),v.colLock(t,!0))}),o.show().off("click").on("click",function(){o.hasClass("disable")||(i.hide().data("bjui.datagrid.menu.btn").removeClass("active"),v.colLock(t,!1))})):(n.hide().off("click"),o.hide().off("click"))},createShowhide:function(){var n;v.$showhide||(v.col_showhide_count=v.columnModel.length,n=C('<ul class="'+v.classnames.s_showhide+'" role="menu"></ul>'),C.each(v.columnModel,function(t,e){(e.gridNumber||e.gridCheckbox||e.gridEdit)&&v.col_showhide_count--;var a,i=C(FRAG.gridShowhide.replaceAll("#index#",e.index).replaceAll("#label#",e.label||"")).toggleClass("nodisable",!!(e.gridNumber||e.gridCheckbox||e.gridEdit));a=e,i.click(function(){if(C(this).hasClass("disable"))return!1;var t=C(this),e=!t.find("i").hasClass("fa-check-square-o");a.index;t.toggleClass("datagrid-col-check").find("i").attr("class","fa fa"+(e?"-check":"")+"-square-o"),v.showhideColumn(a.th,e),a.gridNumber||a.gridCheckbox||a.gridEdit||(v.col_showhide_count=e?v.col_showhide_count+1:v.col_showhide_count-1),1==v.col_showhide_count?n.find("> li.datagrid-col-check").addClass("disable"):n.find("> li.disable").removeClass("disable"),n.find("> li.nodisable").removeClass("disable")}),i.appendTo(n),e.hide&&i.trigger("click")}),n.appendTo(v.$grid),n.data("width",n.outerWidth()),v.$showhide=n)},showhide:function(t,a){var e=t.index,i=t.th,n=v.$tbody.find("> tr"),o=a?"":"none",s=function(t){var e=t.colspan;a?e++:e--,e?t.th.css("display",""):t.th.css("display","none"),t.th.attr("colspan",e),t.colspan=e,t.parent&&s(t.parent)};void 0===t.hidden&&(t.hidden=!1),t.hidden!=!a&&(t.hidden=!a,i.css("display",o),n.find("> td:eq("+e+")").css("display",o),v.$colgroupH.find("> col").eq(e).css("display",o),v.$colgroupB.find("> col").eq(e).css("display",o),v.$thead.find("> tr.datagrid-filter > th:eq("+e+")").css("display",o),v.$boxF&&(v.$tableF.find("> thead > tr > th:eq("+e+")").css("display",o),v.$colgroupF.find("> col").eq(e).css("display",o)),t.calc&&v.$tfoot&&v.$tfoot.trigger("bjui.datagrid.tfoot.resizeH"),t.parent&&s(t.parent))},jumpPage:function(t,e){var a=v.allData;t&&(v.paging.pageCurrent=t),e&&(v.paging.pageSize=e,v.paging.pageCount=this.getPageCount(e,v.paging.total),v.paging.pageCurrent>v.paging.pageCount&&(v.paging.pageCurrent=v.paging.pageCount)),"remote"==y.local?(e=this.getRemoteFilterData(!0),this.loadData(e,!0)):this.initTbody(a,!0)},quickSort:function(i){if(v.isDom){if("local"==y.local)return;y.sortAll=!0}var t,e,a,n,o,s,l,r;v.$tbody.find("> tr."+v.classnames.tr_edit).length?v.$tbody.alertmsg("info",BJUI.getRegional("datagrid.editMsg")):(a=i.th,t=v.data,e=v.allData,l=i.name,o=i.type,s=v.$thead.find("> tr > th.datagrid-quicksort-th"),l=l||"datagrid-noname",r=function(t){t.sort(function(t,e){t[l];var a=typeof e[l];return"boolean"==o||"number"==o||"number"==a||"boolean"==a?i.sortAsc?t[l]-e[l]:e[l]-t[l]:i.sortAsc?String(t[l]).localeCompare(e[l]):String(e[l]).localeCompare(t[l])})},s.find("> div > .datagrid-label > i").remove(),i.sortAsc?(n="desc",i.sortAsc=!1):(n="asc",i.sortAsc=!0),a.find("> div > .datagrid-label").prepend('<i class="fa fa-long-arrow-'+(i.sortAsc?"up":"down")+'"></i>'),y.sortAll?"remote"==y.local?((a={})[BJUI.pageInfo.orderField]=l,a[BJUI.pageInfo.orderDirection]=n,a[BJUI.pageInfo.pageSize]=v.paging.pageSize,a[BJUI.pageInfo.pageCurrent]=v.paging.pageCurrent,this.loadData(a,!0)):(r(e),this.initTbody(e,!0)):(r(t),this.createTrs(t,!0)))},quickFilter:function(n,t){if(v.isDom){if("remote"!=y.local)return void BJUI.debug("Datagrid Plugin: Please change the local option is remote!");if(!y.dataUrl)return void BJUI.debug("Datagrid Plugin: Not Set the dataUrl option!")}n.th;function o(t,e,a){var i=!1;switch(t){case"=":i=String(e)==String(a);break;case"!=":i=String(e)!=String(a);break;case">":i=parseFloat(a)>parseFloat(e);break;case"<":i=parseFloat(a)<parseFloat(e);break;case"like":i="select"==n.type?String(e)==String(a):0<=String(a).indexOf(String(e))}return i}function e(t,a){return C.grep(t,function(t,e){return i=t,n=0,C.each(a,function(t,e){var a=e.datas;if(n++,!a)return n--,e.model.isFiltered=!1,e.model.th.trigger("bjui.datagrid.th.filter",[!1]),e.model.quickfilter&&e.model.quickfilter.trigger("bjui.datagrid.thead.clearfilter"),!0;e.model.isFiltered=!0,e.model.th.trigger("bjui.datagrid.th.filter",[!0]),a.andor?"and"==a.andor?o(a.operatorA,a.valA,i[t])&&o(a.operatorB,a.valB,i[t])&&n--:"or"==a.andor&&(o(a.operatorA,a.valA,i[t])||o(a.operatorB,a.valB,i[t]))&&n--:a.operatorB?o(a.operatorB,a.valB,i[t])&&n--:o(a.operatorA,a.valA,i[t])&&n--}),!n;var i,n})}var a,i=v.data,s=v.allData,l=n.name;v.filterDatas||(v.filterDatas={}),y.filterMult||(v.filterDatas={}),v.filterDatas[l]={datas:t,model:n},"remote"!=y.local&&s&&(v.oldAllData?s=v.oldAllData.concat():v.oldAllData=s.concat()),y.filterAll?"remote"==y.local?this.loadData(this.getRemoteFilterData(),!0):(a=e(s,v.filterDatas),v.paging.pageCurrent=1,v.paging.pageCount=this.getPageCount(v.paging.pageSize,a.length),this.initTbody(a,!0)):v.isDom?this.loadData(this.getRemoteFilterData(),!0):(a=e(i,v.filterDatas),this.createTrs(a,!0))},getRemoteFilterData:function(t){var a=[];return v.filterDatas&&!C.isEmptyObject(v.filterDatas)&&(C.each(v.filterDatas,function(t,e){return e.datas?(e.model.isFiltered=!0,e.model.th.trigger("bjui.datagrid.th.filter",[!0]),y.jsonPrefix&&(t=y.jsonPrefix+"."+t),e.datas.andor&&a.push({name:"andor",value:e.datas.andor}),e.datas.operatorA&&(a.push({name:t,value:e.datas.valA}),a.push({name:t+".operator",value:e.datas.operatorA})),void(e.datas.operatorB&&(a.push({name:t,value:e.datas.valB}),a.push({name:t+".operator",value:e.datas.operatorB})))):(e.model.isFiltered=!1,e.model.th.trigger("bjui.datagrid.th.filter",[!1]),e.model.quickfilter&&e.model.quickfilter.trigger("bjui.datagrid.thead.clearfilter"),!0)}),t||(v.paging.pageCurrent=1)),a.push({name:BJUI.pageInfo.pageSize,value:v.paging.pageSize}),a.push({name:BJUI.pageInfo.pageCurrent,value:v.paging.pageCurrent}),a},setDomData:function(t){var i=v.columnModel,n={},e=t.attr("data-hidden-datas"),a=v.attach;return t.find("> td").each(function(t){var e=C(this),a=i[t],e=e.attr("data-val")||e.text();a.name?n[a.name]=e:n["datagrid-noname"+t]=e}),e=e&&e.toObj(),C.extend(n,a,{gridNumber:t.index()+1},e),t.data("initData",n),n},initEditInputs:function(){var t=v.columnModel;return v.inputs=[],C.each(t,function(t,e){var a,i=e.name,n="",o=[],s="";if(e)if(e.attrs&&"object"==typeof e.attrs&&C.each(e.attrs,function(t,e){s+=" "+t+"="+e}),e==v.linenumberColumn||e==v.checkboxColumn||e==v.editBtnsColumn)v.inputs.push("");else if(i)if(e.rule?n=' data-rule="'+e.label+"："+e.rule+'"':"date"==e.type&&(n=' data-rule="pattern('+(e.pattern||"yyyy-MM-dd")+')"'),e.type)switch(e.type){case"date":e.pattern||(e.pattern="yyyy-MM-dd"),a=' data-pattern="'+e.pattern+'"',v.inputs.push('<input type="text" name="'+i+'" data-toggle="datepicker"'+a+n+s+">");break;case"select":if(!e.items)return;C.each(e.items,function(t,e){C.each(e,function(t,e){o.push('<option value="'+t+'">'+e+"</option>")})}),v.inputs.push('<select name="'+i+'" data-toggle="selectpicker"'+n+s+' data-width="100%">'+o.join("")+"</select>");break;case"boolean":v.inputs.push('<input type="checkbox" name="'+i+'" data-toggle="icheck"'+n+s+' value="true">');break;case"lookup":v.inputs.push('<input type="text" name="'+i+'" data-toggle="lookup" data-custom-event="true"'+n+s+">");break;case"spinner":v.inputs.push('<input type="text" name="'+i+'" data-toggle="spinner"'+n+s+">");break;case"textarea":v.inputs.push('<textarea data-toggle="autoheight" rows="1"'+n+s+"></textarea>");break;default:v.inputs.push('<input type="text" name="'+i+'"'+n+s+">")}else v.inputs.push('<input type="text" name="'+i+'"'+n+s+">");else v.inputs.push("")}),v.inputs},contextmenuH:function(){var i=this;v.$tableH.on("contextmenu",function(t){v.$showhide||i.createShowhide();var e=t.pageX,a=t.pageY;C(window).width()<e+v.$showhide.width()&&(e-=v.$showhide.width()),C(window).height()<a+v.$showhide.height()&&(a-=v.$showhide.height()),v.$menu&&v.$grid.trigger("click.bjui.datagrid.filter"),v.$showhide.appendTo("body").css({left:e,top:a,opacity:1,"z-index":9999}).show(),C(document).on("click",function(t){C(t.target).closest("."+v.classnames.s_showhide).length||v.$showhide.css({left:"50%",top:0,opacity:.2,"z-index":""}).hide().appendTo(v.$grid)}),t.preventDefault(),t.stopPropagation()})},contextmenuB:function(t,a){t.contextmenu("show",{exclude:"input, .bootstrap-select",items:[{icon:"refresh",title:BJUI.getRegional("datagrid.refresh"),func:function(t,e){v.refresh()}},{title:"diver"},{icon:"plus",title:BJUI.getRegional("datagrid.add"),func:function(t,e){v.add()}},{icon:"edit",title:BJUI.getRegional("datagrid.edit"),func:function(t,e){a&&(t=v.$tbody.find("> tr:eq("+t.index()+")")),v.doEditRow(t)}},{icon:"undo",title:BJUI.getRegional("datagrid.cancel"),func:function(t,e){a&&(t=v.$tbody.find("> tr:eq("+t.index()+")")),t.hasClass(v.classnames.tr_edit)||(t=v.$tbody.find("> tr."+v.classnames.tr_edit)),v.doCancelEditRow(t)}},{icon:"remove",title:BJUI.getRegional("datagrid.del"),func:function(t,e){a&&(t=v.$tbody.find("> tr:eq("+t.index()+")")),v.delRows(t)}}]})}};return i},c.prototype.createTable=function(){var t=this.options,e=this.tools;t.columns&&e.createThead(),(t.data||t.dataUrl)&&e.createTbody()},c.prototype.setColumnModel=function(){var t,e,p=this,f=p.options,a=p.$thead.find("> tr"),g=[],m=[],i=a.length;p.isDom||(p.tools.appendColumns(),e=1<i?' rowspan="'+i+'"':"",f.showCheckboxcol&&(p.columnModel.push(p.checkboxColumn),"lock"==f.showCheckboxcol&&(p.checkboxColumn.initLock=!0),(t=C("<th"+e+'><input type="checkbox" data-toggle="icheck"></th>')).prependTo(a.first()),e&&t.data("datagrid.column",p.checkboxColumn)),f.showLinenumber&&(p.columnModel.unshift(p.linenumberColumn),"lock"==f.showLinenumber&&(p.linenumberColumn.initLock=!0),(t=C('<th class="datagrid-linenumber-td"'+e+">No.</th>")).prependTo(a.first()),e&&t.data("datagrid.column",p.linenumberColumn)),f.showEditbtnscol&&(p.columnModel[t.index()]=p.editBtnsColumn,(t=C("<th"+e+">Edit</th>")).appendTo(a.first()),e&&t.data("datagrid.column",p.editBtnsColumn))),a.length&&1==i?(a.height(25),a.find("> th").each(function(t){var e=C(this).addClass("single-row"),a=e.data("options"),i=e.attr("width")||e.outerWidth(),n=e.html();p.columnModel.length&&p.columnModel[t]?a=p.columnModel[t]:(a&&"string"==typeof a&&(a=a.toObj()),"object"!=typeof a&&(a={}),a.index=t,a.label=n,a.width=void 0===a.width?i:a.width,a.menu=void 0===a.menu||a.menu,a.lock=void 0===a.lock||a.lock,a.hide=void 0!==a.hide&&a.hide,a.edit=void 0===a.edit||a.edit,a.add=void 0===a.add||a.add,a.quicksort=void 0===a.quicksort||a.quicksort,p.columnModel[t]=a),(a.th=e).html('<div><div class="datagrid-space"></div><div class="datagrid-label">'+n+'</div><div class="'+p.classnames.th_cell+'"><div class="'+p.classnames.th_resizemark+'"></div></div></div>'),a.menu&&f.columnMenu&&e.addClass(p.classnames.th_menu),f.fieldSortable&&a.quicksort&&e.addClass("datagrid-quicksort-th"),a.align&&e.attr("align",a.align),e.data("index",t).find("> div").css("height","24px")})):a.each(function(t){var d=[],c=[],u=-1,h=0;g.length&&(d=g.concat(),c=m.concat()),g=[],m=[],C(this).height(25).find("> th").each(function(t){var e=C(this),a=e.data("options")||e.data("datagrid.column")||{},i=parseInt(e.attr("colspan")||0),n=parseInt(e.attr("rowspan")||0),o=e.attr("width")||e.outerWidth(),s=e.html();if(a&&"string"==typeof a&&(a=a.toObj()),"object"!=typeof a&&(a={}),-[1]||1!=i||(i=0),a.label=s,a.th=e,a.gridCheckbox&&(a.label="Checkbox"),u++,i){a.colspan=i;for(var l=d.length?d[u]:u,r=l;r<l+i;r++)g[h++]=r,m[h-1]=a;u+=i-1,e.data("index",u),d.length&&(a.parent=c[u])}n&&1!=n||e.addClass("single-row"),i?e.html('<div style="height:'+(n?24*n:24)+'px;"><div class="datagrid-space"></div><div class="datagrid-label">'+s+'</div><div class="'+p.classnames.th_cell+'"><div class="'+p.classnames.th_resizemark+'"></div></div></div>'):(a.width=void 0===a.width?o:a.width,a.menu=void 0===a.menu||a.menu,a.lock=void 0===a.lock||a.lock,a.hide=void 0!==a.hide&&a.hide,a.edit=void 0===a.edit||a.edit,a.add=void 0===a.add||a.add,a.quicksort=void 0===a.quicksort||a.quicksort,e.html('<div style="height:'+(n?24*n:24)+'px;"><div class="datagrid-space"></div><div class="datagrid-label">'+s+'</div><div class="'+p.classnames.th_cell+'"><div class="'+p.classnames.th_resizemark+'"></div></div></div>'),a.menu&&f.columnMenu&&e.addClass(p.classnames.th_menu),f.fieldSortable&&a.quicksort&&e.addClass("datagrid-quicksort-th"),a.align&&e.attr("align",a.align),d.length?(a.index=d[u],a.parent=c[u],p.columnModel[d[u]]=a):(a.index=u,p.columnModel[u]=a),e.data("index",a.index))})})},c.prototype.init=function(){var t,e,a,i;this.$element.isTag("table")&&(this.$element.data("bjui.datagrid.init")||(a=(t=this).tools,i=t.$element.parent(),t.options.options&&("string"==typeof t.options.options&&(t.options.options=t.options.options.toObj()),C.extend(t.options,"object"==typeof t.options.options&&t.options.options)),t.parentH=i.height(),e=t.options,t.$element.data("bjui.datagrid.init",!0),e.width||i.width(),String(e.width).endsWith("%")&&Math.round(i.width()*parseInt(String(e.width).replace("%",""))/100),e.height=e.height||300,t.isDom=!1,t.columnModel=[],t.inputs=[],t.$grid=C('<div class="bjui-datagrid"></div>').width(e.width).height(e.height),t.$boxH=C('<div class="datagrid-box-h"></div>'),t.$boxB=C('<div class="datagrid-box-b"></div>'),t.$boxM=C('<div class="datagrid-box-m"></div>').appendTo(t.$grid),t.regional=BJUI.regional.datagrid,t.$element.before(t.$grid),"string"==typeof e.paging&&(e.paging=e.paging.toObj()),t.paging=C.extend({},{pageSize:30,selectPageSize:"30,60,90",pageCurrent:1,total:0,showPagenum:5},"object"==typeof e.paging&&e.paging),t.attach={gridNumber:0,gridCheckbox:"#checkbox#",gridEdit:"#edit#"},t.$thead=t.$element.find("> thead"),t.$tbody=t.$element.find("> tbody"),t.$tbody&&t.$tbody.find("> tr").length&&(t.isDom=!0),e.columns?("string"==typeof e.columns&&(e.columns.trim().startsWith("[")?e.columns=e.columns.toObj():e.columns=e.columns.toFunc()),"function"==typeof e.columns&&(e.columns=e.columns.call()),t.$thead=null,a.createThead()):t.$thead&&t.$thead.length&&t.$thead.find("> tr").length&&t.setColumnModel(),t.initTop(),t.$grid.data("bjui.datagrid.table",t.$element.clone()),t.isDom?(a.appendColumns(),t.$tbody.find("> tr > td").each(function(){var t=C(this),e=t.html();t.html("<div>"+e+"</div>")}),t.paging.total?t.paging.pageCount=a.getPageCount(t.paging.pageSize,t.paging.total):(t.paging.total=t.$tbody.find("> tr").length,t.paging.pageCount=1),t.paging.pageCurrent=1,t.initThead()):(t.$tbody=null,(e.data||e.dataUrl)&&a.createTbody())))},c.prototype.refresh=function(){var t=this,e=t.options,a=t.tools,i=(t.isDom,BJUI.pageInfo),n=t.paging,o={};if(!e.dataUrl)return e.data&&e.data.length?void a.initTbody(t.allData,!0):void BJUI.debug("Datagrid Plugin: Not Set the dataUrl option!");o[i.pageSize]=n.pageSize,o[i.pageCurrent]=n.pageCurrent,a.loadData(o,!0),t.filterDatas=null,C.each(t.columnModel,function(t,e){e.th.trigger("bjui.datagrid.th.filter",[!1]),e.isFiltered=!1,e.quickfilter&&e.quickfilter.trigger("bjui.datagrid.thead.clearfilter")}),t.$thead.find("> tr > th.datagrid-quicksort-th").find("> div > .datagrid-label > i").remove()},c.prototype.destroy=function(){var t=this.$grid.data("bjui.datagrid.table");t&&(this.$element.html(t.html()).insertBefore(this.$grid),this.$grid.remove())},c.prototype.initTop=function(){var a,t,e,i,n=this,o=n.options,s=(n.regional,!1),l='<button type="button" class="btn" data-icon=""></button>';o.gridTitle&&(n.$boxT=C('<div class="datagrid-title">'+o.gridTitle+"</div>"),n.$boxT.appendTo(n.$grid)),o.showToolbar&&(o.toolbarItem||o.toolbarCustom)&&(n.$toolbar=C('<div class="datagrid-toolbar"></div'),o.toolbarItem&&(s=!0,0<=o.toolbarItem.indexOf("all")&&(o.toolbarItem="add, edit, cancel, save, |, del, |, refresh, |, import, export"),C.each(o.toolbarItem.split(","),function(t,e){return e=e.trim().toLocaleLowerCase(),!(a&&"|"!=e||(a=C('<div class="btn-group" role="group"></div>').appendTo(n.$toolbar),"|"!=e))||void("add"==e?n.$toolbar_add=C(l).attr("data-icon","plus").addClass("btn-blue").text(BJUI.getRegional("datagrid.add")).appendTo(a).on("click",function(t){n.add()}):"edit"==e?n.$toolbar_edit=C(l).attr("data-icon","edit").addClass("btn-green").text(BJUI.getRegional("datagrid.edit")).appendTo(a).on("click",function(t){var e=n.$tbody.find("> tr."+n.classnames.tr_selected);e.length?o.inlineEditMult?n.doEditRow(e):n.$lastSelect?n.doEditRow(n.$lastSelect):n.doEditRow(e.first()):C(this).alertmsg("info",BJUI.getRegional("datagrid.selectMsg"))}):"cancel"==e?n.$toolbar_calcel=C(l).attr("data-icon","undo").addClass("btn-orange").text(BJUI.getRegional("datagrid.cancel")).appendTo(a).on("click",function(t){n.doCancelEditRow(n.$tbody.find("> tr."+n.classnames.tr_edit))}):"save"==e?n.$toolbar_save=C(l).attr("data-icon","save").addClass("btn-default").text(BJUI.getRegional("datagrid.save")).appendTo(a).on("click",function(t){n.doSaveEditRow()}):"del"==e?n.$toolbar_del=C(l).attr("data-icon","times").addClass("btn-red").text(BJUI.getRegional("datagrid.del")).appendTo(a).on("click",function(t){var e=n.$tbody.find("> tr."+n.classnames.tr_selected);e.length?n.delRows(e):C(this).alertmsg("info",BJUI.getRegional("datagrid.selectMsg"))}):"refresh"==e?n.$toolbar_refresh=C(l).attr("data-icon","refresh").addClass("btn-green").text(BJUI.getRegional("datagrid.refresh")).appendTo(a).on("click",function(t){n.refresh()}):"import"==e?n.$toolbar_add=C(l).attr("data-icon","sign-in").addClass("btn-blue").text(BJUI.getRegional("datagrid.import")).appendTo(a).on("click",function(t){var e;o.importOption&&("string"==typeof(e=o.importOption)&&(e=e.toObj()),e.options&&e.options.url&&("dialog"==e.type?n.$grid.dialog(e.options):"navtab"==e.type?n.$grid.navtab(e.options):n.$grid.bjuiajax("doAjax",e.options)))}):"export"==e&&(n.$toolbar_add=C(l).attr("data-icon","sign-out").addClass("btn-green").text(BJUI.getRegional("datagrid.export")).appendTo(a).on("click",function(t){var e;o.exportOption&&("string"==typeof(e=o.exportOption)&&(e=e.toObj()),e.options&&e.options.url&&("dialog"==e.type?n.$grid.dialog(e.options):"navtab"==e.type?n.$grid.navtab(e.options):"file"==e.type?C.fileDownload(e.options.url,{failCallback:function(t,e){t.trim().startsWith("{")&&(t=t.toObj()),n.$grid.bjuiajax("ajaxDone",t)}}):n.$grid.bjuiajax("doAjax",e.options)))})))})),o.toolbarCustom&&(e=C('<div style="display:inline-block;"></div>'),"string"==typeof o.toolbarCustom?(i=C(o.toolbarCustom))&&i.length?t=i:(i=i.toFunc())&&"string"==typeof(t=i.call(n))&&(t=C(t)):"function"==typeof o.toolbarCustom?"string"==typeof(t=o.toolbarCustom.call(n))&&(t=C(t)):t=o.toolbarCustom,t&&t.length&&"string"!=typeof t&&(s&&e.css("margin-left","5px"),e.appendTo(n.$toolbar),t.appendTo(e))),n.$toolbar.appendTo(n.$grid))},c.prototype.initThead=function(){var a,n=this,t=n.options,e=n.tools,i=n.columnModel,o=[],s=n.$tbody.find("> tr:first-child > td");n.init_thead=!0,n.$colgroupH=C("<colgroup></colgroup>"),n.$tableH=C('<table class="table table-bordered"></table>').append(n.$thead),n.$trsH=n.$thead.find("> tr"),n.table_width=0,C.each(n.columnModel,function(t,e){a=e.width||s.eq(t).outerWidth()||50,o.push('<col style="width:'+a+'px;">'),e.width=a,n.table_width+=a}),n.$thead.before(n.$colgroupH.append(o.join(""))),n.$grid.append(n.$boxH.append(C('<div class="datagrid-wrap-h"></div>').append(n.$tableH)));var l=n.$trsH.find("> th");l.filter(".datagrid-quicksort-th").on("click.bjui.datagrid.quicksort",function(t){C(t.target).closest("."+n.classnames.th_cell).length||n.isResize||e.quickSort(i[C(this).data("index")])}),l.filter(".datagrid-column-menu").on("bjui.datagrid.th.filter",function(t,e){var a=C(this),i=a.find("> div > ."+n.classnames.th_cell+"> ."+n.classnames.btn_menu+"> .btn");e?(a.addClass("filter-active"),i.find("> i").attr("class","fa fa-filter")):(a.removeClass("filter-active"),i.find("> i").attr("class","fa fa-bars"))}),t.contextMenuH&&e.contextmenuH(),n.initTbody(),t.columnResize&&n.colResize(),t.columnMenu&&n.colMenu(),t.paging&&n.initPaging(),t.editMode&&n.edit(),n.resizeGrid();function r(){t.showTfoot&&n.initTfoot(),n.initLock(),n.$grid.initui(),t.height&&e.fixedH(),setTimeout(function(){n.fixedWidth("init")},500),n.initEvents()}t.filterThead?n.delayRender?n.delayFilterTimeout=setInterval(function(){n.delayRender||(clearInterval(n.delayFilterTimeout),n.filterInThead(),r())},100):(n.filterInThead(),r()):r()},c.prototype.fixedWidth=function(t){var e,a,i,n=this,o=n.options,s=0,l=n.columnModel,r=l.length;t&&n.initFixedW||(n.initFixedW=!0,t=function(){n.$boxH.find("> div").css("width",""),n.$boxB.find("> div").css("width",""),n.$boxF&&n.$boxF.find("> div").css("width",""),n.$pagingCon&&n.$pagingCon.css("width",""),(e=n.$boxB.find("> div").width())&&(n.$boxB.find("> div").width(e),n.$boxH.find("> div").width(e),n.$boxF&&n.$boxF.find("> div").width(e),n.table_width>e?n.$pagingCon&&n.$pagingCon.width(e):n.$pagingCon&&n.$pagingCon.width(n.table_width))},o.fullGrid?(t(),e&&e<n.table_width&&(l[r-1]==n.editBtnsColumn&&(s+=n.editBtnsColumn.width,r--),l[0]==n.linenumberColumn&&(s+=n.linenumberColumn.width,r--),l[0]!=n.checkboxColumn&&l[1]!=n.checkboxColumn||(s+=n.checkboxColumn.width,r--),(a=parseInt((e-n.table_width-s)/r))?a--:a=-1,C.each(l,function(t,e){return e==n.linenumberColumn||e==n.checkboxColumn||e==n.editBtnsColumn||((i=e.width+a)<=0&&(i=1),n.$colgroupH.find("> col:eq("+e.index+")").width(i),n.$colgroupB.find("> col:eq("+e.index+")").width(i),n.$colgroupF&&n.$colgroupF.find("> col:eq("+e.index+")").width(i),void(e.new_width=i))}))):t())},c.prototype.initTbody=function(){var t=this,e=t.options,a=(t.tools,t.$tbody.find("> tr").find("> td"),"0");t.init_tbody=!0,t.$colgroupB=t.$colgroupH.clone(),t.$tableB=t.$element,t.$tableB.removeAttr("data-toggle width").empty().append(t.$tbody),t.$tbody.before(t.$colgroupB),t.$grid.append(t.$boxB.append(C('<div class="datagrid-wrap-b"></div>').append(t.$tableB))),-[1]||(a="auto"),e.fullGrid&&(a="100%"),t.$tableH.width(a),t.$tableB.width(a),t.$tableB.addClass("table table-bordered").removeClass("table-hover"),t.$boxB.scroll(function(){t.$boxH.find("> div").prop("scrollLeft",this.scrollLeft),t.$boxF&&t.$boxF.find("> div").prop("scrollLeft",this.scrollLeft),t.$lockB&&t.$lockB.prop("scrollTop",this.scrollTop)}),t.isDom&&(e.showLinenumber&&t.showLinenumber(e.showLinenumber),e.showCheckboxcol&&t.showCheckboxcol(e.showCheckboxcol),e.showEditbtnscol&&t.showEditCol(e.showEditbtnscol),t.$grid.data(t.datanames.tbody,t.$tbody.clone()))},c.prototype.initEvents=function(t){var l=this,e=l.options,a=l.$tbody.find("> tr");(t=t||a).on("click.bjui.datagrid.tr",function(t,e){var a=C(this),i=a.index(),n=l.$tbody.find("> tr."+l.classnames.tr_selected),o=l.$lastSelect;l.$lockTbody&&l.$lockTbody.find("> tr");e?((e=e.is(":checked"))||(l.$lastSelect=a),l.selectedRows(a,!e)):a.hasClass(l.classnames.tr_edit)||(BJUI.KeyPressed.ctrl||BJUI.KeyPressed.shift?(window.getSelection?window.getSelection().removeAllRanges():document.selection.empty(),BJUI.KeyPressed.ctrl?(a.hasClass(l.classnames.tr_selected)||(l.$lastSelect=a),l.selectedRows(a)):BJUI.KeyPressed.shift&&(o=o||(l.$lastSelect=a)).length&&(l.selectedRows(null),o.index()!=i?o.index()>i?l.selectedRows(a.nextUntil(o).add(a).add(o),!0):l.selectedRows(a.prevUntil(o).add(a).add(o),!0):l.selectedRows(i))):1<n.length&&a.hasClass(l.classnames.tr_selected)?(l.selectedRows(n.not(a)),l.$lastSelect=a):(n.length&&n[0]!=this&&l.selectedRows(null),a.hasClass(l.classnames.tr_selected)||(l.$lastSelect=a),l.selectedRows(a)))}).on("mouseenter.bjui.datagrid",function(t){var e=C(this),a=e.index();e.addClass("datagrid-hover"),l.$lockTbody&&l.$lockTbody.find("> tr:eq("+a+")").addClass("datagrid-hover")}).on("mouseleave.bjui.datagrid",function(t){var e=C(this),a=e.index();e.removeClass("datagrid-hover"),l.$lockTbody&&l.$lockTbody.find("> tr:eq("+a+")").removeClass("datagrid-hover")}).on("bjui.datagrid.tr.delete",function(t){var e,a=C(this),i=a.index(),n=l.data,o=l.allData,s=l.$lockTbody&&l.$lockTbody.find("> tr");l.isDom||(e=n[i].gridIndex,l.data=n.remove(i),l.allData=o.remove(e)),l.columnModel[0]==l.linenumberColumn&&(a.nextAll().each(function(){var t=C(this).find("> td:eq(0)"),e=parseInt(t.text());t.text(e-1)}),s&&s.eq(i).trigger("bjui.datagrid.tr.delete",[i])),a.remove()}),e.contextMenuB&&t.each(function(){l.tools.contextmenuB(C(this))}),t.each(function(){var t=C(this);t.find("> td."+l.classnames.td_checkbox).find("input").on("ifClicked",function(){t.trigger("click.bjui.datagrid.tr",[C(this)])})}),l.checkboxColumn&&l.checkboxColumn.th&&l.checkboxColumn.th.find("input").on("ifChanged",function(){var t=C(this).is(":checked"),e=l.$tbody.find("> tr");l.selectedRows(e,t)})},c.prototype.initTfoot=function(){var t=this,e=t.options,a=t.tools,i=t.columnModel,n=C("<tr></tr>");t.$boxF=C('<div class="datagrid-box-f"></div>'),t.$colgroupF=t.$colgroupH.clone(),t.$tableF=t.$tableH.clone().empty(),t.$tableF.append(t.$colgroupF),t.$boxF.append(C('<div class="datagrid-wrap-h"></div>').append(t.$tableF)),t.$boxF.insertAfter(t.$boxB),t.$tfoot=C("<thead></thead>"),C.each(i,function(t,e){var a,i=C("<th><div></div></th>");e.calc&&(a='<div><div class="datagrid-calcbox">#tit#</div>#number#</div>',"avg"==e.calc?i.html(a.replace("#tit#",e.calcTit||"AVG").replace("#number#",(e.calc_sum/e.calc_count).toFixed(e.calcDecimal||2))):"count"==e.calc?i.html(a.replace("#tit#",e.calcTit||"COUNT").replace("#number#",e.calc_count)):"sum"==e.calc?i.html(a.replace("#tit#",e.calcTit||"SUM").replace("#number#",e.calc_sum)):"max"==e.calc?i.html(a.replace("#tit#",e.calcTit||"MAX").replace("#number#",e.calc_max)):"min"==e.calc&&i.html(a.replace("#tit#",e.calcTit||"MIN").replace("#number#",e.calc_min))),e.hidden&&i.css("display","none"),i.appendTo(n)}),t.$tfoot.append(n).appendTo(t.$tableF),t.$tfoot.on("bjui.datagrid.tfoot.resizeH",function(){a.setBoxbH(e.height)})},c.prototype.selectedRows=function(t,a){function i(t){void 0===a&&(a=!0),e.eq(t).toggleClass(n.classnames.tr_selected,a).find("> td."+n.classnames.td_checkbox+" input").iCheck(a?"check":"uncheck"),o&&o.eq(t).toggleClass(n.classnames.tr_selected,a).find("> td."+n.classnames.td_checkbox+" input").iCheck(a?"check":"uncheck")}var n=this,o=n.$lockTbody&&n.$lockTbody.find("> tr"),e=n.$tbody.find("> tr");null==t?(e.removeClass(n.classnames.tr_selected).find("> td."+n.classnames.td_checkbox+" input").iCheck("uncheck"),o&&o.removeClass(n.classnames.tr_selected).find("> td."+n.classnames.td_checkbox+" input").iCheck("uncheck")):"object"==typeof t?t.each(function(){var t=C(this),e=t.index();void 0!==a?i(e):(t.toggleClass(n.classnames.tr_selected).trigger("bjui.datagrid.tr.selected").find("> td."+n.classnames.td_checkbox+" input").iCheck(t.hasClass(n.classnames.tr_selected)?"check":"uncheck"),o&&o.eq(e).toggleClass(n.classnames.tr_selected).trigger("bjui.datagrid.tr.selected").find("> td."+n.classnames.td_checkbox+" input").iCheck(t.hasClass(n.classnames.tr_selected)?"check":"uncheck"))}):isNaN(t)?C.each(t.split(","),function(t,e){i(parseInt(e.trim()))}):isNaN(t)||i(parseInt(t)),n.$lastSelect&&!n.$lastSelect.hasClass(n.classnames.tr_selected)&&(n.$lastSelect=null),n.$element.data("selectedTrs",n.$tbody.find("> tr."+n.classnames.tr_selected))},c.prototype.initLock=function(){var a=this;a.columnModel;a.col_lock_count=0,C.each(a.columnModel,function(t,e){e.initLock&&a.col_lock_count++}),a.col_lock_count&&a.doLock()},c.prototype.colLock=function(t,e){var a,i,n=this;if("number"==C.type(t)){if((a=parseInt(t))<0||a>n.columnModel.length-1)return;(i=n.columnModel[a]).th}else a=t.data("index"),i=n.columnModel[a];i!=n.editBtnsColumn&&i.index!=n.columnModel.length-1&&(void 0===i.locked&&(i.locked=!1),i.locked!=e&&((i.initLock=e)?n.col_lock_count++:n.col_lock_count--,n.col_lock_count<0&&(n.col_lock_count=0),n.doLock()))},c.prototype.fixedLockItem=function(t){var i=this,n=i.columnModel,a=i.$thead.find("> tr.datagrid-filter > th"),e=i.$lockTbody&&i.$lockTbody.find("> tr");t?(a&&a.length&&i.$lockThead.find("> tr.datagrid-filter > th:visible").each(function(){var t=C(this),e=t.index(),e=a.eq(e);e.clone().html("").insertAfter(e),e.show().insertAfter(t),t.remove()}),e&&e.length&&e.filter("."+i.classnames.tr_edit).each(function(){var t=C(this),a=t.index();t.find("> td."+i.classnames.td_edit+":visible").each(function(){var t=C(this),e=t.index();n[e].locked&&((e=i.$tbody.find("> tr:eq("+a+")").find("> td:eq("+e+")")).clone().insertAfter(e),e.show().insertAfter(t),t.remove())})})):(a&&a.length&&i.$lockThead&&i.$lockThead.find("> tr.datagrid-filter > th:visible").each(function(){var t=C(this),e=t.index(),e=a.eq(e);t.clone().insertAfter(t),t.hide().insertAfter(e),e.remove()}),e&&e.length&&e.filter("."+i.classnames.tr_edit).each(function(){var t=C(this),e=t.find("> td:eq("+n.lockIndex+")"),t=t.index();e.hasClass(i.classnames.td_edit)&&(t=i.$tbody.find("> tr:eq("+t+")").find("> td:eq("+index+")"),e.clone().insertAfter(e),e.hide().insertAfter(t),t.remove())}))},c.prototype.doLock=function(){var i,n,a=this,o=(a.options,a.tools),t=a.columnModel,s=(a.$tableH.width(),0),l=0,e=a.$boxF&&!0,r=0;a.$lockBox&&a.$lockBox.length?(a.fixedLockItem(),a.$lockTableH.empty(),a.$lockTableB.empty(),a.$lockTableF&&a.$lockTableF.empty()):(a.$lockBox=C('<div class="datagrid-box-l"></div>'),a.$lockH=C('<div class="datagrid-box-h"></div>'),a.$lockB=C('<div class="datagrid-box-b"></div>'),a.$lockF=C('<div class="datagrid-box-f"></div>'),a.$lockTableH=C('<table class="table table-bordered"></table>'),a.$lockTableB=C("<table></table>").addClass(a.$tableB.attr("class")),a.$lockTableF=C('<table class="table table-bordered"></table>'),a.$lockH.append(a.$lockTableH),a.$lockB.append(a.$lockTableB),a.$lockF.append(a.$lockTableF),a.$lockBox.append(a.$lockH).append(a.$lockB).prependTo(a.$grid),e&&(a.$lockBox.append(a.$lockF),a.$lockF.css("margin-top",a.$boxB.outerHeight()-a.$boxB[0].clientHeight).height(a.$boxF.outerHeight()))),a.$boxT&&(r+=a.$boxT.outerHeight()),a.$toolbar&&(r+=a.$toolbar.outerHeight()),r&&a.$lockBox.css({top:r}),C.each(t,function(t,e){e.lockShow=!1,e.lockHide=!1,e.initLock?(e.hidden&&o.showhide(e,!0),e.lockHide=!0,e.locked=!0,e.lockIndex=l++,s+=e.width):(e.lockShow=!0,e.hidden?e.lockShow=!1:o.showhide(e,!1),e.locked&&(e.lockShow=!0),e.locked=!1)}),a.$lockThead=a.$thead.clone(!0),a.$lockTbody=a.$tbody.clone(),a.$lockColgroupH=a.$colgroupH.clone(),a.$lockColgroupB=a.$colgroupB.clone(),a.$lockTableH.append(a.$lockColgroupH).append(a.$lockThead).css("width",s),a.$lockTableB.append(a.$lockColgroupB).append(a.$lockTbody).css("width",s),e&&(a.$lockTfoot=a.$tableF.find("> thead").clone(),a.$lockColgroupF=a.$colgroupF.clone(),a.$lockTableF.append(a.$lockColgroupF).append(a.$lockTfoot).css("width",s)),C.each(a.columnModel,function(t,e){e.lockShow&&o.showhide(e,!0),e.lockHide&&o.showhide(e,!1)}),a.$boxH.find("> div").css("width",""),a.$boxB.find("> div").css("width",""),a.$boxF&&a.$boxF.find("> div").css("width",""),setTimeout(function(){var t=a.$boxB.find("> div").width();a.$boxB.find("> div").width(t),a.$boxH.find("> div").width(t),a.$boxF&&a.$boxF.find("> div").width(t)},50),0==a.col_lock_count?a.$lockBox.hide():a.$lockBox.show(),1<s&&--s,a.$boxH.css("margin-left",s),a.$boxB.css("margin-left",s),e&&a.$boxF.css("margin-left",s),a.$lockB.height(a.$boxB[0].clientHeight),a.$lockB.prop("scrollTop",a.$boxB[0].scrollTop);var d=a.$lockTableH.height(),r=a.$thead.height(),t=a.$lockTableF&&a.$lockTableF.height(),e=a.$tableF&&a.$tableF.height();d!=r&&(d<r?a.$lockTableH.height(r):a.$tableH.height(d)),t&&e&&t!=e&&(t<e?a.$lockTableF.find("> thead > tr:first-child > th:visible:first").height(e):a.$tableF.find("> thead > tr:first-child > th:visible:first").height(t)),n=a.$lockTbody.find("> tr"),i=a.$tbody.find("> tr"),setTimeout(function(){var t=a.$lockTableB.height(),e=a.$tableB.height();t!=e&&(e<t?n.each(function(t){var e=C(this),a=e.find("> td:visible:first").outerHeight();30<a&&(e.height(a),i.eq(t).height(a))}):i.each(function(t){var e=C(this),a=e.find("> td:visible:first").outerHeight();30<a&&(e.height(a),n.eq(t).height(a))}))},20),a.fixedLockItem(1),n.find("> td:hidden").remove(),a.initLockEvents(n)},c.prototype.initLockEvents=function(t){var i,e;this.$lockTbody&&(e=(i=this).options,(t=t||i.$lockTbody.find("> tr")).on("click.bjui.datagrid.tr",function(){var t=C(this).index();i.$tbody.find("> tr:eq("+t+")").trigger("click.bjui.datagrid.tr")}).on("bjui.datagrid.tr.delete",function(t,e){var a=C(this);i.linenumberColumn&&i.linenumberColumn.locked&&a.nextAll().each(function(){var t=C(this).find("> td:eq(0)"),e=parseInt(t.text());t.text(e-1)}),a.remove()}).find("> td."+i.classnames.td_checkbox+" input").on("ifChanged",function(){var t=C(this),e=t.closest("tr"),a=e.index();t.is(":checked")?(e.addClass(i.classnames.tr_selected),$trs.eq(a).addClass(i.classnames.tr_selected)):(e.removeClass(i.classnames.tr_selected),$trs.eq(a).removeClass(i.classnames.tr_selected))}),e.contextMenuB&&t.each(function(){i.tools.contextmenuB(C(this),!0)}))},c.prototype.filterInThead=function(){var s=this,a=(s.options,s.tools),l=s.regional,t=s.columnModel,r=C('<tr class="datagrid-filter"></tr>'),d=function(t,e){a.quickFilter(t,e?{operatorA:"like",valA:e}:null)};s.inputs&&s.inputs.length||a.initEditInputs(),C.each(t,function(t,e){var i,n,a=C(s.inputs[t]),o=C("<th></th>");"spinner"==e.type?a=C('<input type="text" name="'+e.name+'">'):"boolean"==e.type?a=C(BJUI.doRegional('<select name="'+e.name+'" data-toggle="selectpicker"><option value="">#all#</option><option value="true">#true#</option><option value="false">#false#</option></select>',l)):"select"==e.type&&a.find("> option:first-child").val()&&(a=C('<select name="'+e.name+'" data-toggle="selectpicker"></select>').append(BJUI.doRegional('<option value="">#all#</option>',l)).append(a.html())),o.append(a),e.hidden&&o.hide(),"boolean"==e.type&&o.attr("align","center"),o.appendTo(r),a.data("clearFilter",!1),i=a,t=o,"date"==(o=(n=e).type)?i.on("afterchange.bjui.datepicker",function(t,e){d(n,i.val())}).change(function(){d(n,i.val())}):("lookup"==o&&t.on("customEvent.bjui.lookup",'[data-toggle="lookupbtn"]',function(t,e){for(var a in e)n.name==a&&(i.val(e[a]),d(n,e[a]))}),i.change(function(){d(n,i.val())})),a.on("bjui.datagrid.thead.clearfilter",function(){a.val(""),"boolean"!=e.type&&"select"!=e.type||a.selectpicker("refresh")}),e.quickfilter=a}),r.appendTo(s.$thead).initui()},c.prototype.showLinenumber=function(t){var e,a,i,n,o=this,s=o.options,l=o.columnModel,r=l[0];o.data;r==o.linenumberColumn?"string"!=typeof t||"lock"!=t&&"unlock"!=t?o.showhideColumn(r.th,!!t):o.colLock(r.th,"lock"==t):t&&(a='<col style="width:30px;">',i=(e=o.$thead.find("> tr")).filter(".datagrid-filter"),n=e.length-i.length,r=o.linenumberColumn,l.unshift(r),o.$colgroupH.prepend(a),o.$colgroupB.prepend(a),o.$colgroupF&&o.$colgroupF.prepend(a),n=C('<th align="center" rowspan="'+n+'" class="'+o.classnames.td_linenumber+'">'+o.linenumberColumn.label+"</th>"),e.first().prepend(n),i.length&&i.prepend("<th></th>"),r.th=n,r.index=0,r.width=30,o.$tbody.find("> tr").each(function(t){C(this).prepend('<td align="center" class="'+o.classnames.td_linenumber+'">'+(t+1)+"</td>")}),o.$tableF&&o.$tableF.find("> thead > tr").prepend("<th></th>"),C.each(l,function(t,e){e.index=t,e.th&&e.th.data("index",t)}),"lock"==t&&o.colLock(n,!0),o.$showhide&&(o.$showhide.remove(),o.colShowhide(s.columnShowhide)))},c.prototype.showCheckboxcol=function(t){var e,a,i,n,o,s,l=this,r=l.options,d=l.columnModel,c=d[0],u=l.data;d[0]==l.checkboxColumn&&(o=d[0]),d[1]==l.checkboxColumn&&(o=d[1]),o?"string"!=typeof t||"lock"!=t&&"unlock"!=t?l.showhideColumn(o.th,t):l.colLock(o.th,"lock"==t):t&&(a='<col style="width:26px;">',n=(e=l.$thead.find("> tr")).filter(".datagrid-filter"),s=e.length-n.length,o=l.checkboxColumn,s=C('<th align="center" rowspan="'+s+'" class="'+l.classnames.td_checkbox+'"><div><input type="checkbox" data-toggle="icheck"></div></th>'),c==l.linenumberColumn?(d.splice(1,0,o),u&&u.splice(1,0,{name:o.name}),o.index=1,l.$colgroupH.find("> col:first").after(a),l.$colgroupB.find("> col:first").after(a),l.$colgroupF&&l.$colgroupF.find("> col:first").after(a),n.length&&n.find("> th:first").after("<th></th>"),e.first().find("> th:first").after(s),l.$tableF&&l.$tableF.find("> thead > tr > th:first").after("<th></th>")):(d.unshift(o),u&&u.unshift({name:o.name}),o.index=0,l.$colgroupH.prepend(a),l.$colgroupB.prepend(a),l.$colgroupF&&l.$colgroupF.prepend(a),n.length&&n.prepend("<th></th>"),e.first().prepend(s),l.$tableF&&l.$tableF.find("> thead > tr").prepend("<th></th>")),s.initui(),o.th=s,o.width=26,l.$tbody.find("> tr").each(function(t){i=C('<td align="center" class="'+l.classnames.td_checkbox+'"><input type="checkbox" data-toggle="icheck" name="datagrid.checkbox"></td>'),0==o.index?C(this).prepend(i):C(this).find("> td:first").after(i),i.initui()}),C.each(d,function(t,e){e.index=t,e.th&&e.th.data("index",t)}),"lock"==t&&l.colLock(s,!0),l.$showhide&&(l.$showhide.remove(),l.colShowhide(r.columnShowhide)))},c.prototype.showEditCol=function(t){var e,a,i,n,o=this,s=o.options,l=o.columnModel,r=l[l.length-1];o.data;r==o.editBtnsColumn?o.showhideColumn(r.th,!!t):t&&(a='<col style="width:110px;">',n=(e=o.$thead.find("> tr")).filter(".datagrid-filter"),t=e.length-n.length,r=o.editBtnsColumn,l.push(r),o.$colgroupH.append(a),o.$colgroupB.append(a),o.$colgroupF&&o.$colgroupF.append(a),t=C('<th align="center" rowspan="'+t+'">Edit</th>'),e.first().append(t),n.length&&n.append("<th></th>"),t.initui().data("index",l.length-1),r.th=t,r.width=110,r.index=l.length-1,o.$tbody.find("> tr").each(function(t){i=C('<td align="center" class="'+o.classnames.s_edit+'">'+BJUI.doRegional(FRAG.gridEditBtn,o.regional)+"</td>"),C(this).append(i),i.initui()}),o.edit(o.$tbody.find("> tr")),o.$tableF&&o.$tableF.find("> thead > tr").append("<th></th>"),o.$showhide&&(o.$showhide.remove(),o.colShowhide(s.columnShowhide)))},c.prototype.colResize=function(){var f=this,g=f.tools,m=f.columnModel,t=f.$thead,b=f.$grid.find("> .resizeProxy");b.length||(b=C('<div class="resizeProxy" style="left:0; display:none;"></div>')).appendTo(f.$grid),t.find("> tr > th").each(function(t){var p=C(this);p.find("> div > ."+f.classnames.th_cell+"> ."+f.classnames.th_resizemark).on("mousedown.bjui.datagrid.resize",function(t){var i,n,e=f.$boxH.scrollLeft(),a=parseInt(f.$boxH.css("marginLeft")||0),o=g.getRight(p)-e+a,s=p.data("index"),l=m[s],r=l.th.width(),d=f.$tbody.find("> tr"),c=f.$lockTbody&&f.$lockTbody.find("> tr"),u=f.$lockTableB&&f.$lockTableB.height(),h=f.$tableB.height();f.isResize=!0,l.locked&&(o=g.getRight4Lock(l.lockIndex),l.lockWidth&&(r=l.lockWidth)),b.show().css({left:o,bottom:f.$box_paging?f.$box_paging.outerHeight():0,cursor:"col-resize"}).basedrag({scop:!0,cellMinW:20,relObj:b,move:"horizontal",event:t,stop:function(){var t=b.position().left-o,e=t+r,a=(f.$tableH.width(),f.$lockTableH&&f.$lockTableH.width()+t);e<5&&(e=20),l.minWidth&&e<l.minWidth&&(e=l.minWidth),e!=r+t&&(a=a-t+(e-r)),l.width=e,l.locked?a<.75*f.$grid.width()&&(l.lockWidth=e,f.$lockColgroupH.find("> col:eq("+s+")").width(e),f.$lockColgroupB.find("> col:eq("+s+")").width(e),f.$lockColgroupF&&f.$lockColgroupF.find("> col:eq("+s+")").width(e),f.$lockTableH.width(a),f.$lockTableB.width(a),f.$lockTableF&&f.$lockTableF.width(a),a=f.$lockBox.width(),f.$boxH.css("margin-left",a-1),f.$boxB.css("margin-left",a-1),f.$boxF&&f.$boxF.css("margin-left",a-1),f.$colgroupH.find("> col:eq("+s+")").width(e),f.$colgroupB.find("> col:eq("+s+")").width(e),f.$colgroupF&&f.$colgroupF.find("> col:eq("+s+")").width(e)):setTimeout(function(){f.$colgroupH.find("> col:eq("+s+")").width(e),f.$colgroupB.find("> col:eq("+s+")").width(e),f.$colgroupF&&f.$colgroupF.find("> col:eq("+s+")").width(e)},1),setTimeout(function(){d.css("height",""),n=f.$tableB.height(),f.$lockTbody&&(c.css("height",""),(i=f.$lockTableB.height())==u&&n==h||(n<i?c.each(function(t){var e=C(this),a=e.find("> td:eq("+l.lockIndex+")").outerHeight();30<a&&(e.height(a),d.eq(t).height(a))}):d.each(function(t){var e=C(this),a=e.find("> td:eq("+s+")").outerHeight();30<a&&(e.height(a),c.eq(t).height(a))})),f.$lockB.height(f.$boxB[0].clientHeight)),l.calc&&f.$tfoot&&f.$tfoot.trigger("bjui.datagrid.tfoot.resizeH"),f.isResize=!1},10),b.hide(),f.resizeFlag=!0}})})})},c.prototype.colMenu=function(){var h=this,t=h.options,p=h.tools,e=h.regional,a=h.$trsH.find("> th."+h.classnames.th_menu),f=h.$grid.find("> ."+h.classnames.s_menu);f.legnth||((f=C(BJUI.doRegional(FRAG.gridMenu,e))).hide().appendTo(h.$grid),h.$menu=f),h.colShowhide(t.columnShowhide),a.each(function(){var d,c=C(this),t=c.data("index"),u=h.columnModel[t],e=c.find("> div > ."+h.classnames.th_cell),t=e.find("> ."+h.classnames.btn_menu);t.length||(d=C('<button class="btn btn-default"><i class="fa fa-bars"></button>'),(t=C('<div class="'+h.classnames.btn_menu+'"></div>').append(d)).appendTo(e),d.click(function(){c.closest("tr");var e,t=parseInt(c.attr("rowspan")||1),a=C(this).offset().left-h.$grid.offset().left-1,i=25*(h.$trsH.length-t)+13*t+11,n=f.find("> ul > li.datagrid-li-showhide"),t=f.data("bjui.datagrid.menu.btn");t&&t.length&&t.removeClass("active"),C(this).addClass("active"),n.length&&h.$showhide&&(h.$showhide.appendTo(n),h.$showhide.data("width")),f.css({position:"absolute",top:i,left:a}).show().data("bjui.datagrid.menu.btn",d).siblings("."+h.classnames.s_menu).hide(),e=f.outerWidth();function o(t){h.$boxH.width()-t<e?f.css({left:t-e+18}).addClass("position-right"):f.css({left:t}).removeClass("position-right")}var s;o(a),s=d,h.$boxB.scroll(function(){var t=s.offset().left-h.$grid.offset().left-1;o(t)}),h.colFilter(c,!0),p.locking(c);var l=f.find("> ul > li."+h.classnames.li_asc),r=l.next();l.click(function(){u.sortAsc=!1,p.quickSort(u)}),r.click(function(){u.sortAsc=!0,p.quickSort(u)}),f.on("bjui.datagrid.th.sort",function(t,e){l.toggleClass("sort-active",e),r.toggleClass("sort-active",!e)})}))}),h.$grid.on("click.bjui.datagrid.filter",function(t){var e=C(t.target),t=h.$grid.find("."+h.classnames.s_menu+":visible");t.length&&!e.closest("."+h.classnames.btn_menu).length&&(e.closest("."+h.classnames.s_menu).length||t.hide().data("bjui.datagrid.menu.btn").removeClass("active"))})},c.prototype.colShowhide=function(t){var e=this,a=(e.options,e.tools),i=e.$menu,n=i.find("> ul").find("> li."+e.classnames.li_showhide);t?e.$showhide||(a.createShowhide(),a.showSubMenu(n,i,e.$showhide)):n.hide()},c.prototype.showhideColumn=function(t,e){var a,i=this.tools;if("number"==C.type(t)){if((a=parseInt(t))<0)return}else a=t.data("index");if(a=this.columnModel[a]){if(a.locked){if(e)return;this.colLock(a.th,e)}i.showhide(a,e)}},c.prototype.colFilter=function(s,t){var l=this,r=(l.options,l.tools),e=l.regional,d=s.data("bjui.datagrid.filter"),c=l.$menu,u=c.find("> ul > li."+l.classnames.li_filter);if(l.inputs&&l.inputs.length||r.initEditInputs(),t){if(u.find("."+l.classnames.s_filter).addClass("hide"),!d||!d.length){d=C(BJUI.doRegional(FRAG.gridFilter.replaceAll("#label#",s.text()),e)).hide().appendTo(l.$grid);var h,p,a=s.data("index"),i=l.columnModel[a],n=i.type||"string",o=i.operator||[],f=d.find("span.filter-a"),t=d.find("span.filter-b"),g=C('<select data-toggle="selectpicker" data-container="true"></select>'),m=C(l.inputs[a]);m.removeAttr("data-rule").attr("size",10).addClass("filter-input"),"string"==n||"lookup"==n?o.length||(o=["=","!=","like"]):"number"==n||"int"==n||"spinner"==n?("spinner"==n&&m.removeAttr("data-toggle"),o.length||(o=["=","!=",">","<",">=","<="])):"date"==n?o.length||(o=["=","!="]):"boolean"==n?(o.length||(o=["=","!="]),m=C(BJUI.doRegional('<select name="'+i.name+'" data-toggle="selectpicker"><option value="">#all#</option><option value="true">#true#</option><option value="false">#false#</option></select>',e))):"select"==n&&(o.length||(o=["=","!="]),m.attr("data-width","80"),m.find("> option:first-child").val()&&(m=C('<select name="'+i.name+'" data-toggle="selectpicker" data-width="80"></select>').append(BJUI.doRegional('<option value="">#all#</option>',e)).append(m.html())));for(var b=0;b<o.length;b++)g.append('<option value="'+o[b]+'">'+o[b]+"</option>");p=(h=m).clone(),f.append(g).append(m),t.append(g.clone()).append(p),s.data("bjui.datagrid.filter",d),d.appendTo(u),d.data("width",d.outerWidth()).hide().initui(),d.on("customEvent.bjui.lookup",'[data-toggle="lookupbtn"]',function(t,e){for(var a in e)i.name==a&&m.val(e[a])});var f=d.find("button.ok"),t=d.find("button.clear"),v=d.find("select"),y=v.first(),k=v.last(),x=v.eq(1);f.click(function(){var t=y.val(),e=h.val().trim(),a=k.val(),i=p.val().trim(),n=x.val(),o={};e.length&&C.extend(o,{operatorA:t,valA:e}),i.length&&(e.length&&C.extend(o,{andor:n}),C.extend(o,{operatorB:a,valB:i})),C.isEmptyObject(o)||(r.quickFilter(l.columnModel[s.data("index")],o),l.$grid.trigger("click"),u.trigger("bjui.datagrid.th.submenu.hide",[c,d]))}),t.click(function(){var t=l.columnModel[s.data("index")];v.find("> option:first").prop("selected",!0),v.selectpicker("refresh"),h.val(""),p.val(""),t.isFiltered&&(r.quickFilter(t,null),l.$grid.trigger("click"),u.trigger("bjui.datagrid.th.submenu.hide",[c,d]))})}r.showSubMenu(u,c,d.removeClass("hide")),c.find('> ul > li:not(".'+l.classnames.li_filter+'")').on("mouseover",function(){u.hasClass("active")&&u.trigger("bjui.datagrid.th.submenu.hide",[c,d])})}else u.hide()},c.prototype.initPaging=function(){var t,o=this,s=o.tools,l=(o.options,o.paging),i=BJUI.regional.pagination,e=FRAG.gridPaging,a=[],n=l.pageCount,r=[];if(0!=l.total){for(var d=(t=s.getPageInterval(n,l.pageCurrent,l.showPagenum)).start;d<t.end;d++)a.push(FRAG.gridPageNum.replace("#num#",d).replace("#active#",l.pageCurrent==d?" active":""));e=BJUI.doRegional(e.replaceAll("#pageCurrent#",l.pageCurrent).replaceAll("#count#",l.total+"/"+parseInt(n||0)),i),o.$box_paging=C('<div class="datagrid-paging-box"></div>'),o.$pagingCon=C('<div class="paging-content"></div>').width(o.$boxB.width()),o.$refreshBtn=C('<button class="btn-default btn-refresh" title="'+i.refresh+'" data-icon="refresh"></button>'),o.$paging=C('<div class="datagrid-paging"></div>'),o.$btnpaging=C(e),o.$pagenum=C(a.join("")),o.$pagesize=C('<div class="datagrid-pagesize"><span></span></div>'),o.$selectpage=C('<select data-toggle="selectpicker"></select>'),o.$pagingCon.appendTo(o.$box_paging),o.$box_paging.appendTo(o.$grid),o.$pagesize.appendTo(o.$pagingCon),o.$refreshBtn.appendTo(o.$pagesize),o.$selectpage.appendTo(o.$pagesize),o.$paging.appendTo(o.$pagingCon),o.$btnpaging.appendTo(o.$paging),o.$pagenum.insertAfter(o.$btnpaging.find("> li.page-prev")),o.$box_paging.initui();var c=o.$btnpaging.find("> li.page-jumpto"),u=c.next(),h=u.next(),p=o.$btnpaging.find("> li.page-next"),f=p.next(),g=function(){u.addClass("disabled"),h.addClass("disabled")},m=function(){u.removeClass("disabled"),h.removeClass("disabled")},b=function(){p.addClass("disabled"),f.addClass("disabled")},v=function(){p.removeClass("disabled"),f.removeClass("disabled")},y=function(){g(),v()},k=function(){m(),b()},x=function(t){o.$selectpage.empty(),t=t||o.paging.pageSize,(r=l.selectPageSize.split(",")).push(String(t)),C.unique(r).sort(function(t,e){return t-e}),C.each(r,function(t,e){var a=C('<option value="'+e+'">'+e+"/"+i.page+"</option>");e==l.pageSize&&a.prop("selected",!0),o.$selectpage.append(a)}),o.$selectpage.selectpicker("refresh")};1==l.pageCurrent&&y(),l.pageCurrent==l.pageCount&&(k(),1==l.pageCurrent&&g()),x(),o.$paging.on("click",".page-num",function(t){var e=C(this);e.hasClass("active")||o.jumpPage(e.text()),t.preventDefault()}).on("bjui.datagrid.paging.jump",function(t){for(var e=o.paging.pageCurrent,a=s.getPageInterval(o.paging.pageCount,e,l.showPagenum),i=[],n=a.start;n<a.end;n++)i.push(FRAG.gridPageNum.replace("#num#",n).replace("#active#",e==n?" active":""));o.$pagenum.empty(),o.$pagenum=C(i.join("")),o.$pagenum.insertAfter(h),1==e?(y(),e==o.paging.pageCount&&b()):e==o.paging.pageCount?k():(m(),v()),c.find("input").val(e),o.$btnpaging.find("> li.page-total > span").html(o.paging.total+"/"+o.paging.pageCount)}),o.$selectpage.on("bjui.datagrid.paging.pageSize",function(t,e){x(e)}),c.find("input").on("keyup",function(t){t.which!=BJUI.keyCode.ENTER||(t=C(this).val())&&o.jumpPage(t)}),u.on("click",function(){1<o.paging.pageCurrent&&o.jumpPage(1)}),h.on("click",function(){1<o.paging.pageCurrent&&o.jumpPage(o.paging.pageCurrent-1)}),p.on("click",function(){o.paging.pageCurrent<o.paging.pageCount&&o.jumpPage(o.paging.pageCurrent+1)}),f.on("click",function(){o.paging.pageCurrent<o.paging.pageCount&&o.jumpPage(o.paging.pageCount)}),o.$refreshBtn.on("click",function(){o.refresh()}),o.$selectpage.on("change",function(){var t=C(this).val();o.jumpPage(null,t)})}},c.prototype.jumpPage=function(t,e){var a=this.paging,i=a.pageCount;t&&isNaN(t)||e&&isNaN(e)||t&&((t=parseInt(t))<1&&(t=1),i<t&&(t=i),t==a.pageCurrent)||e&&(e=parseInt(e))>a.total||this.tools.jumpPage(t,e)},c.prototype.add=function(t){var o,i,e,s,n,a,l;this.tools.beforeEdit()&&(this.options.editUrl?this.options.editMode&&(this.options.inlineEditMult||this.doCancelEditRow(this.$tbody.find("> tr."+this.classnames.tr_edit)),i=(o=this).options,o.tools,l=o.paging,s={},n=(l.pageCurrent-1)*l.pageSize,l=function(t){var i=C("<tr></tr>").addClass(o.classnames.tr_add),n=i.clone();return C.each(o.columnModel,function(t,e){var a=C("<td></td>");e.gridNumber?a.addClass(o.classnames.td_linenumber).text(0):e.gridCheckbox?a.addClass(o.classnames.td_checkbox).html('<div><input type="checkbox" data-toggle="icheck" name="datagrid.checkbox" value="true"></div>'):e.gridEdit?a.addClass(o.classnames.s_edit).data("isAdd",!0).html(BJUI.doRegional(FRAG.gridEditBtn,o.regional)):a.text(""),e.hidden&&a.css("display","none"),e.align&&a.attr("align",e.align),s[e.name]="",e.locked?(a.clone().show().appendTo(n),a.hide().appendTo(i)):a.appendTo(i)}),s=C.extend({},o.attach,s),o.emptyData||(o.emptyData=s),{tr:i,lockTr:n.find("> td").length?n:null}},t=t||(i.addLocation||"first"),o.$lastSelect||("prev"==t?t="first":"next"==t&&(t="last")),"first"==t?(a=0,(e=l()).tr.prependTo(o.$tbody),e.lockTr&&e.lockTr.prependTo(o.$lockTbody)):"last"==t?(a=o.data?o.data.length:0,(e=l()).tr.appendTo(o.$tbody),e.lockTr&&e.lockTr.appendTo(o.$lockTbody)):"prev"==t?(a=o.$lastSelect.index(),(e=l()).tr.insertBefore(o.$lastSelect),e.lockTr&&e.lockTr.insertBefore(o.$lockTbody.find("> tr:eq("+o.$lastSelect.index()+")"))):"next"==t&&(a=o.$lastSelect.index()+1,(e=l()).tr.insertAfter(o.$lastSelect),e.lockTr&&e.lockTr.insertAfter(o.$lockTbody.find("> tr:eq("+o.$lastSelect.index()+")"))),l=C.extend({},o.emptyData,{addFlag:!0}),o.data||(o.data=[]),o.allData||(o.allData=[]),o.allData.length?o.allData.splice(a+n,0,l):o.allData.push(l),o.data.length?o.data.splice(a,0,l):o.data.push(l),C.each(o.data,function(t,e){var a=i.linenumberAll?n+(t+1):t+1;C.extend(e,{gridNumber:a,gridIndex:t})}),e.tr.initui(),setTimeout(function(){o.initEvents(e.tr)},20),e.lockTr&&o.initLockEvents(e.lockTr),o.edit(e.tr),"dialog"!=i.editMode?o.doEditRow(e.tr,"inline",!0):o.dialogEdit(e.tr,!0)):BJUI.debug("Datagrid Plugin: Edit url is not set!"))},c.prototype.edit=function(t){var d=this,e=d.options,c=d.tools,u=e.editMode;d.columnModel;"dialog"!=u&&(u="inline"),(t=t||d.$tbody.find("> tr")).find("> td."+d.classnames.s_edit).each(function(){var n=C(this),o=n.find("button"),a=o.first(),s=a.next(),l=s.next(),r=l.next(),i=r.next();a.on("click",function(t,e){var a=C(this).closest("tr"),i=n.data("isAdd");if(e=e||(d.isDom?a.data("initData")||c.setDomData(a):d.data[a.index()]),!c.beforeEdit(a,e))return!1;"dialog"!=u?(d.inlineEdit(a,i),o.hide(),s.show(),r.show(),i&&(s.hide(),l.show())):d.dialogEdit(a,i),t.stopPropagation()}),l.on("click",function(t){var e=C(this),a=e.closest("tr");d.updateEdit(a,e),t.stopPropagation()}).on("bjui.datagrid.update.tr",function(){o.hide(),a.show(),i.show()}),s.on("click",function(t){var e=C(this),a=e.closest("tr");d.updateEdit(a,e),t.stopPropagation()}).on("bjui.datagrid.update.tr",function(){o.hide(),a.show(),i.show()}),r.on("click",function(t){var e=C(this).closest("tr");d.cancelEdit(e),o.hide(),a.show(),i.show(),t.stopPropagation()}),i.on("click",function(t){var e=C(this).closest("tr");d.delRows(e),t.stopPropagation()})})},c.prototype.doEditRow=function(t,a,i){var e,n,o,s,l=this,r=[];a=a||l.options.editMode,"object"==typeof t?e=t:isNaN(t)?(o=l.$tbody.find("> tr"),(t=(t=t.split(",")).unique()).sort(function(t,e){return t.trim()-e.trim()}),C.each(t,function(t,e){e=o.eq(parseInt(e.trim()));e&&e.length&&(s=s?s.add(e):e)}),e=s):isNaN(t)||(e=l.$tbody.find("> tr").eq(t)),e.length&&(e.each(function(){var t=C(this),e=t.index(),e=l.isDom?t.data("initData")||tools.setDomData(t):l.data[e];r.push(e)}),l.tools.beforeEdit(e,r)&&(l.options.editUrl?e.each(function(t){var e=C(this);n=e.find("> td."+l.classnames.s_edit+" > button.edit"),"dialog"!=a?n.length?n.trigger("click",[r[t]]):l.inlineEdit(e,i,r[t]):l.dialogEdit(e,i,r[t])}):BJUI.debug("Datagrid Plugin: Edit url is not set!")))},c.prototype.doCancelEditRow=function(t){var a=this,t="number"==C.type(t)?this.$tbody.find("> tr").eq(t):t;t.each(function(){var t=C(this),e=t.find("> td."+a.classnames.s_edit+" > button.cancel");e.length?e.trigger("click"):a.cancelEdit(t)})},c.prototype.doSaveEditRow=function(t){var e=this,a=e.options,t="number"==C.type(t)?this.$tbody.find("> tr").eq(t):t||e.$tbody.find("> tr."+e.classnames.tr_edit);t.length||e.$grid.alertmsg("info",BJUI.getRegional("datagrid.saveMsg")),1==t.length?t.hasClass(e.classnames.tr_edit)&&this.updateEdit(t):a.saveAll?e.saveAll(t):t.each(function(){e.updateEdit(C(this))})},c.prototype.delRows=function(t){var e,a,i,n,o,s=this,l=s.options,r=l.beforeDelete,d=l.delConfirm;r&&("string"==typeof r&&(r=r.toFunc()),"function"==typeof r&&!r.call(this))||("object"==typeof t?e=t:isNaN(t)?(a=s.$tbody.find("> tr"),(t=(t=t.split(",")).unique()).sort(function(t,e){return t.trim()-e.trim()}),C.each(t,function(t,e){e=a.eq(parseInt(e.trim()));e&&e.length&&(i=i?i.add(e):e)}),e=i):isNaN(t)||(e=this.$tbody.find("> tr").eq(t)),e&&e.length&&(n=function(){e.each(function(){C(this).trigger("bjui.datagrid.tr.delete")}),s.tools.afterDelete()},o=function(){var i,t=e.filter("."+s.classnames.tr_add);t.length&&(t.remove(),t.length==e.length)||(l.delUrl?(i=[],t=l.delCallback,e.each(function(){var a,t=C(this),e=t.index(),e=s.isDom?t.data("initData")||tools.setDomData(t):s.data[e];l.delPK?i.push(e[l.delPK]):(l.jsonPrefix?(a={},C.each(e,function(t,e){return"gridCheckbox"==t||"gridEdit"==t||void(a[l.jsonPrefix+"."+t]=e)})):(delete(a=C.extend({},e)).gridCheckbox,delete a.gridEdit),i.push(a))}),"string"==typeof t&&(t=t.toFunc()),s.$grid.bjuiajax("doAjax",{url:l.delUrl,data:l.delPK?[{name:l.delPK,value:i.join(",")}]:{json:JSON.stringify(i)},type:l.delType,callback:t||function(t){t[BJUI.keys.statusCode]==BJUI.statusCode.ok?n():s.$grid.bjuiajax("ajaxDone",t)}})):n())},d?("string"!=typeof d&&(d=1==e.length?BJUI.getRegional("datagrid.delMsg"):BJUI.getRegional("datagrid.delMsgM")),s.$grid.alertmsg("confirm",d,{okCall:function(){o()}})):o()))},c.prototype.inlineEdit=function(l,o,r){if(!this.tools.beforeEdit(l,r))return!1;var d=this,t=d.options,e=d.tools,c=d.columnModel,a=l.find("> td"),u=a.length,h=l.index();if(r=r||(d.isDom?l.data("initData")||e.setDomData(l):d.data[h]),l.hasClass(d.classnames.tr_edit))return!1;d.inputs&&d.inputs.length||e.initEditInputs(),l.addClass(d.classnames.tr_edit).data(d.datanames.changeData,{}),l.data("validator")&&l.validator("destroy"),t.inlineEditMult||d.doCancelEditRow(l.siblings("."+d.classnames.tr_edit)),d.$lastEditTr=l,a.each(function(t){var a,e=C(this),s=c[t],i=s&&s.name&&r[s.name],n=e.html(),t=d.inputs[t];e.data(d.datanames.td_html,n),o?s.add||(t=""):s.edit||(t=""),t&&(a=C(t),"boolean"==s.type?a.prop("checked",i):(i&&"null"!=i||(i=""),a.val(String(i))),o?s.addAttrs&&"object"==typeof s.addAttrs&&C.each(s.addAttrs,function(t,e){a.attr(t,e)}):s.editAttrs&&"object"==typeof s.editAttrs&&C.each(s.editAttrs,function(t,e){a.attr(t,e)}),e.empty().append(a).addClass(d.classnames.td_edit),function(i,n,a){var o=l.data(d.datanames.changeData);switch(s.type){case"date":i.on("afterchange.bjui.datepicker",function(t,e){n.addClass(d.classnames.td_changed),i.val()==a&&n.removeClass(d.classnames.td_changed),o[s.name]=i.val()}).change(function(){n.addClass(d.classnames.td_changed),i.val()==a&&n.removeClass(d.classnames.td_changed),o[s.name]=i.val()});break;case"select":i.change(function(){n.addClass(d.classnames.td_changed),i.val()==String(a)&&n.removeClass(d.classnames.td_changed),o[s.name]=i.val()});break;case"boolean":i.on("ifChanged",function(){n.toggleClass(d.classnames.td_changed);var t=!!C(this).is(":checked");t==a&&n.removeClass(d.classnames.td_changed),o[s.name]=t});break;case"lookup":n.on("customEvent.bjui.lookup",'[data-toggle="lookupbtn"]',function(t,e){for(var a in n.toggleClass(d.classnames.td_changed),e)void 0!==r[a]&&(o[a]=e[a]),s.name==a&&(i.val()==e[a]?n.removeClass(d.classnames.td_changed):i.val(e[a]))}),i.change(function(){n.addClass(d.classnames.td_changed),i.val()==a&&n.removeClass(d.classnames.td_changed),o[s.name]=i.val()});break;case"spinner":i.on("afterchange.bjui.spinner",function(t,e){n.addClass(d.classnames.td_changed),i.val()==a&&n.removeClass(d.classnames.td_changed),o[s.name]=i.val()}).change(function(){n.addClass(d.classnames.td_changed),i.val()==a&&n.removeClass(d.classnames.td_changed),o[s.name]=i.val()});break;default:i.change(function(){n.addClass(d.classnames.td_changed),i.val()==a&&n.removeClass(d.classnames.td_changed),o[s.name]=i.val()})}}(a,e,i),s.locked&&(i=d.$lockTbody.find("tr:eq("+h+")").find("> td:eq("+s.lockIndex+")"),e.clone().html(n).insertAfter(e),e.show().insertAfter(i).initui(),i.remove())),--u||l.initui().validator({msgClass:"n-bottom",theme:"red_bottom_effect_grid"})})},c.prototype.saveAll=function(a){var e,i,n,o,s=this,l=s.options,t=l.editCallback,r=[],d=a&&a.length;a&&!a.length||(a=s.$tbody.find("> tr."+s.classnames.tr_edit),d=a.length),a.each(function(){e=C(this),i=s.isDom?e.data("initData"):s.data[e.index()],e.isValid(function(t){return t?(n=e.data(s.datanames.changeData),C.extend(i,n),l.jsonPrefix?(o={},C.each(i,function(t,e){return"gridCheckbox"==t||"gridEdit"==t||void(o[l.jsonPrefix+"."+t]=e)})):(delete(o=C.extend({},i)).gridCheckbox,delete o.gridEdit),d--,void r.push(o)):!(r=[])})}),d||(t=t?t.toFunc():function(t){var e=!1,i=[];"array"==C.type(t)?(e=!0,i=t):"object"==C.type(t)&&(t[BJUI.keys.statusCode]?t[BJUI.keys.statusCode]==BJUI.statusCode.ok?e=!0:s.$grid.bjuiajax("ajaxDone",t):(e=!0,i.push(t))),e&&(a.each(function(t){var e=C(this),a=s.isDom?e.data("initData"):s.data[e.index()];C.extend(a,"object"==typeof i[t]&&i[t]),s.inlineEditComplete(e,a)}),s.tools.afterSave(a,r))},s.$grid.bjuiajax("doAjax",{url:l.editUrl,data:{json:JSON.stringify(r)},type:"POST",callback:t}))},c.prototype.updateEdit=function(i,n){var e,a,o=this,s=o.options,l=s.editCallback,r=[],d=o.isDom?i.data("initData"):o.data[i.index()];i.hasClass(o.classnames.tr_edit)&&i.isValid(function(t){t&&(e=i.data(o.datanames.changeData),C.extend(d,e),s.jsonPrefix?(a={},C.each(d,function(t,e){return"gridCheckbox"==t||"gridEdit"==t||void(a[s.jsonPrefix+"."+t]=e)})):(delete(a=C.extend({},d)).gridCheckbox,delete a.gridEdit),l=l?l.toFunc():function(t){var e,a=!1;"array"==C.type(t)?(a=!0,e=t[0]):"object"==C.type(t)&&(t[BJUI.keys.statusCode]?t[BJUI.keys.statusCode]==BJUI.statusCode.ok?a=!0:o.$grid.bjuiajax("ajaxDone",t):(a=!0,e=t)),a&&(C.extend(d,"object"==typeof e&&e),o.inlineEditComplete(i,d,n),o.tools.afterSave(i,d))},i.bjuiajax("doAjax",{url:s.editUrl,data:{json:JSON.stringify(r.push(a)&&r)},type:"POST",callback:l}))})},c.prototype.cancelEdit=function(t){var o=this,s=o.columnModel;t.each(function(){var t=C(this),i=t.index();if(t.hasClass(o.classnames.tr_edit)&&t.removeClass(o.classnames.tr_edit).find("> td."+o.classnames.td_edit).each(function(){var t=C(this),e=t.index(),a=s[e],e=t.data(o.datanames.td_html);t.removeClass(o.classnames.td_edit).removeClass(o.classnames.td_changed).html(e),a.locked&&(e=(a=(t=o.$lockTbody.find("tr:eq("+i+")")).find("> td:eq("+a.lockIndex+")")).data(o.datanames.td_html),t.removeClass(o.classnames.tr_edit),a.removeClass(o.classnames.td_edit).removeClass(o.classnames.td_changed).html(e))}),t.hasClass(o.classnames.tr_add)){var e=!1,a=t.data(o.datanames.changeData);if(C.isEmptyObject(a))e=!0;else{for(var n in a)a[n]||delete a[n];C.isEmptyObject(a)&&(e=!0)}e&&(e=t.index(),o.data=o.data.remove(e),o.$lockTbody&&o.$lockTbody.find("> tr:eq("+e+")").remove(),t.remove())}})},c.prototype.inlineEditComplete=function(t,o,e){var s=this,a=s.columnModel,l=t.index(),r=t.find("> td"),d=!1,i=s.$tbody.find("> tr"),n=i.filter("."+s.classnames.tr_add);C.each(a,function(t,e){var a,i,n;e.gridNumber&&(d=!0),e.name&&(e.gridNumber||e.gridCheckbox||e.gridEdit||(void 0===(a=o[e.name])&&(a=""),(n=r.eq(e.index)).text(a).removeClass(s.classnames.td_edit).removeClass(s.classnames.td_changed),e.render&&"function"==typeof e.render?(i=e.items?e.render.call(s,a,e.items):e.render.call(s,a),n.html(i)):e.items&&(i=c.renderItem.call(s,a,e.items),n.html(i)),e.locked&&s.$lockTbody.find("> tr:eq("+l+")").find("> td:eq("+e.lockIndex+")").removeClass(s.classnames.td_changed).html(n.html())))}),t.removeClass(s.classnames.tr_edit),(e=e||r.filter("."+s.classnames.s_edit).find("button.update"))&&e.length&&e.trigger("bjui.datagrid.update.tr"),d&&n.length&&(n.removeClass(s.classnames.tr_add),i.each(function(t){C(this).find("> td."+s.classnames.td_linenumber).text(t+1),s.$lockTbody&&s.$lockTbody.find("> tr:eq("+t+")").find("> td."+s.classnames.td_linenumber).text(t+1)}))},c.prototype.dialogEdit=function(s,t,l){if(!this.tools.beforeEdit(s,l))return!1;var r=this,d=r.options,c=r.tools,u=r.columnModel,e=s.index();l=l||(r.isDom?s.data("initData")||c.setDomData(s):r.data[e]),r.inputs&&r.inputs.length||c.initEditInputs(),a=d.gridTitle||"datagrid",a+=t?" - "+BJUI.getRegional("datagrid.add"):" - "+BJUI.getRegional("datagrid.edit"),e=C('<div><div class="bjui-pageContent"></div><div class="bjui-pageFooter"></div></div>'),t=C('<form class="datagrid-dialog-edit-form"></form>');e.find("> div:first").append(t).next().append(BJUI.doRegional(FRAG.gridDialogEditBtns,r.regional));var a=C.extend({},{id:"datagrid-dialog-edit",fresh:!0,target:e[0],width:520,height:400,mask:!0,title:a,onLoad:function(t){function a(n,o,s){o.empty(),s.data(r.datanames.changeData)||s.data(r.datanames.changeData,{}),o.data("validator")&&o.validator("destroy"),C.each(u,function(t,e){if(e==r.linenumberColumn||e==r.checkboxColumn||e==r.editBtnsColumn)return!0;var a=C(r.inputs[t]),i=C("<p></p>"),t="datagrid-dialog-edit-column-"+t;a.isTag("select")?a.attr("data-width","auto"):a.isTag("checkbox")||a.attr("size",30),"boolean"==e.type?a.attr("checked",n[e.name]):"textarea"==e.type?a.html(n[e.name]):a.attr("value",n[e.name]),i.append('<label class="control-label x120" for="'+t+'">'+e.label+"：</label>").append(C('<span class="datagrid-dialog-column-span"></span>').append(a.attr("id",t))).appendTo(o),function(t,i,n){var o=s.data(r.datanames.changeData);switch(n.type){case"date":i.on("afterchange.bjui.datepicker",function(t,e){o[n.name]=i.val()}).change(function(){o[n.name]=i.val()});break;case"select":i.change(function(){o[n.name]=i.val()});break;case"boolean":i.on("ifChanged",function(){var t=!!C(this).is(":checked");o[n.name]=t});break;case"lookup":t.on("customEvent.bjui.lookup",'[data-toggle="lookupbtn"]',function(t,e){for(var a in e)void 0!==l[a]&&(o[a]=e[a]),n.name==a&&i.val(e[a])}),i.change(function(){o[n.name]=i.val()});break;case"spinner":i.on("afterchange.bjui.spinner",function(t,e){o[n.name]=i.val()}).change(function(){o[n.name]=i.val()});break;default:i.change(function(){o[n.name]=i.val()})}}(o,a,e)}),o.initui().validator({msgClass:"n-bottom",theme:"red_bottom_effect_grid"})}var o=t.find("form.datagrid-dialog-edit-form"),e=t.find("div.bjui-pageFooter button"),i=e.first(),n=e.eq(1),t=e.eq(2),e=e.last();o.is(":empty")&&a(l,o,s),0==s.index()&&i.addClass("disabled"),s.index()==r.data.length-1&&n.addClass("disabled"),i.click(function(){var t,e=s.prev();e.length?(t=r.isDom?e.data("initData")||c.setDomData(e):r.data[e.index()],a(t,o,s=e),n.removeClass("disabled"),e.prev().length||i.addClass("disabled")):i.addClass("disabled")}),n.click(function(){var t,e=s.next();e.length?(t=r.isDom?e.data("initData")||c.setDomData(e):r.data[e.index()],a(t,o,s=e),o.initui(),i.removeClass("disabled"),e.next().length||n.addClass("disabled")):n.addClass("disabled")}),e.click(function(){var e,a,i=d.editCallback,n=r.isDom?s.data("initData"):r.data[s.index()];o.isValid(function(t){t&&(e=s.data(r.datanames.changeData),C.extend(n,e),d.jsonPrefix?(a={},C.each(n,function(t,e){return"gridCheckbox"==t||"gridEdit"==t||void(a[d.jsonPrefix+"."+t]=e)})):(delete(a=C.extend({},n)).gridCheckbox,delete a.gridEdit),i=i?i.toFunc():function(t){var e,a=!1;"array"==C.type(t)?(a=!0,e=t[0]):"object"==C.type(t)&&(t[BJUI.keys.statusCode]?t[BJUI.keys.statusCode]==BJUI.statusCode.ok?a=!0:r.$grid.bjuiajax("ajaxDone",t):(a=!0,e=t)),a&&(C.extend(n,"object"==typeof e&&e),r.dialogEditComplete(s,n),r.$grid.dialog("close","datagrid-dialog-edit"),r.tools.afterSave(s,n))},s.bjuiajax("doAjax",{url:d.editUrl,data:{json:JSON.stringify(a)},type:"POST",callback:i}))})}),t.click(function(){r.$grid.dialog("close","datagrid-dialog-edit")})},onClose:function(){r.$tbody.find("> tr."+r.classnames.tr_add).each(function(){var t=!1,e=C(this),a=e.data(r.datanames.changeData);if(C.isEmptyObject(a))t=!0;else{for(var i in a)a[i]||delete a[i];C.isEmptyObject(a)&&(t=!0)}t&&(t=e.index(),r.data=r.data.remove(t),r.$lockTbody&&r.$lockTbody.find("> tr:eq("+t+")").remove(),e.remove())})}},"object"==typeof d.editDialogOp&&d.editDialogOp);r.$grid.dialog(a)},c.prototype.dialogEditComplete=function(t,o){var s=this,e=s.columnModel,l=t.index(),r=t.find("> td"),d=!1,a=s.$tbody.find("> tr"),t=a.filter("."+s.classnames.tr_add);C.each(e,function(t,e){var a,i,n;e.gridNumber&&(d=!0),e.name&&(e.gridNumber||e.gridCheckbox||e.gridEdit||(void 0===(a=o[e.name])&&(a=""),(i=r.eq(e.index)).text(a).removeClass(s.classnames.td_edit).removeClass(s.classnames.td_changed),e.render&&"function"==typeof e.render?(n=e.items?e.render.call(s,a,e.items):e.render.call(s,a),i.html(n)):e.items&&(n=c.renderItem.call(s,a,e.items),i.html(n)),e.locked&&((n=s.$lockTbody.find("> tr:eq("+l+")")).find("> td:eq("+e.lockIndex+")").removeClass(s.classnames.td_edit).removeClass(s.classnames.td_changed).html(i.html()),n.removeClass(s.classnames.tr_edit))))}),d&&t.length&&(t.removeClass(s.classnames.tr_add),a.each(function(t){C(this).find("> td."+s.classnames.td_linenumber).text(t+1),s.$lockTbody&&s.$lockTbody.find("> tr:eq("+t+")").find("> td."+s.classnames.td_linenumber).text(t+1)}))},c.prototype.resizeGrid=function(){var t,e=this,a=e.$grid.getPageTarget();a.on("bjui.navtab.switch",C.proxy(function(){e.$grid.data("need.fixedH")&&((t=e.$grid.parent().height())&&e.tools.fixedH(t),e.$grid.removeData("need.fixedH")),e.$grid.data("need.fixedW")&&(e.fixedWidth(),e.$grid.removeData("need.fixedW"))},e)),C(window).on(BJUI.eventType.resizeGrid,C.proxy(function(){e.initFixedW&&String(e.options.width).endsWith("%")&&(e.$grid.parent().width(),a.is(":hidden")&&a.hasClass("navtabPage")?e.$grid.data("need.fixedW",!0):e.fixedWidth()),String(e.options.height).endsWith("%")&&(t=e.$grid.parent().height(),a.is(":hidden")&&a.hasClass("navtabPage")?a.hasClass("navtabPage")&&e.$grid.data("need.fixedH",!0):t&&t!=e.parentH&&e.tools.fixedH(t))},e))};var t=C.fn.datagrid;C.fn.datagrid=e,C.datagrid=c,C.fn.datagrid.noConflict=function(){return C.fn.datagrid=t,this},C(document).on(BJUI.eventType.initUI,function(t){t=C(t.target).find('table[data-toggle="datagrid"]');t.length&&e.call(t)})}(jQuery),function(p){"use strict";function f(t,e){this.$element=p(t),this.options=e,this.tools=this.TOOLS()}function e(i){var n=arguments,o=i;return this.each(function(){var t=p(this),e=p.extend({},f.DEFAULTS,t.data(),"object"==typeof i&&i),a=t.data("bjui.tablefixed");a||t.data("bjui.tablefixed",a=new f(this,e)),"string"==typeof o&&p.isFunction(a[o])?([].shift.apply(n),n?a[o].apply(a,n):a[o]()):a.init()})}f.SCROLLW=18,f.DEFAULTS={width:"100%"},f.prototype.TOOLS=function(){return{getLeft:function(t){var e=0;return t.prevAll().each(function(){e+=p(this).outerWidth()}),e},getRight:function(t){var e=0;return t.prevAll().andSelf().each(function(){e+=p(this).outerWidth()}),e-1},getCellNum:function(t){return t.prevAll().andSelf().size()},getColspan:function(t){return t.attr("colspan")||1},getStart:function(t){var e=1;return t.prevAll().each(function(){e+=parseInt(p(this).attr("colspan")||1)}),e},getPageCoord:function(t){for(var e={x:0,y:0};t;)e.x+=t.offsetLeft,e.y+=t.offsetTop,t=t.offsetParent;return e},getOffset:function(t,e){if(!p.support.leadingWhitespace){var a=t.offset(),t=e.pageX||e.screenX,i=e.pageY||e.screenY;return{offsetX:t-a.left,offsetY:i-a.top}}i=e.target;void 0===i.offsetLeft&&(i=i.parentNode);a=this.getPageCoord(i),i=window.pageXOffset+e.clientX,e=window.pageYOffset+e.clientY;return{offsetX:i-a.x,offsetY:e-a.y}}}},f.prototype.resetWidth=function(){var a,t=this.$element,e=t.width(),i=t.find("table"),n=i&&i.width(),t=i.eq(0)&&i.eq(0).find("tr:first-child > th"),o=i.eq(1)&&i.eq(1).find("tr:first-child > td");i&&e-n<f.SCROLLW&&(a=parseInt((e-n)/t.length),i.width(e-f.SCROLLW),t.each(function(t){var e=parseInt(p(this).css("width"));p(this).width(e+a),o.eq(t)&&o.eq(t).width(e+a)}))},f.prototype.init=function(){var t,e;this.$element.isTag("table")&&(this.$container=this.$element.parent().addClass("bjui-resizeGrid"),this.$fixed=void 0,t=this.$container.width(),e=this.options.height,this.$container.hasClass("tab-pane")&&(t=this.$container.parent().width()-20),"string"==typeof this.options.width&&this.options.width.indexOf("%")?this.options.newWidth=t*(this.options.width.replace("%","")/100):this.options.newWidth=parseInt(this.options.width),this.options.styles=[],this.$element.wrap('<div class="bjui-tablefixed clearfix"></div>'),this.$fixed=this.$element.parent(),this.initHead(),this.initBody(),this.resizeCol(),this.resizeGrid(),e&&!this.$fixed.closest(".tab-content").length&&this.$fixed.height(e).addClass("fixedH"))},f.prototype.initHead=function(){var i=this.options.styles=[],t=this.$element.find("thead > tr"),d=t.eq(0).find("> th"),n=0,l=[],r=[],c=-1;d.each(function(t){for(var e=p(this),a=parseInt(e.attr("colspan")||1),i=e.attr("width"),n=e.attr("align"),o="",s=0;s<a;s++)1===a&&i&&(o=' width="'+i+'"'),n&&e.removeAttr("align").addClass(n),l.push("<th"+o+"></th>");e.attr("colsNum",c+=a),r[t]=a});var u,e=l.length,h=p('<tr class="resize-head">'+l.join("")+"</tr>");1<t.length&&(c=0,u=t.eq(1).find("> th"),p.each(r,function(t,e){if(1<(e=parseInt(e)))for(var a=parseInt(d.eq(t).attr("colsnum")),i=e-1;0<=i;i--){var n=u.eq(c++),o=a-i,s=n.attr("width"),l=n.attr("align"),r=h.find("> th").eq(o);n&&n.length&&n.attr("colsnum",o),s&&r.attr("width",s),l&&n.addClass(l).removeAttr("align")}})),this.$fixed.html(this.$element.html());t=this.$fixed.find("thead");t.prepend(h),h.find("> th").each(function(t){var e=[],a=p(this).innerWidth();e[0]=parseInt(a),n+=e[0],i[i.length]=e}),n=parseInt((this.options.newWidth-f.SCROLLW-n)/e);e=t.find("> tr:eq(0) > th");(this.options.$ths=e).each(function(t){var e=p(this),a=i[t],t=e.attr("width");e.removeAttr("align").width(a[0]+n),a[0]=a[0]+n,t&&(a[0]=parseInt(t),e.width(t).removeAttr("width"))}),t.find("> tr:gt(0) > th").each(function(){var t=p(this);t.html('<div class="fixedtableCol">'+t.html()+"</div>")}),t.wrap('<div class="fixedtableHeader" style="width:'+(this.options.newWidth-f.SCROLLW)+'px;overflow:hidden;"><div class="fixedtableThead"><table class="table table-bordered" style="width:'+(this.options.newWidth-f.SCROLLW)+"px; max-width:"+(this.options.newWidth-f.SCROLLW)+'px;"></table></div></div>'),this.$fixed.append('<div class="resizeMarker" style="display:none; height:300px; left:57px;"></div><div class="resizeProxy" style="left:377px; display:none; height:300px;"></div>')},f.prototype.initBody=function(){var t,a=this,e=this.$fixed.find("> tbody");this.options.height?t=this.options.height-this.$fixed.find(".fixedtableHeader").height()+"px":(t="100%",p(document).one(BJUI.eventType.afterInitUI,function(t){var e;e=a.$fixed.parent().height(),a.$fixed.parent().css("overflow","hidden"),a.$fixed.height(e).find(".fixedtableScroller").height(e-a.$fixed.find(".fixedtableHeader").height())})),t='style="height:'+t+'; overflow-y:auto;"',e.wrap('<div class="fixedtableScroller"'+t+' style="width:'+this.options.newWidth+'px;"><div class="fixedtableTbody"><table style="width:'+(this.options.newWidth-f.SCROLLW)+"px; max-width:"+(this.options.newWidth-f.SCROLLW)+'px;"></table></div></div>'),this.$element.attr("class")?e.parent().addClass(this.$element.attr("class")):e.parent().addClass("table table-striped table-bordered table-hover"),void 0!==this.$element.attr("data-selected-multi")&&e.parent().attr("data-selected-multi",this.$element.attr("data-selected-multi")),e.before('<thead><tr class="resize-head">'+this.$fixed.find("thead > tr").html()+"</tr></thead>"),this.options.$tds=e.prev().find("> tr:first-child > th"),this.options.nowrap&&e.parent().addClass("nowrap"),e.closest(".fixedtableScroller").scroll(function(t){var e=p(this),a=e.scrollLeft();return e.prev().find("> .fixedtableThead").css({position:"relative",left:-a}),!1})},f.prototype.resizeCol=function(){var o=this,s=this.$fixed,i=this.options.$ths,l=this.options.$tds,r=this.tools;s.find("thead > tr:gt(0) > th").each(function(t){var a=p(this);a.mouseover(function(t){var e=parseInt(s.find(".fixedtableThead").css("left"))||0,t=r.getOffset(a,t).offsetX,n=i.eq(a.attr("colsnum"));return a.outerWidth()-t<5?a.css("cursor","col-resize").off("mousedown.bjui.tablefixed.resize").on("mousedown.bjui.tablefixed.resize",function(t){s.find("> .resizeProxy").show().css({left:r.getRight(n)+e+s.position().left,top:s.position().top,height:s.height(),cursor:"col-resize"}).basedrag({scop:!0,cellMinW:20,relObj:s.find(".resizeMarker"),move:"horizontal",event:t,stop:function(){var t=s.find(".resizeProxy").position().left-s.find(".resizeMarker").position().left-n.outerWidth()-9,e=r.getCellNum(n),a=n.width()+t,i=l.eq(e-1),e=s.find("> .fixedtableHeader .table").width();n.width(a),i.width(a),s.find(".table").width(e+t),s.find(".resizeMarker, .resizeProxy").hide(),e+t+f.SCROLLW<o.options.newWidth?s.find(".fixedtableScroller").width(e+t+f.SCROLLW):(a=s.closest(".bjui-resizeGrid").innerWidth(),e+t+f.SCROLLW<a&&(a=e+t+f.SCROLLW),s.find(".fixedtableHeader").width(a-f.SCROLLW),s.find(".fixedtableScroller").width(a),s.width(a)),s.data("resizeGrid",!0)}}),s.find("> .resizeMarker").show().css({left:r.getLeft(n)+e+s.position().left,top:s.position().top,height:s.height()})}):a.css("cursor","default").off("mousedown.bjui.tablefixed.resize"),!1})})},f.prototype.setOrderBy=function(t){var e=this.$element,a=e.find(".fixedtableCol"),i=p(FRAG.orderby.replace("#asc#",BJUI.regional.orderby.asc).replace("#desc#",BJUI.regional.orderby.desc));t=t||this.options,e.addClass("orderby"),t.orderDirection&&(BJUI.ui.clientPaging||e.addClass(t.orderDirection),e.pagination("setClientOrder",{orderField:t.orderField,orderDirection:t.orderDirection})),a.length||(a=p('<div class="fixedtableCol">'+e.html()+"</div>").appendTo(e.empty())),i.data("orderField",t.orderField).appendTo(a).pagination("orderBy")},f.prototype.resizeGrid=function(){p(window).on(BJUI.eventType.resizeGrid,function(){p("div.bjui-resizeGrid").each(function(){var a,t=p(this),e=t.closest(".navtabPage"),i=t.width(),n=t.height(),o=t.find(".bjui-tablefixed"),s=o.find(".fixedtableThead").height();t.length&&t.is(":hidden")&&(t.hasClass("tab-pane")||(e.show(),i=t.innerWidth(),n=t.height(),s=o.find(".fixedtableHeader").height(),e.hide())),i&&t.find(".bjui-tablefixed").each(function(){var t=p(this);a=i,t.width(a);var e=a-f.SCROLLW;t.find(".table").css({width:e,maxWidth:e}),t.find(".fixedtableHeader").width(e),t.find(".fixedtableScroller").width(a)}),t.css("overflow","hidden"),o.height(n).find(".fixedtableScroller").height(n-s)})})};var t=p.fn.tablefixed;p.fn.tablefixed=e,p.fn.tablefixed.Constructor=f,p.fn.tablefixed.noConflict=function(){return p.fn.tablefixed=t,this},p(document).on(BJUI.eventType.initUI,function(t){t=p(t.target).find('table[data-toggle="tablefixed"]');t.length&&e.call(t)}),p(document).on(BJUI.eventType.afterInitUI,function(t){t=p(t.target).find("th[data-order-field]");t.length&&e.call(t,"setOrderBy")}),p(document).on("click.bjui.tr.data-api","tr[data-id]",function(t){var e=p(this),a=e.closest("table"),i=a.data("selectedMulti"),n=e.attr("data-id"),o="selected",s=a.closest(".unitBox").find("#bjui-selected");e.toggleClass(o),i?(n=[],e.siblings("."+o).add(e.hasClass(o)?e:"").each(function(){n.push(p(this).attr("data-id"))}),n=n.join(",")):(e.siblings().removeClass(o),e.hasClass(o)||(n="")),s&&s.length?s.val(n):(s=p('<input type="hidden" id="bjui-selected" value="'+n+'">')).appendTo(a.closest(".unitBox"))})}(jQuery),function(c){"use strict";function s(t,e){this.$element=c(t),this.options=e,this.tools=this.TOOLS(),this.$tbody=this.$element.find("> tbody"),this.$tbody.length||(this.$tbody=c("<tbody></tbody>"),this.$element.append(this.$tbody)),this.$numAdd=this.$btnAdd=null}function n(i){var n=arguments,o=i;return this.each(function(){var t=c(this),e=c.extend({},s.DEFAULTS,t.data(),"object"==typeof i&&i),a=t.data("bjui.tabledit");a||t.data("bjui.tabledit",a=new s(this,e)),"string"==typeof o&&c.isFunction(a[o])?([].shift.apply(n),n?a[o].apply(a,n):a[o]()):a.init()})}s.DEFAULTS={singleNoindex:!0},s.EVENTS={afterDelete:"afterdelete.bjui.tabledit"},s.prototype.TOOLS=function(){var r=this;return{initSuffix:function(t){t.find("> tr").each(function(d){c(this).find(":input, :file, a, label, div").each(function(){var t=c(this),e=t.attr("name"),a=t.val(),i=t.attr("for"),n=t.attr("id"),o=t.attr("href"),s=t.attr("data-group"),l=t.attr("data-suffix"),r=t.attr("data-arrayfix");e&&t.attr("name",e.replaceSuffix(d)),i&&t.attr("for",i.replaceSuffix(d)),n&&t.attr("id",n.replaceSuffix(d).replaceSuffix2(d)),o&&t.attr("href",o.replaceSuffix(d)),s&&t.attr("data-group",s.replaceSuffix(d)),l&&t.attr("data-suffix",l.replaceSuffix(d)),r&&t.attr("data-arrayfix",r.replaceSuffix(d)),a&&0<=a.indexOf("#index#")&&t.val(a.replace("#index#",d+1)),t.hasClass("no")&&(a=t.data("prefix")?t.data("prefix"):"",t.val(a+(d+1)))})})},initEnter:function(t){var i=t.find(":text");i.each(function(a){c(this).bind("keydown",function(t){var e;t.which===BJUI.keyCode.ENTER&&(e=a+1,i.eq(e)&&i.eq(e).focus(),t.preventDefault())})}),this.initInput(t)},initInput:function(t){t.find("> tr > td").each(function(){var e=c(this).find(".input-hold");e.length||(e=c('<span class="input-hold" style="display:block; padding:0 4px; height:0; font-size:12px; visibility: hidden;"></span>'),c(this).append(e)),c.support.leadingWhitespace?c(this).on("input",":text",function(t){e.text(c(this).val())}):c(this).on("propertychange",":text",function(t){e.text(c(this).val())})})},initTbody:function(){var s=r.$element,a=r.$tbody;function i(t){t.removeClass("readonly").find("> td *").each(function(){var t=c(this),e=t.closest("td"),a=e.data("val"),i=t.attr("data-toggle-old"),n=e.data("readonly");if(void 0===a&&e.html(),e.data("notread"))return!0;if(t.isTag("select")&&(e.find(".tabledit-select-text").first().hide(),t.val(e.attr("data-val")),t.removeClass("readonly disabled").selectpicker("show")),t.is(":checkbox")&&(t.closest(".icheckbox_minimal-purple").removeClass("disabled"),t.closest(".icheckbox_minimal-purple").find("ins").removeClass("readonly")),t.is(":radio")&&(t.closest(".iradio_minimal-purple").removeClass("disabled"),t.closest(".iradio_minimal-purple").find("ins").removeClass("readonly")),i){if("dosave"===i)return!0;t.removeAttr("data-toggle-old").attr("data-toggle",i),"spinner"===i&&t.spinner("destroy").spinner(),"kindeditor"===i&&e.initui()}(t.is(":text")||t.is("textarea"))&&(t.off("keydown.readonly"),n&&t.prop("readonly",!0))}),t.find(".bjui-lookup, .bjui-spinner, .bjui-upload").show(),t.find('[data-toggle="doedit"]').attr("data-toggle","dosave").text("完成")}function l(t){t.addClass("readonly").find("> td *").each(function(){var t,e,a=c(this),i=a.closest("td"),n=a.attr("data-toggle");if(i.data("notread"))return!0;if(a.isTag("select")&&(a.addClass("readonly disabled").selectpicker("hide"),t=a.children("option").filter(":selected").text(),(e=i.find(".tabledit-select-text").first()).length?e.text(t).show():i.append('<span style="padding: 0 2px" class="tabledit-select-text">'+t+"</span>")),a.is(":checkbox")&&(a.closest(".icheckbox_minimal-purple").addClass("disabled"),a.closest(".icheckbox_minimal-purple").find("ins").addClass("readonly")),a.is(":radio")&&(a.closest(".iradio_minimal-purple").addClass("disabled"),a.closest(".iradio_minimal-purple").find("ins").addClass("readonly")),n){if("doedit"===n||"dosave"===n)return!0;a.removeAttr("data-toggle").attr("data-toggle-old",n),"kindeditor"===n&&KindEditor.remove(a)}(a.is(":text")||a.is("textarea"))&&a.on("keydown.readonly",function(t){t.preventDefault()})}),t.find(".bjui-lookup, .bjui-spinner, .bjui-upload").hide(),t.find('[data-toggle="dosave"]').attr("data-toggle","doedit").text("编辑")}a.find("> tr").each(function(){var e=c(this),o=e.find("> td"),t=s.data("bjui.tabledit.tr").clone().find("> th");e.data("bjui.tabledit.oldTds",e.html()),t.each(function(t){var e=o.eq(t),a=e.data("val"),i=c(this),n=i.children(),t=i.find(".pic-box");void 0===a&&(a=e.html()),e.data("noedit")||n.length&&(n.is("input:checkbox")||n.is("input:radio")?n.filter('[value="'+a+'"]').attr("checked","checked"):n.isTag("select")?n.find('option[value="'+e.data("val")+'"]').attr("selected","selected"):t.length?(e.data("val")&&i.find(".pic-name").val(e.data("val")),t.html(e.html())):n.hasClass("wrap_bjui_btn_box")?n.find("input[data-toggle]").attr("value",a+""):n.is("textarea")?(n.html(a),"kindeditor"===n.attr("data-toggle")&&n.attr("data-toggle-old","kindeditor").removeAttr("data-toggle")):n.attr("value",a+""),e.html(i.html()))}),e.on("dblclick",c.proxy(function(t){i(e)},r)).initui(),r.tools.initSuffix(a),l(e)}),a.on("click.bjui.tabledit.readonly",'[data-toggle="doedit"]',function(t){i(c(this).closest("tr"))}).on("click.bjui.tabledit.readonly",'[data-toggle="dosave"]',function(t){var e,a,i=c(this).closest("tr"),n=i.index(),o=r.options.callback;r.options.action?(i.wrap('<form action="" method="POST"></form>'),i.attr("data-id")&&(e=s.find("> thead > tr:eq(0)").data("idname")||"id",i.before('<input type="hidden" name="'+e.replaceSuffix(n)+'" value="'+i.attr("data-id")+'">')),a=i.parent().serializeArray(),r.options.singleNoindex&&c.each(a,function(t,e){c.extend(e,{name:e.name.replaceSuffix(0)})}),i.prev("input").remove(),i.unwrap().isValid(function(t){t&&(o=o?o.toFunc():function(t){t[BJUI.keys.statusCode]===BJUI.statusCode.ok?l(i):i.bjuiajax("ajaxDone",t)},i.bjuiajax("doAjax",{url:r.options.action,data:a,type:r.options.type||"POST",callback:o}))})):l(i)}),r.tools.initEnter(a)},doAdd:function(){var a=r.$element;r.$numAdd&&r.$btnAdd&&a.on("keydown.bjui.tabledit.add","thead .num-add",function(t){t.which===BJUI.keyCode.ENTER&&(r.$btnAdd.trigger("click.bjui.tabledit.add"),t.preventDefault())}).on("click.bjui.tabledit.add","thead .row-add",function(t){var e=1;isNaN(r.$numAdd.val())||(e=parseInt(r.$numAdd.val())),r.add(a,e),t.preventDefault()})},doDel:function(t){var a=this,e="click.bjui.tabledit.del";t.off(e).on(e,".row-del",function(t){var e=c(this);e.data("confirmMsg")?e.alertmsg("confirm",e.data("confirmMsg"),{okCall:function(){a.delData(e)}}):a.delData(e),t.preventDefault()})},delData:function(e){function t(t){e.closest("tr").remove(),a.initSuffix(i),a.afterDelete(i),n.callback&&n.callback.toFunc().apply(r,[t])}var a=this,i=e.closest("tbody"),n=e.data();e.is("[href^=javascript:]")||e.is('[href^="#"]')?t():e.bjuiajax("doAjax",{url:e.attr("href"),data:n.data,callback:t})},afterDelete:function(t){t=c.Event(s.EVENTS.afterDelete,{relatedTarget:t[0]});r.$element.trigger(t)}}},s.prototype.init=function(){var i=this,t=this.tools,e=this.$element.addClass("bjui-tabledit"),a=e.find("> thead > tr:first"),n=this.$tbody,o=e.find("> thead > tr:first").html();a.find("> th").each(function(){var t=c(this),e=t.attr("title"),a=t.data("addtool");e&&t.html(e),a&&(a=c('<span style="position:relative;"></span>'),t.empty(),i.$numAdd=c('<input type="text" value="1" class="form-control num-add" size="2" title="待添加的行数">'),i.$btnAdd=c('<a href="javascript:;" class="row-add" title="添加行"><i class="fa fa-plus-square"></i></a>'),a.append(i.$numAdd).append(i.$btnAdd).appendTo(t))}),e.data("bjui.tabledit.tr",c("<tr>"+o+"</tr>")),t.initTbody(),t.doAdd(),t.doDel(n)},s.prototype.add=function(t,e){for(var a,i=this.tools,n=t.find("> tbody"),o=t.data("bjui.tabledit.tr"),s=0;s<e;s++){o.find("> th").each(function(){c(this).replaceWith("<td>"+c(this).html()+"</td>")});var l=o.clone();0===s&&(a=l),l.hide().appendTo(n),i.initSuffix(n),i.initEnter(n),l.show().css("display","").initui()}a&&a.length&&a.find(":text").each(function(){var t=c(this);if(!t.prop("readonly"))return t.focus(),!1})};var t=c.fn.tabledit;c.fn.tabledit=n,c.fn.tabledit.Constructor=s,c.fn.tabledit.noConflict=function(){return c.fn.tabledit=t,this},c(document).on(BJUI.eventType.initUI,function(t){t=c(t.target).find('table[data-toggle="tabledit"]');t.length&&n.call(t)}),c(document).on(BJUI.eventType.afterInitUI,function(t){c(t.target).find('table[data-toggle="tabledit"]').each(function(){var t;!c(this).is("[data-initnum]")||0<(t=c(this).data("initnum"))&&n.call(c(this),"add",c(this),t)})}),c(document).on("click.bjui.tabledit.data-api",'[data-toggle="tableditadd"]',function(t){var e=c(this),a=e.data("num")||1,i=e.data("target");i&&c(i).length&&c(i).isTag("table")&&(n.call(e,"add",c(i),a),t.preventDefault())})}(jQuery),function(s){"use strict";function l(t,e){this.$element=s(t),this.options=e,this.tools=this.TOOLS(),this.$spinner=null,this.height=this.$element.addClass("form-control").innerHeight(),this.ivalue=Number(this.$element.val())||0}function e(i){var n=arguments,o=i;return this.each(function(){var t=s(this),e=s.extend({},l.DEFAULTS,t.data(),"object"==typeof i&&i),a=t.data("bjui.spinner");a||t.data("bjui.spinner",a=new l(this,e)),"string"==typeof o&&s.isFunction(a[o])?([].shift.apply(n),n?a[o].apply(a,n):a[o]()):a.init()})}l.DEFAULTS={min:0,max:100,step:1,decimalPlace:0},l.EVENTS={afterChange:"afterchange.bjui.spinner"},l.prototype.TOOLS=function(){var s=this;return{changeVal:function(t){var e=s.$element,a=Number(e.val())||Number(s.ivalue),i=t.data("add")||-1,n=s.options.min,o=s.options.max,t=s.options.step;1===i?a<=o-t&&(a+=t):-1===i?n+t<=a&&(a-=t):o<a?a=o:a<n&&(a=n),s.options.decimalPlace&&(a=a.toFixed(s.options.decimalPlace)),s.ivalue=a,e.val(a).trigger(l.EVENTS.afterChange,{value:a})}}},l.prototype.init=function(){isNaN(this.options.min)||isNaN(this.options.max)||isNaN(this.options.step)?BJUI.debug("Spinner Plugin: Parameter is non-numeric type!"):this.addBtn()},l.prototype.addBtn=function(){var e,a=this,t=a.$element;this.$lookBtn||t.parent().hasClass("wrap_bjui_btn_box")||(this.$spinner=s(FRAG.spinnerBtn),t.css({paddingRight:"13px"}).wrap('<span class="wrap_bjui_btn_box"></span>'),(t=t.parent()).css("position","relative"),this.$spinner.css({height:this.height}).appendTo(t),this.$spinner.on("selectstart",function(){return!1}),e=null,a.$spinner.find("li").on("click",function(t){a.tools.changeVal(s(this))}).on("mousedown",function(){var t=s(this);e=setInterval(function(){a.tools.changeVal(t)},150)}).on("mouseup",function(){clearTimeout(e)}))},l.prototype.destroy=function(){this.$element.parent().hasClass("wrap_bjui_btn_box")&&(this.$element.parent().find(".bjui-spinner").remove(),this.$element.unwrap())};var t=s.fn.spinner;s.fn.spinner=e,s.fn.spinner.Constructor=l,s.fn.spinner.noConflict=function(){return s.fn.spinner=t,this},s(document).on(BJUI.eventType.initUI,function(t){t=s(t.target).find('input[data-toggle="spinner"]');t.length&&e.call(t)})}(jQuery),function(l){"use strict";function r(t,e){this.$element=l(t),this.options=e,this.$lookBtn=null}var e,a,d,i,n;function o(i){var n=arguments,o=i;return this.each(function(){var t=l(this),e=l.extend({},r.DEFAULTS,t.data(),"object"==typeof i&&i),a=t.data("bjui.lookup");a?t.data("newurl")&&(a.options.url=t.data("newurl"),t.data("bjui.dialog",null)):(t.data("newurl")&&(e.url=t.data("newurl")),t.data("bjui.lookup",a=new r(this,e))),"string"==typeof o&&l.isFunction(a[o])?([].shift.apply(n),n?a[o].apply(a,n):a[o]()):a.init()})}r.DEFAULTS={url:null,id:null,mask:!0,width:600,height:400,title:"Lookup",maxable:!0,resizable:!0,arrayfix:null,open:!0,addBtn:!1,beforeSelect:null},r.EVENTS={afterChange:"afterchange.bjui.lookup"},r.prototype.init=function(){var t=this.options;return t.url?(t.url=decodeURI(t.url).replacePlh(this.$element.closest(".unitBox")),t.url.isFinishedTm()?(t.url=encodeURI(t.url),e=this.options.group||null,a=this.options.suffix||null,i=this.options.arrayfix||null,d=this.$element,a=a&&a.trim(),t.beforeSelect&&"string"==typeof t.beforeSelect&&(this.options.beforeSelect=t.beforeSelect.toFunc()),n=this.options.beforeSelect,void(d.data("bjui.lookupinit")?(d.data("bjui.lookupinit",!0),this.open(this.$element)):(t.addBtn&&this.addBtn(),t.open&&this.open(this.$element),d.data("bjui.lookupinit",!0)))):(this.$element.alertmsg("error",t.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),BJUI.debug("Lookup Plugin: The lookup's url is incorrect, url:"+t.url),!1)):(BJUI.debug("Lookup Plugin: Error trying open a lookup dialog, url is undefined!"),!1)},r.prototype.addBtn=function(){var t,a=this,e=a.$element;this.$lookBtn||e.parent().hasClass("wrap_bjui_btn_box")||(this.$lookBtn=l(FRAG.lookupBtn),this.$element.css({paddingRight:"15px"}).wrap('<span class="wrap_bjui_btn_box"></span>'),t=this.$element.parent(),e=this.$element.addClass("form-control").innerHeight(),t.css({position:"relative",display:"inline-block"}),l.each(a.options,function(t,e){"toggle"!==t&&a.$lookBtn.data(t,e)}),a.$lookBtn.data("bjui.lookupinit",!0),this.$lookBtn.css({height:e,lineHeight:e+"px"}).appendTo(t),this.$lookBtn.on("selectstart",function(){return!1}))},r.prototype.open=function(t){var e=this.options;t.dialog({id:e.id||"lookup_dialog",url:e.url,title:e.title,width:e.width,height:e.height,mask:e.mask,maxable:e.maxable,resizable:e.resizable})},r.prototype.getField=function(t){return i&&(t=i+"["+t+"]"),(e?e+".":"")+t+(a||"")},r.prototype.setSingle=function(t,e){"string"==typeof t&&(t=new Function("return "+t)()),this.beforeSelect(t,[t],e)&&this.setVal(t,e)},r.prototype.setMult=function(t,e){var i={},n=[];this.$element.closest(".unitBox").find('[name="'+t+'"]').filter(":checked").each(function(){var t,e,a=new Function("return "+l(this).val())();for(t in"object"==typeof a&&n.push(a),a)a.hasOwnProperty(t)&&(e=i[t]?i[t]+",":"",i[t]=e+a[t])}),l.isEmptyObject(i)?this.$element.alertmsg("error",this.$element.data("warn")||FRAG.alertSelectMsg):this.beforeSelect(i,n,e)&&this.setVal(i,e)},r.prototype.beforeSelect=function(t,e,a){return!n||!1!==n(t,e,a)},r.prototype.setVal=function(i,n){var o,s=this,t=d.closest(".unitBox");d.data("customEvent")?d.trigger("customEvent.bjui.lookup",[i]):t.find(":input").each(function(){var t,e=l(this),a=e.attr("name");for(t in i)if(i.hasOwnProperty(t))if(s.getField(t)===a){o=1===parseInt(n)&&e.val()?e.val()+","+i[t]:i[t],e.val(o).trigger(r.EVENTS.afterChange,{value:i[t]});break}}),this.$element.dialog("closeCurrent")};var t=l.fn.lookup;l.fn.lookup=o,l.fn.lookup.Constructor=r,l.fn.lookup.noConflict=function(){return l.fn.lookup=t,this},l(document).on(BJUI.eventType.initUI,function(t){t=l(t.target).find('[data-toggle="lookup"]');t.length&&o.call(t,"addBtn")}),l(document).on("click.bjui.lookup.data-api",'[data-toggle="lookupbtn"]',function(t){var e=l(this);e.attr("href")&&!e.data("url")&&e.attr("data-url",e.attr("href")),e.data("title")||e.attr("data-title",e.text()),o.call(e),t.preventDefault()}),l(document).on("click.bjui.lookupback.data-api",'[data-toggle="lookupback"]',function(t){var e=l(this),a=e.data("args"),i=e.data("lookupid"),n=l('input[name="lookupType"]:checked').val();a?o.call(e,"setSingle",a,n):i&&o.call(e,"setMult",i,n),t.preventDefault()})}(jQuery),function(c){"use strict";function s(t,e){this.$element=c(t).addClass("tag-input"),this.options=e,this.tools=this.TOOLS(),this.$box=c(this.$element.wrap('<div class="bjui-tags"></div>')).parent(),this.timeout=null,this.$tagsArr={},this.tags=[]}function e(i){var n=arguments,o=i;return this.each(function(){var t=c(this),e=c.extend({},s.DEFAULTS,t.data(),"object"==typeof i&&i),a=t.data("bjui.tags");a||t.data("bjui.tags",a=new s(this,e)),"string"==typeof o&&c.isFunction(a[o])?([].shift.apply(n),n?a[o].apply(a,n):a[o]()):a.init()})}s.DEFAULTS={width:300,url:"",global:!1,type:"GET",tagname:"tag",max:0,clear:!1,lightCls:"tags-highlight",val:[]},s.EVENTS={afterCreated:"aftercreated.bjui.tags"},s.prototype.TOOLS=function(){var r=this,d=this.options;return{keyDown:function(t){if(13===t.which)return!1},keyUp:function(t){switch(t.which){case BJUI.keyCode.BACKSPACE:if(0===c.trim(r.$element.val()).length)return r.tools.removeMenu(),!1;break;case BJUI.keyCode.ESC:r.tools.removeMenu();break;case BJUI.keyCode.DOWN:if(!r.$menu||!r.$menu.length)return;n=r.$menu.find("> ."+d.lightCls);var e,a=r.$menu.find("> li:first-child");return(n.length&&(e=n.removeClass(d.lightCls).next()).length?e:a).addClass(d.lightCls),!1;case BJUI.keyCode.UP:if(!r.$menu||!r.$menu.length)return;n=r.$menu.find("> ."+d.lightCls);var i=r.$menu.find("> li:last-child");return(n.length&&(s=n.removeClass(d.lightCls).prev()).length?s:i).addClass(d.lightCls),!1;case BJUI.keyCode.ENTER:if(0<d.max&&r.$tagsArr.length>=d.max)return!1;var n=!1,o=!1,s=null,i=r.$menu&&r.$menu.find("> ."+d.lightCls);if(i&&i.length)n=i.text(),(s=i.data("item"))&&(o=s.value);else{if(!(n=c.trim(r.$element.val())).length)return!1;if(d.clear&&-1===c.inArray(n,r.tags))return r.$element.val(""),!1;o=n}if(!n)return;var l=!1;return(r.$tagsArr.length&&r.$tagsArr.each(function(){c(this).val()===o&&(l=!0)}),l)?(r.$element.val(""),!1):(r.tools.createTag(n,o),r.tools.removeMenu(),r.$element.val(""),c.proxy(r.tools.onAfterCreated(s,o),r),!1)}},query:function(){d.url&&d.url.length&&(r.timeout&&clearTimeout(r.timeout),r.timeout=setTimeout(r.tools.doQuery,300))},doQuery:function(){var t,n,a,e;0<d.max&&r.$tagsArr.length>=d.max||(t=r.$element.val(),n=r.$box.find("> .tags-menu"),a=[],e=r.$element.closest(".navtab-panel").length?c.CurrentNavtab:c.CurrentDialog,r.$element.closest(".bjui-layout").length&&(e=r.$element.closest(".bjui-layout")),0!==t.length&&(r.$element.one("ajaxStart",function(){e.trigger("bjui.ajaxStart")}).one("ajaxStop",function(){e.trigger("bjui.ajaxStop")}),c.ajax({url:d.url,global:d.global,type:d.type,data:{term:t},dataType:"json",success:function(t){if(0!==t.length){n.length||(n=c('<ul class="tags-menu"></ul>')),n.empty().hide().appendTo(r.$box);for(var e=0;e<t.length;e++)c('<li class="tags-item">'+t[e].label+"</li>").data("item",t[e]).appendTo(n),a.push(t[e].label);r.tags=a,n.css({top:r.$element.position().top+r.$element.outerHeight(),left:r.$element.position().left}).fadeIn().find("> li").hover(function(){c(this).addClass(d.lightCls).siblings().removeClass(d.lightCls)},function(){c(this).removeClass(d.lightCls)}).click(function(){var t=c(this).text(),e=c(this).data("item"),a=e.value,i=!1;if(r.$box.find("input:hidden").each(function(){c(this).val()===a&&(i=!0)}),i)return r.$element.val(""),void n.remove();c.proxy(r.tools.createTag(t,a),r),n.remove(),r.$element.val(""),c.proxy(r.tools.onAfterCreated(e,a),r)}),r.$menu=n}}})))},createTag:function(t,e){var a=c('<span class="label label-tag" data-value="'+e+'" style="margin-left: 1px; margin-top: 1px;"><i class="fa fa-tag"></i> '+t+'&nbsp;&nbsp;<a href="#" class="close">&times;</a></span>');a.insertBefore(r.$element).find("a.close").click(function(){var t=a.data("value");r.$box.find("input:hidden").each(function(){c(this).val()===t&&c(this).remove()}),a.remove(),r.$tagsArr=r.$box.find('input[name="'+r.options.tagname+'"]')}),c('<input type="hidden" name="'+r.options.tagname+'">').val(e).appendTo(r.$box),r.$tagsArr=r.$box.find('input[name="'+r.options.tagname+'"]')},removeMenu:function(){r.$menu&&r.$menu.remove()},onAfterCreated:function(t,e){var a=[];r.$tagsArr.length&&r.$tagsArr.each(function(){a.push(c(this).val())}),r.$element.trigger(s.EVENTS.afterCreated,{item:t,value:e,tags:a.join(",")})}}},s.prototype.init=function(){var a=this,t=this.$element,e=this.options;if(e.url){if(e.url=decodeURI(e.url).replacePlh(t.closest(".unitBox")),!e.url.isFinishedTm())return t.alertmsg("error",e.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("Tags Plugin: The query tags url is incorrect, url: "+e.url);e.url=encodeURI(e.url)}else;isNaN(this.options.max)?BJUI.debug("Tags Plugin: Parameter 'max' is non-numeric type!"):(a.$box.width(e.width).on("click",function(){t.focus()}),"string"==typeof e.val&&(e.val=e.val.toObj()),c.each(e.val,function(t,e){a.tools.createTag(e,e)}),t.on("keydown",c.proxy(this.tools.keyDown,this)).on("keyup",c.proxy(this.tools.keyUp,this)),c.support.leadingWhitespace?t.on("input",c.proxy(this.tools.query,this)):t.on("propertychange",c.proxy(this.tools.query,this)),c(document).on("click.bjui.tags",c.proxy(function(t){c(t.target).closest(this.$box).length||this.tools.removeMenu()},this)))},s.prototype.destroy=function(){this.$tags&&(this.$element.upwrap(),this.$tags.remove())};var t=c.fn.tags;c.fn.tags=e,c.fn.tags.Constructor=s,c.fn.tags.noConflict=function(){return c.fn.tags=t,this},c(document).on(BJUI.eventType.initUI,function(t){t=c(t.target).find('input[data-toggle="tags"]');t.length&&e.call(t)})}(jQuery),function(d){"use strict";function l(t,e){this.$element=d(t),this.options=e,this.tools=this.TOOLS()}function e(i){var n=arguments,o=i;if(window.FileReader)return this.each(function(){var t=d(this),e=d.extend({},l.DEFAULTS,t.data(),"object"==typeof i&&i),a=t.data("bjui.upload");a||t.data("bjui.upload",a=new l(this,e)),"string"==typeof o&&d.isFunction(a[o])?([].shift.apply(n),n?a[o].apply(a,n):a[o]()):a.init()});this.each(function(){if(d.fn.uploadify){var t={swf:BJUI.PLUGINPATH+"uploadify/scripts/uploadify.swf",fileTypeExts:"*.jpg;*.png",id:"fileInput",fileObjName:"file",fileSizeLimit:204800,buttonText:"选择上传文件",auto:!1,multi:!1,height:24},e=d(this),a=e.data();if(e.addClass("bjui-upload"),a.id||(a.id=e.attr("id")),d.extend(t,a),t.uploader){if(t.uploader=decodeURI(t.uploader).replacePlh(e.closest(".unitBox")),!t.uploader.isFinishedTm())return e.alertmsg("error",t.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("Upload Plugin: The options uploader is incorrect: "+t.uploader);t.uploader=encodeURI(t.uploader),"fileInput"===t.id&&(t.id=t.id+(new Date).getTime());var i,n=d('<input type="file" name="'+t.name+'" id="'+t.id+'">');t.onInit&&"string"==typeof t.onInit&&(t.onInit=t.onInit.toFunc()),t.onCancel&&"string"==typeof t.onCancel&&(t.onCancel=t.onCancel.toFunc()),t.onSelect&&"string"==typeof t.onSelect&&(t.onSelect=t.onSelect.toFunc()),t.onUploadSuccess&&"string"==typeof t.onUploadSuccess&&(t.onUploadSuccess=t.onUploadSuccess.toFunc()),t.onUploadComplete&&"string"==typeof t.onUploadComplete&&(t.onUploadComplete=t.onUploadComplete.toFunc()),t.onUploadError&&"string"==typeof t.onUploadError&&(t.onUploadError=t.onUploadError.toFunc()),t.onUploadBefore&&"string"==typeof t.onUploadBefore&&(t.onUploadBefore=t.onUploadBefore.toFunc()),n.appendTo(e),t.auto||((i=d('<button class="btn btn-orange" data-icon="cloud-upload">开始上传</button>')).hide().insertAfter(e).click(function(){n.uploadify("upload","*"),d(this).hide()}),t.onSelect=function(){i.show()}),n.uploadify(t)}else BJUI.debug("Upload Plugin: The options uploader is undefined!")}})}l.DEFAULTS={fileTypeExts:"*.jpg;*.png",uploader:"",auto:!1,method:"POST",multi:!1,formData:{},fileObjName:"file",fileSizeLimit:204800,previewImg:!0,previewLoadimg:null,dragDrop:!1,showUploadedPercent:!0,showUploadedSize:!0,buttonText:"选择上传文件",removeTimeout:1e3,itemTemplate:FRAG.uploadTemp,breakPoints:!1,fileSplitSize:1048576,onUploadBefore:null,onUploadStart:null,onUploadSuccess:null,onUploadComplete:null,onUploadError:null,onInit:null,onCancel:null,onSelect:null},l.MIMETYPES={zip:["application/x-zip-compressed"],jpg:["image/jpeg"],png:["image/png"],gif:["image/gif"],swf:["application/x-shockwave-flash"],doc:["application/msword"],xls:["application/vnd.ms-excel"],docx:["application/vnd.openxmlformats-officedocument.wordprocessingml.document"],xlsx:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],ppt:["application/vnd.ms-powerpoint"],pptx:["application/vnd.openxmlformats-officedocument.presentationml.presentation"],mp3:["audio/mpeg"],mp4:["video/mp4"],pdf:["application/pdf"],txt:["text/plain"],xml:["text/xml"]},l.prototype.TOOLS=function(){var o=this,s=this.options,a={formatFileSize:function(t,e){return t=1048576<t&&!e?(Math.round(100*t/1048576)/100).toString()+"MB":(Math.round(100*t/1024)/100).toString()+"KB"},getFile:function(t,e){console.log(t);for(var a=0;a<e.length;a++)if(e[a].index===t)return e[a];return!1},getFileTypes:function(t){for(var e=[],a=t.split(";"),i=0;i<a.length;i++)e.push(a[i].split(".").pop());return e},getMimetype:function(t){return l.MIMETYPES[t]},getAcceptString:function(t){for(var e=this.getFileTypes(t),a=[],i=0;i<e.length;i++){var n=this.getMimetype(e[i]);n?a.push(n):a.push("."+e[i])}return a.join(",")},filter:function(t){var e=[],a=this.getFileTypes(s.fileTypeExts);if(0<a.length)for(var i=0;i<t.length;i++){var n=t[i];parseInt(this.formatFileSize(n.size,!0))>s.fileSizeLimit?o.$element.alertmsg("error",'文件"'+n.name+'"大小超出限制！'):0<=d.inArray(n.name.split(".").pop().toLowerCase(),a)?e.push(n):o.$element.alertmsg("error",'文件"'+n.name+'"类型不允许！')}return e},getFiles:function(t){for(var e=t.target.files||t.dataTransfer.files,e=this.filter(e),a=0;a<e.length;a++)e[a].id=e[a].lastModifiedDate.getTime()+"_"+e[a].size+"_"+(e[a].type||"").replace(/\W/g,""),this.renderQueueItem(e[a]),o.queueData.files++;return e},renderQueueItem:function(t){var e,i=0,a=d(s.itemTemplate.replace("{fileId}",t.id).replace("{fileName}",t.name).replace("#upConfirm#",BJUI.regional.upload.upConfirm).replace("#upPause#",BJUI.regional.upload.upPause).replace("#upCancel#",BJUI.regional.upload.upCancel).replace("{percent}","0.00%").replace("{uploadedSize}","0KB").replace("{fileSize}",this.formatFileSize(t.size)));s.auto&&a.find("> .info > .up_confirm").remove(),a.data("upfile",t),o.$uploadFileList.append(a),s.breakPoints&&(i=this.getUploadedSize(t.id))>t.size&&(i=t.size),this.showProgress(t.id,i,t.size),s.previewImg&&-1!==t.type.indexOf("image")?(e=a.find("> .preview > .img"),s.previewLoadimg&&e.html('<img src="'+s.previewLoadimg+'" height="114">'),this.previewImg(t,e)):a.find("> .preview").remove(),s.showUploadedSize?((e=a.find("> .filesize")).find("> .uploadedsize").html(this.formatFileSize(i)),e.find("> .filesize").html(this.formatFileSize(t.size))):a.find("> .filesize").remove(),s.showUploadedPercent?a.find("> .percent").html((i/t.size*100).toFixed(2)+"%"):a.find("> .percent").remove(),s.onSelect&&s.onSelect(t),s.auto&&o.fileUpload(t,i),a.on("click.bjui.upload.confirm",".up_confirm",function(t){var e=d(this),a=e.closest(".item");e.hide().next().show(),o.fileUpload(a.data("upfile"),i)}),a.on("click.bjui.upload.cancel",".up_cancel",this.removeQueueItem)},successQueueItem:function(t,e){a.showProgress(t.id,t.size,t.size),s.onUploadSuccess&&s.onUploadSuccess.toFunc().call(o,t,e.responseText,o.$element),setTimeout(function(){o.$element.find("#"+t.id).fadeOut("normal",function(){d(this).remove(),0===o.$element.find("> .queue > .item:visible").length&&(o.$element.find("> .queue").hide(),o.$file.val(""))})},s.removeTimeout)},removeQueueItem:function(t,e){e&&e.abort(),d(this).closest(".item").fadeOut("normal",function(){d(this).remove(),0===o.$element.find("> .queue > .item:visible").length&&o.$element.find("> .queue").hide()}),t.preventDefault()},previewImg:function(t,e){var a;t&&e.length&&((a=new FileReader).onload=function(t){e.html('<img src="'+t.target.result+'">')},a.readAsDataURL(t))},showProgress:function(t,e,a){a=e/a*100+"%";o.$element.find("#"+t+" > .progress > .bar").css("width",a)},getUploadedSize:function(t){return+localStorage.getItem(t)},saveUploadedSize:function(t,e){localStorage.setItem(t,e)},sendBlob:function(t,e,a,i){var n=new FormData;if(e.open(s.method,t,!0),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.append(s.fileObjName,a),i)for(var o in i)i.hasOwnProperty(o)&&n.append(o,i[o]);e.send(n)}};return a},l.prototype.init=function(){var t,e=this,a=this.$element,i=this.options;if(i.uploader){if(i.uploader=decodeURI(i.uploader).replacePlh(a.closest(".unitBox")),!i.uploader.isFinishedTm())return a.alertmsg("error",i.warn||FRAG.alertPlhMsg.replace("#plhmsg#",BJUI.regional.plhmsg)),void BJUI.debug("Upload Plugin: The options uploader is incorrect: "+i.uploader);i.uploader=encodeURI(i.uploader),a.hasClass("bjui-upload")||(t=d(FRAG.uploadFrag.replaceAll("#multi#",i.multi?"multiple":"").replaceAll("#accept#",e.tools.getAcceptString(i.fileTypeExts)).replaceAll("#btnTxt#",(i.icon?'<i class="fa fa-'+i.icon+'">&nbsp;&nbsp;':"")+i.buttonText)),a.addClass("bjui-upload").append(t),this.$file=a.find("> .bjui-upload-select-file"),this.$uploadFileList=a.find("> .queue"),this.queueData={files:0,success:0,error:0},a.on("change.bjui.upload",".bjui-upload-select-file",function(t){e.fileSelect(t)}).on("click.bjui.upload",".bjui-upload-select",function(t){e.$file.trigger("click")}),i.onInit&&i.onInit(),i.dragDrop&&(a[0].ondragover=function(t){return t.preventDefault(),!0},a[0].ondrop=function(t){e.fileSelect(t),t.stopPropagation(),t.preventDefault()}))}else BJUI.debug("Upload Plugin: The options uploader is undefined!")},l.prototype.fileSelect=function(t){this.$uploadFileList.show(),this.tools.getFiles(t)},l.prototype.fileUpload=function(a,i){var n=this,t=n.$element,o=n.options,s=n.tools,l=!1,r=a;o.onUploadComplete&&"string"==typeof o.onUploadComplete&&(o.onUploadComplete=o.onUploadComplete.toFunc());var e=!0;if(o.onUploadBefore&&("string"==typeof o.onUploadBefore&&(o.onUploadBefore=o.onUploadBefore.toFunc()),!0!==(e=o.onUploadBefore(o.formData||{},this.$file))&&(o.formData=e)),!e)return t.find("#"+r.id+" > .info > .up_cancel").trigger("click.bjui.upload.cancel"),void(o.onUploadComplete&&o.onUploadComplete(r,l.responseText,this.$file));l=new XMLHttpRequest,o.breakPoints&&(a=r.slice(i,i+o.fileSplitSize)),l.upload&&(l.upload.onprogress=function(t){n.onProgress(a,t.loaded,r.size)},l.onreadystatechange=function(t){var e;4===l.readyState&&(200===l.status?(e=!1,o.breakPoints?(i+=o.fileSplitSize,s.saveUploadedSize(r.id,i),i<r.size?(a=r.slice(i,i+o.fileSplitSize),s.sendBlob(o.uploader,l,a,o.formData)):e=!0):e=!0,e&&(n.queueData.success++,s.successQueueItem(r,l),o.onUploadComplete&&o.onUploadComplete(r,l.responseText,n.$file))):(n.queueData.error++,o.onUploadError&&o.onUploadError(r,l.responseText)),o.onQueueComplete&&n.queueData.files===n.queueData.success+n.queueData.error&&o.onQueueComplete(n.queueData))},o.onUploadStart&&o.onUploadStart(),o.formData.fileName=r.name,o.formData.lastModifiedDate=r.lastModifiedDate.getTime(),s.sendBlob(o.uploader,l,a,o.formData)),t.find("#"+r.id+" > .info > .up_pause").on("click.bjui.upload.pause",function(t){l.abort(),d(this).hide().prev().show()}),t.find("#"+r.id+" > .info > .up_cancel").off("click.bjui.upload.cancel").on("click.bjui.upload.cancel",d.proxy(function(t){this.tools.removeQueueItem(t,l)},this))},l.prototype.onProgress=function(t,e,a){var i=this,n=i.options,o=i.$element.find("#"+t.id+" .progress"),s=e,l=o.attr("lastLoaded")||0;(e-=parseInt(l))>t.size&&(e=t.size),i.$progressBar=o.children(".bar");a=(e/a*100+(n.breakPoints?parseFloat(i.$progressBar.get(0).style.width||0):0)).toFixed(2),a=100<a?"100%":a+"%";n.showUploadedSize&&o.nextAll(".filesize").find("> .uploadedsize").text(i.tools.formatFileSize(e)),n.showUploadedPercent&&o.nextAll(".up_percent").text(a),i.$progressBar.css("width",a),s<n.fileSplitSize?o.attr("lastLoaded",s):o.removeAttr("lastLoaded")},l.prototype.destroy=function(){};var t=d.fn.upload;d.fn.upload=e,d.fn.upload.Constructor=l,d.fn.upload.noConflict=function(){return d.fn.upload=t,this},d(document).on(BJUI.eventType.initUI,function(t){t=d(t.target).find('[data-toggle="upload"]');t.length&&e.call(t)})}(jQuery),function(s){"use strict";var a,i;function l(t,e){this.$element=s(t),this.options=e}function e(i){var n=arguments,o=i;return this.each(function(){var t=s(this),e=s.extend({},l.DEFAULTS,t.data(),"object"==typeof i&&i),a=t.data("bjui.theme");a||t.data("bjui.theme",a=new l(this,e)),"string"==typeof o&&s.isFunction(a[o])?([].shift.apply(n),n?a[o].apply(a,n):a[o]()):a.init()})}s(function(){a=s("#bjui-link-theme"),i=s("#bjui-themes")}),l.DEFAULTS={theme:"purple"},l.prototype.init=function(){var t,e;a.length&&(e=(e=(e=a.attr("href")).substring(0,e.lastIndexOf("/"))).substring(0,e.lastIndexOf("/")),e+="/"+this.options.theme+"/core.css",a.attr("href",e),e=(e=(t=this.$element.closest("ul").prev()).attr("class")).replace(/(theme[\s][a-z]*)/g,""),t.removeClass().addClass(e).addClass("theme").addClass(this.options.theme),i.find("li").removeClass("active"),this.$element.parent().addClass("active"),this.cookie())},l.prototype.setTheme=function(t){i.find("a.theme_"+t).trigger("click")},l.prototype.cookie=function(){var t=this.options.theme;s.cookie&&s.cookie("bjui_theme",t,{path:"",expires:30})};var t=s.fn.theme;s.fn.theme=e,s.fn.theme.Constructor=l,s.fn.theme.noConflict=function(){return s.fn.theme=t,this},s(document).on("click.bjui.theme.data-api",'[data-toggle="theme"]',function(t){e.call(s(this)),t.preventDefault()})}(jQuery),function(s){"use strict";function l(t,e){this.$element=s(t),this.options=e}function a(i){var n=arguments,o=i;return this.each(function(){var t=s(this),e=s.extend({},l.DEFAULTS,t.data(),"object"==typeof i&&i),a=t.data("bjui.initui");a||t.data("bjui.initui",a=new l(this,e)),"string"==typeof o&&s.isFunction(a[o])?([].shift.apply(n),n?a[o].apply(a,n):a[o]()):a.init()})}l.DEFAULTS={},l.prototype.init=function(){var t=this.$element;s.when(this.initUI()).done(function(){t.trigger(BJUI.eventType.afterInitUI)})},l.prototype.initUI=function(){var t=this.$element;s.when(t.trigger(BJUI.eventType.beforeInitUI)).done(function(){t.trigger(BJUI.eventType.initUI)})};var t=s.fn.initui;function i(t){var e=t,a=e;"static"===e.css("position")&&(a=e.offsetParent());var i=parseInt(a.css("zIndex"))||0,t=e.find("> .bjui-maskBackground"),a=e.find("> .bjui-maskProgress");return t.length||(t=s(FRAG.maskBackground),a=s(FRAG.maskProgress.replace("#msg#",BJUI.regional.progressmsg)),e.prepend(t).prepend(a)),t.css("zIndex",i+1),a.css("zIndex",i+2),{$bg:t,$pr:a}}function e(t){t.find('select[data-toggle="selectpicker"]').selectpicker("destroyMenu"),t.find('[data-toggle="selectztree"]').trigger("destroy.bjui.selectztree")}s.fn.initui=a,s.fn.initui.Constructor=l,s.fn.initui.noConflict=function(){return s.fn.initui=t,this},s(document).on("click.bjui.initui.data-api",'[data-toggle="initui"]',function(t){var e=s(this);a.call(e,e.data()),t.preventDefault()}),s(document).on(BJUI.eventType.beforeInitUI,function(t){var e=s(t.target),i=[],t=e.find("[data-noinit]");e.find("> .bjui-maskProgress").find(".progress").stop().animate({width:"85%"},"fast"),t.each(function(t){var e=s(this),a={};a.$target=e,a.$next=e.next(),a.$prev=e.prev(),a.$parent=e.parent(),a.visible=!!e.is(":visible"),i.push(a),e.remove()}),e.data("bjui.noinit",i)}),s(document).on(BJUI.eventType.initUI,function(t){s(t.target).find("> .bjui-maskProgress").find(".progress").stop().animate({width:"95%"},"fast")}),s(document).on(BJUI.eventType.afterInitUI,function(t){var a=s(t.target),t=a.data("bjui.noinit"),e=a.find("> .bjui-pageContent").find("form");t&&s.each(t,function(t,e){e.$next.length?e.$next.before(e.$target):e.$prev.length?e.$prev.after(e.$target):e.$parent.length&&e.$parent.append(e.$target),e.visible&&e.$target.show(),a.removeData("bjui.noinit")}),a.resizePageH(),e.length&&a.find("> .bjui-pageFooter").find(":submit").on("click.bjui.submit",function(t){t.preventDefault(),e.submit()}),a.find(".bjui-maskProgress").find(".progress").stop().animate({width:"100%"},"fast",function(){a.find(".bjui-ajax-mask").fadeOut("normal",function(){s(this).remove()})})}),s(document).one(BJUI.eventType.afterInitUI,function(t){var e=s("#bjui-hnav-navbar").find("> li.active");e.length&&e.find("> .items").length&&e.find("> a").trigger("click")}),s(document).on("bjui.ajaxStart",function(t,e,a){t=i(s(t.target));t.$bg.fadeIn(),t.$pr.fadeIn(),t.$pr.find(".progress").animate({width:"80%"},e||500),a&&setTimeout(function(){a.toFunc().call(this)},25)}).on("bjui.ajaxStop",function(t){var e=i(s(t.target));e.$pr.find(".progress").animate({width:"100%"},"fast",function(){e.$bg.remove(),e.$pr.remove()})}).on("bjui.ajaxError",function(t){t=i(s(t.target));t.$bg.remove(),t.$pr.remove()}),s(document).on(BJUI.eventType.ajaxStatus,function(t){var t=s(t.target),e=i(t);t.one("ajaxStart",function(){e.$bg.fadeIn(),e.$pr.fadeIn(),e.$pr.find(".progress").animate({width:"10%"},"fast")}).one("ajaxStop",function(){}).one("ajaxError",function(){e.$bg.remove(),e.$pr.remove()})}),s(document).on(BJUI.eventType.beforeLoadDialog,function(t){}).on(BJUI.eventType.beforeAjaxLoad,function(t){e(s(t.target))}).on(BJUI.eventType.beforeCloseNavtab,function(t){e(s(t.target))}).on(BJUI.eventType.beforeCloseDialog,function(t){e(s(t.target))}),s(function(){s(document).on("keydown keyup",function(t){t.which===BJUI.keyCode.CTRL&&(BJUI.KeyPressed.ctrl="keydown"===t.type),t.which===BJUI.keyCode.SHIFT&&(BJUI.KeyPressed.shift="keydown"===t.type)})})}(jQuery),function(d){"use strict";d(document).on(BJUI.eventType.initUI,function(t){var a=d(t.target);a.find('[data-toggle="boolcheck"]').each(function(t){var e,a,i=d(this),n=i.attr("name");i.removeAttr("name"),n&&(e=i.is(":checked")?1:0,a=d('<input type="hidden" value="'+e+'" name="'+n+'">').appendTo(i.parent())),i.iCheck({checkboxClass:"icheckbox_minimal-purple",radioClass:"iradio_minimal-purple",increaseArea:"20%"}).on("ifChecked",function(){a&&a.val(1)}).on("ifUnchecked",function(){a&&a.val(0)})});t=a.find('[data-toggle="icheck"]');t.each(function(t){var e=d(this),i=e.attr("id"),n=e.attr("name"),a=e.data("label");a&&(i||(i=d.getGUID(),e.attr("id",i)),e.after('<label for="'+i+'" class="ilabel">'+a+"</label>")),e.on("ifCreated",function(t){var e=d(this).closest("div"),a=e.next('[for="'+i+'"]');e.attr("data-icheck",n),a.attr("data-icheck",n)}).iCheck({checkboxClass:"icheckbox_minimal-purple",radioClass:"iradio_minimal-purple",increaseArea:"20%"}).on("ifChanged",function(){d(this).trigger("validate")}),e.prop("disabled")&&e.iCheck("disable")}),t.filter(".checkboxCtrl").on("ifChanged",function(t){var e=!0===t.target.checked?"check":"uncheck",t=d(this).data("group");a.find(':checkbox[name="'+t+'"]').iCheck(e)}),a.find(":text, :password, textarea, :button, a.btn").each(function(){var t,e,a,i,n=d(this),o=n.closest("table.bjui-tabledit");(n.is(":text")||n.is(":password")||n.isTag("textarea"))&&!n.hasClass("form-control")&&n.addClass("form-control"),n.is(":button")&&(t=n.data("icon"),a=n.attr("class"),n.hasClass("btn")||n.removeClass().addClass("btn").addClass(a),t&&(e="fa-"+t.replace("fa-",""),n.data("bjui.icon")||n.html('<i class="fa '+e+'"></i> '+n.html()).data("bjui.icon",!0))),n.isTag("a")&&(t=n.data("icon"))&&(e="fa-"+t.replace("fa-",""),n.data("bjui.icon")||n.html('<i class="fa '+e+'"></i> '+n.html()).data("bjui.icon",!0)),!n.isTag("textarea")||(i=n.data("toggle"))&&"autoheight"===i&&d.fn.autosize&&n.addClass("autosize").autosize(),o.length||(i=n.attr("size"))&&(o=0,(o="%"!==i.charAt(i.length-1)?10*i:i)&&n.css("width",o))}),a.find('form[data-toggle="validate"]').each(function(){var t=d(this),i=void 0===t.data("alertmsg")||t.data("alertmsg");d(this).validator({valid:function(t){d(t).bjuiajax("ajaxForm",d(t).data())},validClass:"ok",theme:t.data("theme")||"red_right_effect"}).on("invalid.form",function(t,e,a){i&&d(e).alertmsg("error",FRAG.validateErrorMsg.replace("#validatemsg#",BJUI.regional.validatemsg).replaceMsg(a.length))})}),a.find('[data-toggle="moresearch"]').each(function(){var e=d(this),a=e.closest(".bjui-pageHeader"),i=a&&a.find(".bjui-moreSearch"),n=e.data("name");e.attr("title")||e.attr("title","更多查询条件"),e.click(function(t){i.length?(i.css("top",a.outerHeight()-1),i.is(":visible")?(e.html('<i class="fa fa-angle-double-down"></i>'),n&&d("body").data("moresearch."+n,!1)):(e.html('<i class="fa fa-angle-double-up"></i>'),n&&d("body").data("moresearch."+n,!0)),i.fadeToggle("slow","linear"),t.preventDefault()):BJUI.debug("Not created 'moresearch' box[class=\"bjui-moreSearch\"]!")}),n&&d("body").data("moresearch."+n)&&(i.css("top",a.outerHeight()-1).fadeIn(),e.html('<i class="fa fa-angle-double-up"></i>'))});function i(t,e){var a,o,i=t.data("refurl"),s=function(t){var e=d(t.data("nextselect"));e&&e.length&&(t=e.data("emptytxt")||"&nbsp;",e.html("<option>"+t+"</option>").selectpicker("refresh"),s(e))};e&&e.length&&i&&(a=t.data("val"),o=e.data("val"),void 0===a&&(a=t.val()),d.ajax({type:"POST",dataType:"json",url:i.replace("{value}",encodeURIComponent(a)),cache:!1,data:{},success:function(a){var i,n;a&&(n=i="",d.each(a,function(t){var e,t=a[t]&&a[t].length?(e=a[t][0],a[t][1]):(e=a[t].value,a[t].label);void 0!==o&&(n=e===o?" selected":""),i+='<option value="'+e+'"'+n+">"+t+"</option>"}),t.removeAttr("data-val").removeData("val"),e.removeAttr("data-val").removeData("val"),i=i||"<option>"+(i=e.data("emptytxt")||"&nbsp;")+"</option>",e.html(i).selectpicker("refresh"),s(e))},error:BJUI.ajaxError}))}t=a.find('select[data-toggle="selectpicker"]');t.each(function(){var t=d(this),e=t.data(),a=d(e.nextselect);t.addClass("show-tick"),e.style||t.data("style","btn-default"),e.width||t.data("width","auto"),e.container?!0===e.container&&t.attr("data-container","false").data("container",!1):t.data("container","body"),t.selectpicker(),a&&a.length&&void 0!==a.data("val")&&i(t,a)}),t.change(function(){var t=d(this),e=d(t.data("nextselect"));i(t,e),t.attr("aria-required")&&t.trigger("validate")}),a.find('[data-toggle="ztree"]').each(function(){var t,e=d(this),s=e.data(),a=s.options;a&&"string"==typeof a&&(a=a.toObj()),a&&d.extend(s,"object"==typeof a&&a),t=s.setting,s.nodes?("string"==typeof s.nodes&&(s.nodes.trim().startsWith("[")||s.nodes.trim().startsWith("{")?s.nodes=s.nodes.toObj():s.nodes=s.nodes.toFunc()),"function"==typeof s.nodes&&(s.nodes=s.nodes.call(this)),e.removeAttr("data-nodes")):(s.nodes=[],e.find("> li").each(function(){var t=d(this),e=t.data();e.pid&&(e.pId=e.pid),e.name=t.html(),s.nodes.push(e)}),e.empty()),s.showRemoveBtn||(s.showRemoveBtn=!1),s.showRenameBtn||(s.showRenameBtn=!1),s.addHoverDom&&"function"!=typeof s.addHoverDom&&(s.addHoverDom="edit"===s.addHoverDom?function(i,n){var t=n.level,e=d("#"+n.tId+l),a=d("#diyBtn_add_"+n.id),o=d("#diyBtn_del_"+n.id);a.length||t<s.maxAddLevel&&((a=d('<span class="tree_add" id="diyBtn_add_'+n.id+'" title="添加"></span>')).appendTo(e),a.on("click",function(){r.addNodes(n,{name:"新增Item"})}));o.length||(o=d('<span class="tree_del" id="diyBtn_del_'+n.id+'" title="删除"></span>')).appendTo(e).on("click",function(e){function t(){o.alertmsg("confirm","确认要删除 "+n.name+" 吗？",{okCall:function(){var t;r.removeNode(n),!s.onRemove||(t=s.onRemove.toFunc())&&t.call(this,e,i,n)},cancelCall:function(){}})}var a;s.beforeRemove?!(a=s.beforeRemove.toFunc())||(a=a.call(a,i,n))&&!0===a&&t():t()})}:s.addHoverDom.toFunc()),s.removeHoverDom&&"function"!=typeof s.removeHoverDom&&(s.removeHoverDom="edit"===s.removeHoverDom?function(t,e){var a=d("#diyBtn_add_"+e.id),e=d("#diyBtn_del_"+e.id);a&&a.length&&a.off("click").remove();e&&e.length&&e.off("click").remove()}:s.removeHoverDom.toFunc()),s.maxAddLevel||(s.maxAddLevel=2);a={view:{addHoverDom:s.addHoverDom||null,removeHoverDom:s.removeHoverDom||null,addDiyDom:s.addDiyDom?s.addDiyDom.toFunc():null},edit:{enable:s.editEnable,showRemoveBtn:s.showRemoveBtn,showRenameBtn:s.showRenameBtn},check:{enable:s.checkEnable,chkStyle:s.chkStyle,radioType:s.radioType},callback:{onClick:s.onClick?s.onClick.toFunc():null,beforeDrag:s.beforeDrag?s.beforeDrag.toFunc():function(t,e){for(var a=0;a<e.length;a++)if(!1===e[a].drag)return!1;return!0},beforeDrop:s.beforeDrop?s.beforeDrop.toFunc():function(t,e,a,i){return!a||!1!==a.drop},onDrop:s.onDrop?s.onDrop.toFunc():null,onCheck:s.onCheck?s.onCheck.toFunc():null,beforeRemove:s.beforeRemove?s.beforeRemove.toFunc():null,onRemove:s.onRemove?s.onRemove.toFunc():null,onNodeCreated:function(t,e,a){{var i;a.faicon&&((i=d("#"+a.tId+"_a")).data("faicon")||i.data("faicon",!0).addClass("faicon").find("> span.button").append('<i class="fa fa-'+a.faicon+'"></i>'))}s.onNodeCreated&&s.onNodeCreated.toFunc().call(this,t,e,a)},onCollapse:function(t,e,a){a.faiconClose&&d("#"+a.tId+"_ico").find("> i").attr("class","fa fa-"+a.faiconClose);s.onCollapse&&s.onCollapse.toFunc().call(this,t,e,a)},onExpand:function(t,e,a){a.faicon&&a.faiconClose&&d("#"+a.tId+"_ico").find("> i").attr("class","fa fa-"+a.faicon);s.onExpand&&s.onExpand.toFunc().call(this,t,e,a)}},data:{simpleData:{enable:s.simpleData||!0},key:{title:s.title||""}}};t&&"string"==typeof t&&(t=t.toObj()),t&&d.extend(!0,a,"object"==typeof t&&t),d.fn.zTree.init(e,a,s.nodes);var l="_a",r=d.fn.zTree.getZTreeObj(e.attr("id"));s.expandAll&&r.expandAll(!0)}),a.find('[data-toggle="selectztree"]').each(function(){var a,i,n,t,o=d(this),s=o.data(),l=d(s.tree),r=o.outerHeight();s.width=s.width||o.outerWidth(),s.height=s.height||"auto",l&&l.length&&(a=l.attr("id"),i=d("#"+a+"_select_box"),n=function(t){var e=o.offset().top,a=o.offset().left,i=l.clone().appendTo(d("body")),n=i.outerHeight();i.remove();i=d(window).height()-n-e-r,n=d(window).height()-e-r;"auto"===s.height&&i<0&&(n+=i),t.css({top:e+r,left:a,"max-height":n})},o.click(function(){if(i&&i.length)return n(i),void i.show();var t=2,e=d.CurrentDialog;e&&e.length&&(t=e.css("zIndex")+1),i=d('<div id="'+a+'_select_box" class="tree-box"></div>').css({position:"absolute",zIndex:t,"min-width":s.width,height:s.height,overflow:"auto",background:"#FAFAFA",border:"1px #EEE solid"}).hide().appendTo(d("body")),l.appendTo(i).css("width","100%").data("fromObj",o).removeClass("hide").show(),n(i),i.show()}),d("body").on("mousedown",function(t){var e=d(t.target);o[0]===t.target||i&&0<i.length&&0<e.closest(".tree-box").length||i.hide()}),(t=o.closest(".bjui-pageContent"))&&t.length&&t.scroll(function(){i&&i.length&&n(i)}),o.on("destroy.bjui.selectztree",function(){i.remove()}))}),a.find('[data-toggle="accordion"]').each(function(){function t(t,e){var a=i.data("offsety")||0;e=e||d(t).outerHeight()-+a,t=i.find(".panel-heading"),a=((a=t.outerHeight())+1)*t.length,i.css("height",e),e-=a,i.find(".panel-collapse").find(".panel-body").css("height",e)}var i=d(this),e=i.data("heightbox"),a=i.data("height");i.find("> .panel").length&&(e||a)&&(t(e,a),d(window).resize(function(){t(e,a)}),i.on("hidden.bs.collapse",function(t){var e=d(this).find("> .panel:last");e.find("> .panel-heading > h4 > a").hasClass("collapsed")&&e.css("border-bottom","1px #ddd solid")}))}),a.find('[data-toggle="kindeditor"]').each(function(){var t=d(this),e=t.data();e.items&&"string"==typeof e.items&&(e.items=e.items.replaceAll("'","").replaceAll(" ","").split(",")),e.afterUpload&&(e.afterUpload=e.afterUpload.toFunc()),e.afterSelectFile&&(e.afterSelectFile=e.afterSelectFile.toFunc()),e.confirmSelect&&(e.confirmSelect=e.confirmSelect.toFunc());KindEditor.create(t,{pasteType:e.pasteType,minHeight:e.minHeight||260,autoHeightMode:e.autoHeight||!1,items:e.items||KindEditor.options.items,uploadJson:e.uploadJson||BJUI.KindEditor.uploadJson,fileManagerJson:e.fileManagerJson||BJUI.KindEditor.fileManagerJson,allowFileManager:e.allowFileManager||!0,fillDescAfterUploadImage:e.fillDescAfterUploadImage||!0,afterUpload:e.afterUpload,afterSelectFile:e.afterSelectFile,X_afterSelect:e.confirmSelect,htmlTags:{font:[],span:[".color",".background-color",".font-size",".font-family"],div:[".margin",".padding",".text-align"],table:["align","width"],"td,th":["align","valign","width","height","colspan","rowspan"],a:["href","target","name"],embed:["src","width","height","type","loop","autostart","quality",".width",".height","align","allowscriptaccess"],img:["src","width","height","border","alt","title","align",".width",".height",".border"],"p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6":["class","align",".text-align",".color",".font-weight",".font-style",".text-decoration",".vertical-align",".text-indent",".margin-left"],pre:["class"],hr:["class",".page-break-after"],"br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del":[]},cssPath:[BJUI.PLUGINPATH+"kindeditor/editor-content.css",BJUI.PLUGINPATH+"kindeditor/plugins/code/prettify.css"],afterBlur:function(){this.sync()}})}),a.find('[data-toggle="colorpicker"]').each(function(){var e=d(this),t=e.data("bgcolor");e.colorpicker(),t&&e.on("changeColor",function(t){e.css("background-color",t.color.toHex())})}),a.find('[data-toggle="clearcolor"]').each(function(){var t=d(this),e=t.data("target")?d(t.data("target")):null;e&&e.length&&t.click(function(){e.val(""),e.data("bgcolor")&&e.css("background-color","")})}),a.find('[data-toggle="tooltip"]').each(function(){d(this).tooltip()}),a.find('[data-toggle="dropdown"]').parent().on("show.bs.dropdown",function(t){var e=d(this),a=e.outerWidth(),e=e.find("> .dropdown-menu");e.outerWidth()<a&&e.css("min-width",a)}),a.find('form[data-toggle="ajaxform"]').each(function(){d(this).validator({ignore:":input"}),d(this).validator("destroy")}),a.find("textarea[data-toggle=jsoneditor]").each(function(){var e=d(this);e.hide(),setTimeout(function(){CodeMirror.fromTextArea(e[0],{lineNumbers:!0,mode:"application/json",gutters:["CodeMirror-lint-markers"],theme:"rubyblue",lint:!0}).on("change",function(t){e.val(t.getValue())})},100)}),a.find("[data-toggle=clipboard]").each(function(){var t=d(this).data(),e={};t.target?e.target=function(){return a.find(t.target)[0]}:t.text&&(e.text=function(){return t.text}),new ClipboardJS(this,e).on("error",function(t){console.error("Action:",t.action),console.error("Trigger:",t.trigger),a.alertmsg("error","复制失败！")})})})}(jQuery);